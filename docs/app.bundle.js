/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{var t,e,n={465:function(t){t.exports=function(){"use strict";function t(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function e(e,n){return e.get(t(e,n))}function n(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}const r={},i=t=>new Promise((e=>{if(!t)return e();const n=window.scrollX,i=window.scrollY;r.restoreFocusTimeout=setTimeout((()=>{r.previousActiveElement instanceof HTMLElement?(r.previousActiveElement.focus(),r.previousActiveElement=null):document.body&&document.body.focus(),e()}),100),window.scrollTo(n,i)})),o="swal2-",s=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"].reduce(((t,e)=>(t[e]=o+e,t)),{}),a=["success","warning","info","question","error"].reduce(((t,e)=>(t[e]=o+e,t)),{}),l="SweetAlert2:",c=t=>t.charAt(0).toUpperCase()+t.slice(1),h=t=>{console.warn(`${l} ${"object"==typeof t?t.join(" "):t}`)},u=t=>{console.error(`${l} ${t}`)},d=[],f=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var n;n=`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`,d.includes(n)||(d.push(n),h(n))},p=t=>"function"==typeof t?t():t,g=t=>t&&"function"==typeof t.toPromise,m=t=>g(t)?t.toPromise():Promise.resolve(t),y=t=>t&&Promise.resolve(t)===t,v=()=>document.body.querySelector(`.${s.container}`),w=t=>{const e=v();return e?e.querySelector(t):null},_=t=>w(`.${t}`),b=()=>_(s.popup),x=()=>_(s.icon),E=()=>_(s.title),S=()=>_(s["html-container"]),L=()=>_(s.image),C=()=>_(s["progress-steps"]),k=()=>_(s["validation-message"]),P=()=>w(`.${s.actions} .${s.confirm}`),T=()=>w(`.${s.actions} .${s.cancel}`),I=()=>w(`.${s.actions} .${s.deny}`),O=()=>w(`.${s.loader}`),R=()=>_(s.actions),M=()=>_(s.footer),A=()=>_(s["timer-progress-bar"]),F=()=>_(s.close),j=()=>{const t=b();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort(((t,e)=>{const n=parseInt(t.getAttribute("tabindex")||"0"),r=parseInt(e.getAttribute("tabindex")||"0");return n>r?1:n<r?-1:0})),r=t.querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n'),i=Array.from(r).filter((t=>"-1"!==t.getAttribute("tabindex")));return[...new Set(n.concat(i))].filter((t=>tt(t)))},D=()=>B(document.body,s.shown)&&!B(document.body,s["toast-shown"])&&!B(document.body,s["no-backdrop"]),N=()=>{const t=b();return!!t&&B(t,s.toast)},G=(t,e)=>{if(t.textContent="",e){const n=(new DOMParser).parseFromString(e,"text/html"),r=n.querySelector("head");r&&Array.from(r.childNodes).forEach((e=>{t.appendChild(e)}));const i=n.querySelector("body");i&&Array.from(i.childNodes).forEach((e=>{e instanceof HTMLVideoElement||e instanceof HTMLAudioElement?t.appendChild(e.cloneNode(!0)):t.appendChild(e)}))}},B=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let e=0;e<n.length;e++)if(!t.classList.contains(n[e]))return!1;return!0},z=(t,e,n)=>{if(((t,e)=>{Array.from(t.classList).forEach((n=>{Object.values(s).includes(n)||Object.values(a).includes(n)||Object.values(e.showClass||{}).includes(n)||t.classList.remove(n)}))})(t,e),!e.customClass)return;const r=e.customClass[n];r&&("string"==typeof r||r.forEach?X(t,r):h(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof r}"`))},W=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${s.popup} > .${s[e]}`);case"checkbox":return t.querySelector(`.${s.popup} > .${s.checkbox} input`);case"radio":return t.querySelector(`.${s.popup} > .${s.radio} input:checked`)||t.querySelector(`.${s.popup} > .${s.radio} input:first-child`);case"range":return t.querySelector(`.${s.popup} > .${s.range} input`);default:return t.querySelector(`.${s.popup} > .${s.input}`)}},Y=t=>{if(t.focus(),"file"!==t.type){const e=t.value;t.value="",t.value=e}},K=(t,e,n)=>{t&&e&&("string"==typeof e&&(e=e.split(/\s+/).filter(Boolean)),e.forEach((e=>{Array.isArray(t)?t.forEach((t=>{n?t.classList.add(e):t.classList.remove(e)})):n?t.classList.add(e):t.classList.remove(e)})))},X=(t,e)=>{K(t,e,!0)},V=(t,e)=>{K(t,e,!1)},$=(t,e)=>{const n=Array.from(t.children);for(let t=0;t<n.length;t++){const r=n[t];if(r instanceof HTMLElement&&B(r,e))return r}},U=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||0===parseInt(n)?t.style.setProperty(e,"number"==typeof n?`${n}px`:n):t.style.removeProperty(e)},Z=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex";t&&(t.style.display=e)},q=t=>{t&&(t.style.display="none")},H=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";t&&new MutationObserver((()=>{Q(t,t.innerHTML,e)})).observe(t,{childList:!0,subtree:!0})},J=(t,e,n,r)=>{const i=t.querySelector(e);i&&i.style.setProperty(n,r)},Q=function(t,e){e?Z(t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):q(t)},tt=t=>!(!t||!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),et=t=>!!(t.scrollHeight>t.clientHeight),nt=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),r=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||r>0},rt=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=A();n&&tt(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout((()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"}),10))},it=`\n <div aria-labelledby="${s.title}" aria-describedby="${s["html-container"]}" class="${s.popup}" tabindex="-1">\n   <button type="button" class="${s.close}"></button>\n   <ul class="${s["progress-steps"]}"></ul>\n   <div class="${s.icon}"></div>\n   <img class="${s.image}" />\n   <h2 class="${s.title}" id="${s.title}"></h2>\n   <div class="${s["html-container"]}" id="${s["html-container"]}"></div>\n   <input class="${s.input}" id="${s.input}" />\n   <input type="file" class="${s.file}" />\n   <div class="${s.range}">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="${s.select}" id="${s.select}"></select>\n   <div class="${s.radio}"></div>\n   <label class="${s.checkbox}">\n     <input type="checkbox" id="${s.checkbox}" />\n     <span class="${s.label}"></span>\n   </label>\n   <textarea class="${s.textarea}" id="${s.textarea}"></textarea>\n   <div class="${s["validation-message"]}" id="${s["validation-message"]}"></div>\n   <div class="${s.actions}">\n     <div class="${s.loader}"></div>\n     <button type="button" class="${s.confirm}"></button>\n     <button type="button" class="${s.deny}"></button>\n     <button type="button" class="${s.cancel}"></button>\n   </div>\n   <div class="${s.footer}"></div>\n   <div class="${s["timer-progress-bar-container"]}">\n     <div class="${s["timer-progress-bar"]}"></div>\n   </div>\n </div>\n`.replace(/(^|\n)\s*/g,""),ot=()=>{r.currentInstance.resetValidationMessage()},st=t=>{const e=(()=>{const t=v();return!!t&&(t.remove(),V([document.documentElement,document.body],[s["no-backdrop"],s["toast-shown"],s["has-column"]]),!0)})();if("undefined"==typeof window||"undefined"==typeof document)return void u("SweetAlert2 requires document to initialize");const n=document.createElement("div");n.className=s.container,e&&X(n,s["no-transition"]),G(n,it),n.dataset.swal2Theme=t.theme;const r="string"==typeof(i=t.target)?document.querySelector(i):i;var i;r.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),(t=>{const e=b();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")})(t),(t=>{"rtl"===window.getComputedStyle(t).direction&&X(v(),s.rtl)})(r),(()=>{const t=b(),e=$(t,s.input),n=$(t,s.file),r=t.querySelector(`.${s.range} input`),i=t.querySelector(`.${s.range} output`),o=$(t,s.select),a=t.querySelector(`.${s.checkbox} input`),l=$(t,s.textarea);e.oninput=ot,n.onchange=ot,o.onchange=ot,a.onchange=ot,l.oninput=ot,r.oninput=()=>{ot(),i.value=r.value},r.onchange=()=>{ot(),i.value=r.value}})()},at=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):"object"==typeof t?lt(t,e):t&&G(e,t)},lt=(t,e)=>{t.jquery?ct(e,t):G(e,t.toString())},ct=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},ht=(t,e)=>{const n=R(),r=O();n&&r&&(e.showConfirmButton||e.showDenyButton||e.showCancelButton?Z(n):q(n),z(n,e,"actions"),function(t,e,n){const r=P(),i=I(),o=T();r&&i&&o&&(dt(r,"confirm",n),dt(i,"deny",n),dt(o,"cancel",n),function(t,e,n,r){r.buttonsStyling?(X([t,e,n],s.styled),r.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",r.confirmButtonColor),r.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",r.denyButtonColor),r.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",r.cancelButtonColor),ut(t),ut(e),ut(n)):V([t,e,n],s.styled)}(r,i,o,n),n.reverseButtons&&(n.toast?(t.insertBefore(o,r),t.insertBefore(i,r)):(t.insertBefore(o,e),t.insertBefore(i,e),t.insertBefore(r,e))))}(n,r,e),G(r,e.loaderHtml||""),z(r,e,"loader"))};function ut(t){const e=window.getComputedStyle(t),n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-outline",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function dt(t,e,n){const r=c(e);Q(t,n[`show${r}Button`],"inline-block"),G(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=s[e],z(t,n,`${e}Button`)}const ft=(t,e)=>{const n=v();n&&(function(t,e){"string"==typeof e?t.style.background=e:e||X([document.documentElement,document.body],s["no-backdrop"])}(n,e.backdrop),function(t,e){e&&(e in s?X(t,s[e]):(h('The "position" parameter is not valid, defaulting to "center"'),X(t,s.center)))}(n,e.position),function(t,e){e&&X(t,s[`grow-${e}`])}(n,e.grow),z(n,e,"container"))};var pt={innerParams:new WeakMap,domCache:new WeakMap};const gt=["input","file","range","select","radio","checkbox","textarea"],mt=t=>{if(!t.input)return;if(!Et[t.input])return void u(`Unexpected type of input! Expected ${Object.keys(Et).join(" | ")}, got "${t.input}"`);const e=bt(t.input);if(!e)return;const n=Et[t.input](e,t);Z(e),t.inputAutoFocus&&setTimeout((()=>{Y(n)}))},yt=(t,e)=>{const n=b();if(!n)return;const r=W(n,t);if(r){(t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}})(r);for(const t in e)r.setAttribute(t,e[t])}},vt=t=>{if(!t.input)return;const e=bt(t.input);e&&z(e,t,"input")},wt=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},_t=(t,e,n)=>{if(n.inputLabel){const r=document.createElement("label"),i=s["input-label"];r.setAttribute("for",t.id),r.className=i,"object"==typeof n.customClass&&X(r,n.customClass.inputLabel),r.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",r)}},bt=t=>{const e=b();if(e)return $(e,s[t]||s.input)},xt=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:y(e)||h(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},Et={};Et.text=Et.email=Et.password=Et.number=Et.tel=Et.url=Et.search=Et.date=Et["datetime-local"]=Et.time=Et.week=Et.month=(t,e)=>(xt(t,e.inputValue),_t(t,t,e),wt(t,e),t.type=e.input,t),Et.file=(t,e)=>(_t(t,t,e),wt(t,e),t),Et.range=(t,e)=>{const n=t.querySelector("input"),r=t.querySelector("output");return xt(n,e.inputValue),n.type=e.input,xt(r,e.inputValue),_t(n,t,e),t},Et.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");G(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return _t(t,t,e),t},Et.radio=t=>(t.textContent="",t),Et.checkbox=(t,e)=>{const n=W(b(),"checkbox");n.value="1",n.checked=Boolean(e.inputValue);const r=t.querySelector("span");return G(r,e.inputPlaceholder||e.inputLabel),n},Et.textarea=(t,e)=>{xt(t,e.inputValue),wt(t,e),_t(t,t,e);return setTimeout((()=>{if("MutationObserver"in window){const n=parseInt(window.getComputedStyle(b()).width);new MutationObserver((()=>{if(!document.body.contains(t))return;const r=t.offsetWidth+(i=t,parseInt(window.getComputedStyle(i).marginLeft)+parseInt(window.getComputedStyle(i).marginRight));var i;r>n?b().style.width=`${r}px`:U(b(),"width",e.width)})).observe(t,{attributes:!0,attributeFilter:["style"]})}})),t};const St=(t,e)=>{const n=S();n&&(H(n),z(n,e,"htmlContainer"),e.html?(at(e.html,n),Z(n,"block")):e.text?(n.textContent=e.text,Z(n,"block")):q(n),((t,e)=>{const n=b();if(!n)return;const r=pt.innerParams.get(t),i=!r||e.input!==r.input;gt.forEach((t=>{const r=$(n,s[t]);r&&(yt(t,e.inputAttributes),r.className=s[t],i&&q(r))})),e.input&&(i&&mt(e),vt(e))})(t,e))},Lt=(t,e)=>{for(const[n,r]of Object.entries(a))e.icon!==n&&V(t,r);X(t,e.icon&&a[e.icon]),Pt(t,e),Ct(),z(t,e,"icon")},Ct=()=>{const t=b();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let t=0;t<n.length;t++)n[t].style.backgroundColor=e},kt=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,r="";e.iconHtml?r=Tt(e.iconHtml):"success"===e.icon?(r='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',n=n.replace(/ style=".*?"/g,"")):"error"===e.icon?r='\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':e.icon&&(r=Tt({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==r.trim()&&G(t,r)},Pt=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])J(t,n,"background-color",e.iconColor);J(t,".swal2-success-ring","border-color",e.iconColor)}},Tt=t=>`<div class="${s["icon-content"]}">${t}</div>`;let It=!1,Ot=0,Rt=0,Mt=0,At=0;const Ft=t=>{const e=b();if(t.target===e||x().contains(t.target)){It=!0;const n=Nt(t);Ot=n.clientX,Rt=n.clientY,Mt=parseInt(e.style.insetInlineStart)||0,At=parseInt(e.style.insetBlockStart)||0,X(e,"swal2-dragging")}},jt=t=>{const e=b();if(It){let{clientX:n,clientY:r}=Nt(t);e.style.insetInlineStart=`${Mt+(n-Ot)}px`,e.style.insetBlockStart=`${At+(r-Rt)}px`}},Dt=()=>{const t=b();It=!1,V(t,"swal2-dragging")},Nt=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},Gt=(t,e)=>{const n=v(),r=b();if(n&&r){if(e.toast){U(n,"width",e.width),r.style.width="100%";const t=O();t&&r.insertBefore(t,x())}else U(r,"width",e.width);U(r,"padding",e.padding),e.color&&(r.style.color=e.color),e.background&&(r.style.background=e.background),q(k()),Bt(r,e),e.draggable&&!e.toast?(X(r,s.draggable),(t=>{t.addEventListener("mousedown",Ft),document.body.addEventListener("mousemove",jt),t.addEventListener("mouseup",Dt),t.addEventListener("touchstart",Ft),document.body.addEventListener("touchmove",jt),t.addEventListener("touchend",Dt)})(r)):(V(r,s.draggable),(t=>{t.removeEventListener("mousedown",Ft),document.body.removeEventListener("mousemove",jt),t.removeEventListener("mouseup",Dt),t.removeEventListener("touchstart",Ft),document.body.removeEventListener("touchmove",jt),t.removeEventListener("touchend",Dt)})(r))}},Bt=(t,e)=>{const n=e.showClass||{};t.className=`${s.popup} ${tt(t)?n.popup:""}`,e.toast?(X([document.documentElement,document.body],s["toast-shown"]),X(t,s.toast)):X(t,s.modal),z(t,e,"popup"),"string"==typeof e.customClass&&X(t,e.customClass),e.icon&&X(t,s[`icon-${e.icon}`])},zt=t=>{const e=document.createElement("li");return X(e,s["progress-step"]),G(e,t),e},Wt=t=>{const e=document.createElement("li");return X(e,s["progress-step-line"]),t.progressStepsDistance&&U(e,"width",t.progressStepsDistance),e},Yt=(t,e)=>{Gt(0,e),ft(0,e),((t,e)=>{const n=C();if(!n)return;const{progressSteps:r,currentProgressStep:i}=e;r&&0!==r.length&&void 0!==i?(Z(n),n.textContent="",i>=r.length&&h("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),r.forEach(((t,o)=>{const a=zt(t);if(n.appendChild(a),o===i&&X(a,s["active-progress-step"]),o!==r.length-1){const t=Wt(e);n.appendChild(t)}}))):q(n)})(0,e),((t,e)=>{const n=pt.innerParams.get(t),r=x();if(r){if(n&&e.icon===n.icon)return kt(r,e),void Lt(r,e);if(e.icon||e.iconHtml){if(e.icon&&-1===Object.keys(a).indexOf(e.icon))return u(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),void q(r);Z(r),kt(r,e),Lt(r,e),X(r,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",Ct)}else q(r)}})(t,e),((t,e)=>{const n=L();n&&(e.imageUrl?(Z(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),U(n,"width",e.imageWidth),U(n,"height",e.imageHeight),n.className=s.image,z(n,e,"image")):q(n))})(0,e),((t,e)=>{const n=E();n&&(H(n),Q(n,e.title||e.titleText,"block"),e.title&&at(e.title,n),e.titleText&&(n.innerText=e.titleText),z(n,e,"title"))})(0,e),((t,e)=>{const n=F();n&&(G(n,e.closeButtonHtml||""),z(n,e,"closeButton"),Q(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))})(0,e),St(t,e),ht(0,e),((t,e)=>{const n=M();n&&(H(n),Q(n,e.footer,"block"),e.footer&&at(e.footer,n),z(n,e,"footer"))})(0,e);const n=b();"function"==typeof e.didRender&&n&&e.didRender(n),r.eventEmitter.emit("didRender",n)},Kt=()=>{var t;return null===(t=P())||void 0===t?void 0:t.click()},Xt=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Vt=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},$t=(t,e)=>{var n;const r=j();if(r.length)return-2===(t+=e)&&(t=r.length-1),t===r.length?t=0:-1===t&&(t=r.length-1),void r[t].focus();null===(n=b())||void 0===n||n.focus()},Ut=["ArrowRight","ArrowDown"],Zt=["ArrowLeft","ArrowUp"],qt=(t,e,n)=>{t&&(e.isComposing||229===e.keyCode||(t.stopKeydownPropagation&&e.stopPropagation(),"Enter"===e.key?Ht(e,t):"Tab"===e.key?Jt(e):[...Ut,...Zt].includes(e.key)?Qt(e.key):"Escape"===e.key&&te(e,t,n)))},Ht=(t,e)=>{if(!p(e.allowEnterKey))return;const n=W(b(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;Kt(),t.preventDefault()}},Jt=t=>{const e=t.target,n=j();let r=-1;for(let t=0;t<n.length;t++)if(e===n[t]){r=t;break}t.shiftKey?$t(r,-1):$t(r,1),t.stopPropagation(),t.preventDefault()},Qt=t=>{const e=R(),n=P(),r=I(),i=T();if(!(e&&n&&r&&i))return;const o=[n,r,i];if(document.activeElement instanceof HTMLElement&&!o.includes(document.activeElement))return;const s=Ut.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let t=0;t<e.children.length;t++){if(a=a[s],!a)return;if(a instanceof HTMLButtonElement&&tt(a))break}a instanceof HTMLButtonElement&&a.focus()}},te=(t,e,n)=>{p(e.allowEscapeKey)&&(t.preventDefault(),n(Xt.esc))};var ee={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const ne=()=>{Array.from(document.body.children).forEach((t=>{t.hasAttribute("data-previous-aria-hidden")?(t.setAttribute("aria-hidden",t.getAttribute("data-previous-aria-hidden")||""),t.removeAttribute("data-previous-aria-hidden")):t.removeAttribute("aria-hidden")}))},re="undefined"!=typeof window&&!!window.GestureEvent,ie=()=>{const t=v();if(!t)return;let e;t.ontouchstart=t=>{e=oe(t)},t.ontouchmove=t=>{e&&(t.preventDefault(),t.stopPropagation())}},oe=t=>{const e=t.target,n=v(),r=S();return!(!n||!r||se(t)||ae(t)||e!==n&&(et(n)||!(e instanceof HTMLElement)||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||et(r)&&r.contains(e)))},se=t=>t.touches&&t.touches.length&&"stylus"===t.touches[0].touchType,ae=t=>t.touches&&t.touches.length>1;let le=null;const ce=t=>{null===le&&(document.body.scrollHeight>window.innerHeight||"scroll"===t)&&(le=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${le+(()=>{const t=document.createElement("div");t.className=s["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e})()}px`)};function he(t,e,n,o){N()?ve(t,o):(i(n).then((()=>ve(t,o))),Vt(r)),re?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),D()&&(null!==le&&(document.body.style.paddingRight=`${le}px`,le=null),(()=>{if(B(document.body,s.iosfix)){const t=parseInt(document.body.style.top,10);V(document.body,s.iosfix),document.body.style.top="",document.body.scrollTop=-1*t}})(),ne()),V([document.documentElement,document.body],[s.shown,s["height-auto"],s["no-backdrop"],s["toast-shown"]])}function ue(t){t=ge(t);const e=ee.swalPromiseResolve.get(this),n=de(this);this.isAwaitingPromise?t.isDismissed||(pe(this),e(t)):n&&e(t)}const de=t=>{const e=b();if(!e)return!1;const n=pt.innerParams.get(t);if(!n||B(e,n.hideClass.popup))return!1;V(e,n.showClass.popup),X(e,n.hideClass.popup);const r=v();return V(r,n.showClass.backdrop),X(r,n.hideClass.backdrop),me(t,e,n),!0};function fe(t){const e=ee.swalPromiseReject.get(this);pe(this),e&&e(t)}const pe=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,pt.innerParams.get(t)||t._destroy())},ge=t=>void 0===t?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),me=(t,e,n)=>{var i;const o=v(),s=nt(e);"function"==typeof n.willClose&&n.willClose(e),null===(i=r.eventEmitter)||void 0===i||i.emit("willClose",e),s?ye(t,e,o,n.returnFocus,n.didClose):he(t,o,n.returnFocus,n.didClose)},ye=(t,e,n,i,o)=>{r.swalCloseEventFinishedCallback=he.bind(null,t,n,i,o);const s=function(t){var n;t.target===e&&(null===(n=r.swalCloseEventFinishedCallback)||void 0===n||n.call(r),delete r.swalCloseEventFinishedCallback,e.removeEventListener("animationend",s),e.removeEventListener("transitionend",s))};e.addEventListener("animationend",s),e.addEventListener("transitionend",s)},ve=(t,e)=>{setTimeout((()=>{var n;"function"==typeof e&&e.bind(t.params)(),null===(n=r.eventEmitter)||void 0===n||n.emit("didClose"),t._destroy&&t._destroy()}))},we=t=>{let e=b();if(e||new Qn,e=b(),!e)return;const n=O();N()?q(x()):_e(e,t),Z(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},_e=(t,e)=>{const n=R(),r=O();n&&r&&(!e&&tt(P())&&(e=P()),Z(n),e&&(q(e),r.setAttribute("data-button-to-replace",e.className),n.insertBefore(r,e)),X([t,n],s.loading))},be=t=>t.checked?1:0,xe=t=>t.checked?t.value:null,Ee=t=>t.files&&t.files.length?null!==t.getAttribute("multiple")?t.files:t.files[0]:null,Se=(t,e)=>{const n=b();if(!n)return;const r=t=>{"select"===e.input?function(t,e,n){const r=$(t,s.select);if(!r)return;const i=(t,e,r)=>{const i=document.createElement("option");i.value=r,G(i,e),i.selected=ke(r,n.inputValue),t.appendChild(i)};e.forEach((t=>{const e=t[0],n=t[1];if(Array.isArray(n)){const t=document.createElement("optgroup");t.label=e,t.disabled=!1,r.appendChild(t),n.forEach((e=>i(t,e[1],e[0])))}else i(r,n,e)})),r.focus()}(n,Ce(t),e):"radio"===e.input&&function(t,e,n){const r=$(t,s.radio);if(!r)return;e.forEach((t=>{const e=t[0],i=t[1],o=document.createElement("input"),a=document.createElement("label");o.type="radio",o.name=s.radio,o.value=e,ke(e,n.inputValue)&&(o.checked=!0);const l=document.createElement("span");G(l,i),l.className=s.label,a.appendChild(o),a.appendChild(l),r.appendChild(a)}));const i=r.querySelectorAll("input");i.length&&i[0].focus()}(n,Ce(t),e)};g(e.inputOptions)||y(e.inputOptions)?(we(P()),m(e.inputOptions).then((e=>{t.hideLoading(),r(e)}))):"object"==typeof e.inputOptions?r(e.inputOptions):u("Unexpected type of inputOptions! Expected object, Map or Promise, got "+typeof e.inputOptions)},Le=(t,e)=>{const n=t.getInput();n&&(q(n),m(e.inputValue).then((r=>{n.value="number"===e.input?`${parseFloat(r)||0}`:`${r}`,Z(n),n.focus(),t.hideLoading()})).catch((e=>{u(`Error in inputValue promise: ${e}`),n.value="",Z(n),n.focus(),t.hideLoading()})))};const Ce=t=>{const e=[];return t instanceof Map?t.forEach(((t,n)=>{let r=t;"object"==typeof r&&(r=Ce(r)),e.push([n,r])})):Object.keys(t).forEach((n=>{let r=t[n];"object"==typeof r&&(r=Ce(r)),e.push([n,r])})),e},ke=(t,e)=>!!e&&e.toString()===t.toString(),Pe=(t,e)=>{const n=pt.innerParams.get(t);if(!n.input)return void u(`The "input" parameter is needed to be set when using returnInputValueOn${c(e)}`);const r=t.getInput(),i=((t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return be(n);case"radio":return xe(n);case"file":return Ee(n);default:return e.inputAutoTrim?n.value.trim():n.value}})(t,n);n.inputValidator?Te(t,i,e):r&&!r.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||r.validationMessage)):"deny"===e?Ie(t,i):Me(t,i)},Te=(t,e,n)=>{const r=pt.innerParams.get(t);t.disableInput(),Promise.resolve().then((()=>m(r.inputValidator(e,r.validationMessage)))).then((r=>{t.enableButtons(),t.enableInput(),r?t.showValidationMessage(r):"deny"===n?Ie(t,e):Me(t,e)}))},Ie=(t,e)=>{const n=pt.innerParams.get(t||void 0);n.showLoaderOnDeny&&we(I()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then((()=>m(n.preDeny(e,n.validationMessage)))).then((n=>{!1===n?(t.hideLoading(),pe(t)):t.close({isDenied:!0,value:void 0===n?e:n})})).catch((e=>Re(t||void 0,e)))):t.close({isDenied:!0,value:e})},Oe=(t,e)=>{t.close({isConfirmed:!0,value:e})},Re=(t,e)=>{t.rejectPromise(e)},Me=(t,e)=>{const n=pt.innerParams.get(t||void 0);n.showLoaderOnConfirm&&we(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then((()=>m(n.preConfirm(e,n.validationMessage)))).then((n=>{tt(k())||!1===n?(t.hideLoading(),pe(t)):Oe(t,void 0===n?e:n)})).catch((e=>Re(t||void 0,e)))):Oe(t,e)};function Ae(){const t=pt.innerParams.get(this);if(!t)return;const e=pt.domCache.get(this);q(e.loader),N()?t.icon&&Z(x()):Fe(e),V([e.popup,e.actions],s.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const Fe=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?Z(e[0],"inline-block"):!tt(P())&&!tt(I())&&!tt(T())&&q(t.actions)};function je(){const t=pt.innerParams.get(this),e=pt.domCache.get(this);return e?W(e.popup,t.input):null}function De(t,e,n){const r=pt.domCache.get(t);e.forEach((t=>{r[t].disabled=n}))}function Ne(t,e){const n=b();if(n&&t)if("radio"===t.type){const t=n.querySelectorAll(`[name="${s.radio}"]`);for(let n=0;n<t.length;n++)t[n].disabled=e}else t.disabled=e}function Ge(){De(this,["confirmButton","denyButton","cancelButton"],!1)}function Be(){De(this,["confirmButton","denyButton","cancelButton"],!0)}function ze(){Ne(this.getInput(),!1)}function We(){Ne(this.getInput(),!0)}function Ye(t){const e=pt.domCache.get(this),n=pt.innerParams.get(this);G(e.validationMessage,t),e.validationMessage.className=s["validation-message"],n.customClass&&n.customClass.validationMessage&&X(e.validationMessage,n.customClass.validationMessage),Z(e.validationMessage);const r=this.getInput();r&&(r.setAttribute("aria-invalid","true"),r.setAttribute("aria-describedby",s["validation-message"]),Y(r),X(r,s.inputerror))}function Ke(){const t=pt.domCache.get(this);t.validationMessage&&q(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),V(e,s.inputerror))}const Xe={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},Ve=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],$e={allowEnterKey:void 0},Ue=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Ze=t=>Object.prototype.hasOwnProperty.call(Xe,t),qe=t=>-1!==Ve.indexOf(t),He=t=>$e[t],Je=t=>{Ze(t)||h(`Unknown parameter "${t}"`)},Qe=t=>{Ue.includes(t)&&h(`The parameter "${t}" is incompatible with toasts`)},tn=t=>{const e=He(t);e&&f(t,e)},en=t=>{!1===t.backdrop&&t.allowOutsideClick&&h('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","borderless","embed-iframe"].includes(t.theme)&&h(`Invalid theme "${t.theme}". Expected "light", "dark", "auto", "borderless", or "embed-iframe"`);for(const e in t)Je(e),t.toast&&Qe(e),tn(e)};function nn(t){const e=v(),n=b(),r=pt.innerParams.get(this);if(!n||B(n,r.hideClass.popup))return void h("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const i=rn(t),o=Object.assign({},r,i);en(o),e.dataset.swal2Theme=o.theme,Yt(this,o),pt.innerParams.set(this,o),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const rn=t=>{const e={};return Object.keys(t).forEach((n=>{qe(n)?e[n]=t[n]:h(`Invalid parameter to update: ${n}`)})),e};function on(){const t=pt.domCache.get(this),e=pt.innerParams.get(this);e?(t.popup&&r.swalCloseEventFinishedCallback&&(r.swalCloseEventFinishedCallback(),delete r.swalCloseEventFinishedCallback),"function"==typeof e.didDestroy&&e.didDestroy(),r.eventEmitter.emit("didDestroy"),sn(this)):an(this)}const sn=t=>{an(t),delete t.params,delete r.keydownHandler,delete r.keydownTarget,delete r.currentInstance},an=t=>{t.isAwaitingPromise?(ln(pt,t),t.isAwaitingPromise=!0):(ln(ee,t),ln(pt,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},ln=(t,e)=>{for(const n in t)t[n].delete(e)};var cn=Object.freeze({__proto__:null,_destroy:on,close:ue,closeModal:ue,closePopup:ue,closeToast:ue,disableButtons:Be,disableInput:We,disableLoading:Ae,enableButtons:Ge,enableInput:ze,getInput:je,handleAwaitingPromise:pe,hideLoading:Ae,rejectPromise:fe,resetValidationMessage:Ke,showValidationMessage:Ye,update:nn});const hn=(t,e,n)=>{e.popup.onclick=()=>{t&&(un(t)||t.timer||t.input)||n(Xt.close)}},un=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let dn=!1;const fn=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(dn=!0)}}},pn=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(e){t.popup.onmouseup=()=>{},(e.target===t.popup||e.target instanceof HTMLElement&&t.popup.contains(e.target))&&(dn=!0)}}},gn=(t,e,n)=>{e.container.onclick=r=>{dn?dn=!1:r.target===e.container&&p(t.allowOutsideClick)&&n(Xt.backdrop)}},mn=t=>t instanceof Element||(t=>"object"==typeof t&&t.jquery)(t);const yn=()=>{if(r.timeout)return(()=>{const t=A();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=e/parseInt(window.getComputedStyle(t).width)*100;t.style.width=`${n}%`})(),r.timeout.stop()},vn=()=>{if(r.timeout){const t=r.timeout.start();return rt(t),t}};let wn=!1;const _n={};const bn=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const t in _n){const n=e.getAttribute(t);if(n)return void _n[t].fire({template:n})}};r.eventEmitter=new class{constructor(){this.events={}}_getHandlersByEventName(t){return void 0===this.events[t]&&(this.events[t]=[]),this.events[t]}on(t,e){const n=this._getHandlersByEventName(t);n.includes(e)||n.push(e)}once(t,e){var n=this;const r=function(){n.removeListener(t,r);for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];e.apply(n,o)};this.on(t,r)}emit(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this._getHandlersByEventName(t).forEach((t=>{try{t.apply(this,n)}catch(t){console.error(t)}}))}removeListener(t,e){const n=this._getHandlersByEventName(t),r=n.indexOf(e);r>-1&&n.splice(r,1)}removeAllListeners(t){void 0!==this.events[t]&&(this.events[t].length=0)}reset(){this.events={}}};var xn=Object.freeze({__proto__:null,argsToParams:t=>{const e={};return"object"!=typeof t[0]||mn(t[0])?["title","html","icon"].forEach(((n,r)=>{const i=t[r];"string"==typeof i||mn(i)?e[n]=i:void 0!==i&&u(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof i}`)})):Object.assign(e,t[0]),e},bindClickHandler:function(){_n[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,wn||(document.body.addEventListener("click",bn),wn=!0)},clickCancel:()=>{var t;return null===(t=T())||void 0===t?void 0:t.click()},clickConfirm:Kt,clickDeny:()=>{var t;return null===(t=I())||void 0===t?void 0:t.click()},enableLoading:we,fire:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new this(...e)},getActions:R,getCancelButton:T,getCloseButton:F,getConfirmButton:P,getContainer:v,getDenyButton:I,getFocusableElements:j,getFooter:M,getHtmlContainer:S,getIcon:x,getIconContent:()=>_(s["icon-content"]),getImage:L,getInputLabel:()=>_(s["input-label"]),getLoader:O,getPopup:b,getProgressSteps:C,getTimerLeft:()=>r.timeout&&r.timeout.getTimerLeft(),getTimerProgressBar:A,getTitle:E,getValidationMessage:k,increaseTimer:t=>{if(r.timeout){const e=r.timeout.increase(t);return rt(e,!0),e}},isDeprecatedParameter:He,isLoading:()=>{const t=b();return!!t&&t.hasAttribute("data-loading")},isTimerRunning:()=>!(!r.timeout||!r.timeout.isRunning()),isUpdatableParameter:qe,isValidParameter:Ze,isVisible:()=>tt(b()),mixin:function(t){return class extends(this){_main(e,n){return super._main(e,Object.assign({},t,n))}}},off:(t,e)=>{t?e?r.eventEmitter.removeListener(t,e):r.eventEmitter.removeAllListeners(t):r.eventEmitter.reset()},on:(t,e)=>{r.eventEmitter.on(t,e)},once:(t,e)=>{r.eventEmitter.once(t,e)},resumeTimer:vn,showLoading:we,stopTimer:yn,toggleTimer:()=>{const t=r.timeout;return t&&(t.running?yn():vn())}});class En{constructor(t,e){this.callback=t,this.remaining=e,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(t){const e=this.running;return e&&this.stop(),this.remaining+=t,e&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Sn=["swal-title","swal-html","swal-footer"],Ln=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach((t=>{Mn(t,["name","value"]);const n=t.getAttribute("name"),r=t.getAttribute("value");n&&r&&(e[n]="boolean"==typeof Xe[n]?"false"!==r:"object"==typeof Xe[n]?JSON.parse(r):r)})),e},Cn=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach((t=>{const n=t.getAttribute("name"),r=t.getAttribute("value");n&&r&&(e[n]=new Function(`return ${r}`)())})),e},kn=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach((t=>{Mn(t,["type","color","aria-label"]);const n=t.getAttribute("type");n&&["confirm","cancel","deny"].includes(n)&&(e[`${n}ButtonText`]=t.innerHTML,e[`show${c(n)}Button`]=!0,t.hasAttribute("color")&&(e[`${n}ButtonColor`]=t.getAttribute("color")),t.hasAttribute("aria-label")&&(e[`${n}ButtonAriaLabel`]=t.getAttribute("aria-label")))})),e},Pn=t=>{const e={},n=t.querySelector("swal-image");return n&&(Mn(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},Tn=t=>{const e={},n=t.querySelector("swal-icon");return n&&(Mn(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},In=t=>{const e={},n=t.querySelector("swal-input");n&&(Mn(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const r=Array.from(t.querySelectorAll("swal-input-option"));return r.length&&(e.inputOptions={},r.forEach((t=>{Mn(t,["value"]);const n=t.getAttribute("value");if(!n)return;const r=t.innerHTML;e.inputOptions[n]=r}))),e},On=(t,e)=>{const n={};for(const r in e){const i=e[r],o=t.querySelector(i);o&&(Mn(o,[]),n[i.replace(/^swal-/,"")]=o.innerHTML.trim())}return n},Rn=t=>{const e=Sn.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach((t=>{const n=t.tagName.toLowerCase();e.includes(n)||h(`Unrecognized element <${n}>`)}))},Mn=(t,e)=>{Array.from(t.attributes).forEach((n=>{-1===e.indexOf(n.name)&&h([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."])}))},An=t=>{const e=v(),n=b();"function"==typeof t.willOpen&&t.willOpen(n),r.eventEmitter.emit("willOpen",n);const i=window.getComputedStyle(document.body).overflowY;Nn(e,n,t),setTimeout((()=>{jn(e,n)}),10),D()&&(Dn(e,t.scrollbarPadding,i),(()=>{const t=v();Array.from(document.body.children).forEach((e=>{e.contains(t)||(e.hasAttribute("aria-hidden")&&e.setAttribute("data-previous-aria-hidden",e.getAttribute("aria-hidden")||""),e.setAttribute("aria-hidden","true"))}))})()),N()||r.previousActiveElement||(r.previousActiveElement=document.activeElement),"function"==typeof t.didOpen&&setTimeout((()=>t.didOpen(n))),r.eventEmitter.emit("didOpen",n),V(e,s["no-transition"])},Fn=t=>{const e=b();if(t.target!==e)return;const n=v();e.removeEventListener("animationend",Fn),e.removeEventListener("transitionend",Fn),n.style.overflowY="auto"},jn=(t,e)=>{nt(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",Fn),e.addEventListener("transitionend",Fn)):t.style.overflowY="auto"},Dn=(t,e,n)=>{(()=>{if(re&&!B(document.body,s.iosfix)){const t=document.body.scrollTop;document.body.style.top=-1*t+"px",X(document.body,s.iosfix),ie()}})(),e&&"hidden"!==n&&ce(n),setTimeout((()=>{t.scrollTop=0}))},Nn=(t,e,n)=>{X(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),Z(e,"grid"),setTimeout((()=>{X(e,n.showClass.popup),e.style.removeProperty("opacity")}),10)):Z(e,"grid"),X([document.documentElement,document.body],s.shown),n.heightAuto&&n.backdrop&&!n.toast&&X([document.documentElement,document.body],s["height-auto"])};var Gn=(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),Bn=(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL");function zn(t){(function(t){t.inputValidator||("email"===t.input&&(t.inputValidator=Gn),"url"===t.input&&(t.inputValidator=Bn))})(t),t.showLoaderOnConfirm&&!t.preConfirm&&h("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function(t){(!t.target||"string"==typeof t.target&&!document.querySelector(t.target)||"string"!=typeof t.target&&!t.target.appendChild)&&(h('Target parameter is not valid, defaulting to "body"'),t.target="body")}(t),"string"==typeof t.title&&(t.title=t.title.split("\n").join("<br />")),st(t)}let Wn;var Yn=new WeakMap;class Kn{constructor(){if(n(this,Yn,void 0),"undefined"==typeof window)return;Wn=this;for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];const o=Object.freeze(this.constructor.argsToParams(r));var s,a,l;this.params=o,this.isAwaitingPromise=!1,s=Yn,a=this,l=this._main(Wn.params),s.set(t(s,a),l)}_main(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(en(Object.assign({},e,t)),r.currentInstance){const t=ee.swalPromiseResolve.get(r.currentInstance),{isAwaitingPromise:e}=r.currentInstance;r.currentInstance._destroy(),e||t({isDismissed:!0}),D()&&ne()}r.currentInstance=Wn;const n=Vn(t,e);zn(n),Object.freeze(n),r.timeout&&(r.timeout.stop(),delete r.timeout),clearTimeout(r.restoreFocusTimeout);const i=$n(Wn);return Yt(Wn,n),pt.innerParams.set(Wn,n),Xn(Wn,i,n)}then(t){return e(Yn,this).then(t)}finally(t){return e(Yn,this).finally(t)}}const Xn=(t,e,n)=>new Promise(((i,o)=>{const s=e=>{t.close({isDismissed:!0,dismiss:e})};ee.swalPromiseResolve.set(t,i),ee.swalPromiseReject.set(t,o),e.confirmButton.onclick=()=>{(t=>{const e=pt.innerParams.get(t);t.disableButtons(),e.input?Pe(t,"confirm"):Me(t,!0)})(t)},e.denyButton.onclick=()=>{(t=>{const e=pt.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?Pe(t,"deny"):Ie(t,!1)})(t)},e.cancelButton.onclick=()=>{((t,e)=>{t.disableButtons(),e(Xt.cancel)})(t,s)},e.closeButton.onclick=()=>{s(Xt.close)},((t,e,n)=>{t.toast?hn(t,e,n):(fn(e),pn(e),gn(t,e,n))})(n,e,s),((t,e,n)=>{Vt(t),e.toast||(t.keydownHandler=t=>qt(e,t,n),t.keydownTarget=e.keydownListenerCapture?window:b(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)})(r,n,s),((t,e)=>{"select"===e.input||"radio"===e.input?Se(t,e):["text","email","number","tel","textarea"].some((t=>t===e.input))&&(g(e.inputValue)||y(e.inputValue))&&(we(P()),Le(t,e))})(t,n),An(n),Un(r,n,s),Zn(e,n),setTimeout((()=>{e.container.scrollTop=0}))})),Vn=(t,e)=>{const n=(t=>{const e="string"==typeof t.template?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return Rn(n),Object.assign(Ln(n),Cn(n),kn(n),Pn(n),Tn(n),In(n),On(n,Sn))})(t),r=Object.assign({},Xe,e,n,t);return r.showClass=Object.assign({},Xe.showClass,r.showClass),r.hideClass=Object.assign({},Xe.hideClass,r.hideClass),!1===r.animation&&(r.showClass={backdrop:"swal2-noanimation"},r.hideClass={}),r},$n=t=>{const e={popup:b(),container:v(),actions:R(),confirmButton:P(),denyButton:I(),cancelButton:T(),loader:O(),closeButton:F(),validationMessage:k(),progressSteps:C()};return pt.domCache.set(t,e),e},Un=(t,e,n)=>{const r=A();q(r),e.timer&&(t.timeout=new En((()=>{n("timer"),delete t.timeout}),e.timer),e.timerProgressBar&&(Z(r),z(r,e,"timerProgressBar"),setTimeout((()=>{t.timeout&&t.timeout.running&&rt(e.timer)}))))},Zn=(t,e)=>{if(!e.toast)return p(e.allowEnterKey)?void(qn(t)||Hn(t,e)||$t(-1,1)):(f("allowEnterKey"),void Jn())},qn=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const t of e)if(t instanceof HTMLElement&&tt(t))return t.focus(),!0;return!1},Hn=(t,e)=>e.focusDeny&&tt(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&tt(t.cancelButton)?(t.cancelButton.focus(),!0):!(!e.focusConfirm||!tt(t.confirmButton)||(t.confirmButton.focus(),0)),Jn=()=>{document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if("undefined"!=typeof window&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/864e5>3&&setTimeout((()=>{document.body.style.pointerEvents="none";const t=document.createElement("audio");t.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",t.loop=!0,document.body.appendChild(t),setTimeout((()=>{t.play().catch((()=>{}))}),2500)}),500):localStorage.setItem("swal-initiation",`${t}`)}Kn.prototype.disableButtons=Be,Kn.prototype.enableButtons=Ge,Kn.prototype.getInput=je,Kn.prototype.disableInput=We,Kn.prototype.enableInput=ze,Kn.prototype.hideLoading=Ae,Kn.prototype.disableLoading=Ae,Kn.prototype.showValidationMessage=Ye,Kn.prototype.resetValidationMessage=Ke,Kn.prototype.close=ue,Kn.prototype.closePopup=ue,Kn.prototype.closeModal=ue,Kn.prototype.closeToast=ue,Kn.prototype.rejectPromise=fe,Kn.prototype.update=nn,Kn.prototype._destroy=on,Object.assign(Kn,xn),Object.keys(cn).forEach((t=>{Kn[t]=function(){return Wn&&Wn[t]?Wn[t](...arguments):null}})),Kn.DismissReason=Xt,Kn.version="11.20.0";const Qn=Kn;return Qn.default=Qn,Qn}(),void 0!==this&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),"undefined"!=typeof document&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch(t){n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-footer-border-color: #eee;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-background: transparent;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.1s, box-shadow 0.1s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-confirm-button-background-color: #7066e0;--swal2-deny-button-background-color: #dc3741;--swal2-cancel-button-background-color: #6e7881}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:0;border-radius:.25em;background:initial;background-color:var(--swal2-confirm-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:0;border-radius:.25em;background:initial;background-color:var(--swal2-deny-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:0;border-radius:.25em;background:initial;background-color:var(--swal2-cancel-button-background-color);color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-outline)}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:var(--swal2-input-background);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:var(--swal2-background);box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}')}},r={};function i(t){var e=r[t];if(void 0!==e)return e.exports;var o=r[t]={exports:{}};return n[t].call(o.exports,o,o.exports,i),o.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);i.r(o);var s={};t=t||[null,e({}),e([]),e(e)];for(var a=2&r&&n;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>s[t]=()=>n[t]));return s.default=()=>n,i.d(o,s),o},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";const t={checkLoggedIn:function(){return!!localStorage.getItem("token")},requireAuth:function(t){var e=["/login","/register","/about"].some((function(e){return t===e}));return this.checkLoggedIn()||e?!this.checkLoggedIn()||"/login"!==t&&"/register"!==t||(window.location.hash="#/stories",!1):(window.location.hash="#/login",!1)}},e="https://story-api.dicoding.dev/v1",n={VAPID_PUBLIC_KEY:"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk"},r={SUBSCRIBE:"/notifications/subscribe",UNSUBSCRIBE:"/notifications/subscribe"};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function l(){l=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function d(t,e,n,r){var o=e&&e.prototype instanceof w?e:w,s=Object.create(o.prototype),a=new R(r||[]);return i(s,"_invoke",{value:P(t,n,a)}),s}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var p="suspendedStart",g="suspendedYield",m="executing",y="completed",v={};function w(){}function _(){}function b(){}var x={};u(x,a,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(M([])));S&&S!==n&&r.call(S,a)&&(x=S);var L=b.prototype=w.prototype=Object.create(x);function C(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,s,a,l){var c=f(t[i],t,s);if("throw"!==c.type){var h=c.arg,u=h.value;return u&&"object"==o(u)&&r.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,a,l)}),(function(t){n("throw",t,a,l)})):e.resolve(u).then((function(t){h.value=t,a(h)}),(function(t){return n("throw",t,a,l)}))}l(c.arg)}var s;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return s=s?s.then(i,i):i()}})}function P(e,n,r){var i=p;return function(o,s){if(i===m)throw Error("Generator is already running");if(i===y){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=T(a,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===p)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=m;var c=f(e,n,r);if("normal"===c.type){if(i=r.done?y:g,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=f(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function M(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return s.next=s}}throw new TypeError(o(e)+" is not iterable")}return _.prototype=b,i(L,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:_,configurable:!0}),_.displayName=u(b,h,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,h,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},C(k.prototype),u(k.prototype,c,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(d(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},C(L),u(L,h,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=M,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function c(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){c(o,r,i,s,a,"next",t)}function a(t){c(o,r,i,s,a,"throw",t)}s(void 0)}))}}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,d(r.key),r)}}function d(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}const f=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},i=[{key:"isPushNotificationSupported",value:(g=h(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","serviceWorker"in navigator&&"PushManager"in window);case 1:case"end":return t.stop()}}),t)}))),function(){return g.apply(this,arguments)})},{key:"requestNotificationPermission",value:(p=h(l().mark((function t(){var e;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isPushNotificationSupported();case 2:if(t.sent){t.next=5;break}return console.error("Push notifications not supported"),t.abrupt("return",!1);case 5:return t.prev=5,t.next=8,Notification.requestPermission();case 8:return e=t.sent,t.abrupt("return","granted"===e);case 12:return t.prev=12,t.t0=t.catch(5),console.error("Error requesting notification permission:",t.t0),t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,this,[[5,12]])}))),function(){return p.apply(this,arguments)})},{key:"urlBase64ToUint8Array",value:function(t){var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(e);return Uint8Array.from(s(n).map((function(t){return t.charCodeAt(0)})))}},{key:"getSubscription",value:(f=h(l().mark((function t(){var e;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isPushNotificationSupported();case 2:if(t.sent){t.next=4;break}return t.abrupt("return",null);case 4:return t.prev=4,t.next=7,navigator.serviceWorker.ready;case 7:return e=t.sent,t.next=10,e.pushManager.getSubscription();case 10:return t.abrupt("return",t.sent);case 13:return t.prev=13,t.t0=t.catch(4),console.error("Error getting subscription:",t.t0),t.abrupt("return",null);case 17:case"end":return t.stop()}}),t,this,[[4,13]])}))),function(){return f.apply(this,arguments)})},{key:"isSubscribed",value:(d=h(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getSubscription();case 2:return t.abrupt("return",!!t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"subscribe",value:(c=h(l().mark((function t(){var i,o,a,c,h,u,d,f;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isPushNotificationSupported();case 2:if(t.sent){t.next=4;break}throw new Error("Push notifications not supported");case 4:if(i=localStorage.getItem("token")){t.next=7;break}throw new Error("User not logged in");case 7:return t.prev=7,t.next=10,this.requestNotificationPermission();case 10:if(t.sent){t.next=13;break}throw new Error("Notification permission denied");case 13:return t.next=15,navigator.serviceWorker.ready;case 15:return o=t.sent,t.next=18,o.pushManager.getSubscription();case 18:if(a=t.sent){t.next=24;break}return c=this.urlBase64ToUint8Array(n.VAPID_PUBLIC_KEY),t.next=23,o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:c});case 23:a=t.sent;case 24:return h=btoa(String.fromCharCode.apply(String,s(new Uint8Array(a.getKey("p256dh"))))),u=btoa(String.fromCharCode.apply(String,s(new Uint8Array(a.getKey("auth"))))),t.next=28,fetch("".concat(e).concat(r.SUBSCRIBE),{method:"POST",headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"},body:JSON.stringify({endpoint:a.endpoint,keys:{p256dh:h,auth:u}})});case 28:return d=t.sent,t.next=31,d.json();case 31:if(!(f=t.sent).error){t.next=34;break}throw new Error(f.message);case 34:return console.log("Subscribed to push notifications:",f),t.abrupt("return",f);case 38:throw t.prev=38,t.t0=t.catch(7),console.error("Error subscribing to push notifications:",t.t0),t.t0;case 42:case"end":return t.stop()}}),t,this,[[7,38]])}))),function(){return c.apply(this,arguments)})},{key:"unsubscribe",value:(a=h(l().mark((function t(){var n,i,o,s;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.isPushNotificationSupported();case 2:if(t.sent){t.next=4;break}throw new Error("Push notifications not supported");case 4:if(n=localStorage.getItem("token")){t.next=7;break}throw new Error("User not logged in");case 7:return t.prev=7,t.next=10,this.getSubscription();case 10:if(i=t.sent){t.next=13;break}return t.abrupt("return",{error:!1,message:"Not subscribed"});case 13:return t.next=15,fetch("".concat(e).concat(r.UNSUBSCRIBE),{method:"DELETE",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({endpoint:i.endpoint})});case 15:return o=t.sent,t.next=18,o.json();case 18:return s=t.sent,t.next=21,i.unsubscribe();case 21:if(!s.error){t.next=23;break}throw new Error(s.message);case 23:return t.abrupt("return",s);case 26:throw t.prev=26,t.t0=t.catch(7),console.error("Error unsubscribing from push notifications:",t.t0),t.t0;case 30:case"end":return t.stop()}}),t,this,[[7,26]])}))),function(){return a.apply(this,arguments)})},{key:"updateSubscriptionButton",value:(o=h(l().mark((function t(e){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,this.isSubscribed();case 5:t.sent?(e.innerHTML='<i class="fas fa-bell-slash"></i> Unsubscribe',e.title="Unsubscribe from notifications"):(e.innerHTML='<i class="fas fa-bell"></i> Subscribe',e.title="Subscribe to notifications"),e.disabled=!1,t.next=15;break;case 10:t.prev=10,t.t0=t.catch(2),console.error("Error updating subscription button:",t.t0),e.innerHTML='<i class="fas fa-bell"></i> Notification Error',e.disabled=!0;case 15:case"end":return t.stop()}}),t,this,[[2,10]])}))),function(t){return o.apply(this,arguments)})}],i&&u(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,o,a,c,d,f,p,g}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function g(){g=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof w?e:w,s=Object.create(o.prototype),a=new R(r||[]);return i(s,"_invoke",{value:P(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",m="executing",y="completed",v={};function w(){}function _(){}function b(){}var x={};c(x,s,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(M([])));S&&S!==n&&r.call(S,s)&&(x=S);var L=b.prototype=w.prototype=Object.create(x);function C(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==p(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function P(e,n,r){var i=d;return function(o,s){if(i===m)throw Error("Generator is already running");if(i===y){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=T(a,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=m;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?y:f,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=y,r.method="throw",r.arg=c.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function M(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(p(e)+" is not iterable")}return _.prototype=b,i(L,"constructor",{value:b,configurable:!0}),i(b,"constructor",{value:_,configurable:!0}),_.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},C(k.prototype),c(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},C(L),c(L,l,"Generator"),c(L,s,(function(){return this})),c(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=M,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function m(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function y(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){m(o,r,i,s,a,"next",t)}function a(t){m(o,r,i,s,a,"throw",t)}s(void 0)}))}}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function w(t){var e=function(t){if("object"!=p(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==p(e)?e:e+""}const _=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}return n=e,r=[{key:"init",value:function(){var t=this;this._updateNavigation(),window.addEventListener("hashchange",(function(){t._updateNavigation()}))}},{key:"_updateNavigation",value:(i=y(g().mark((function n(){var r,i,o,s;return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=document.getElementById("nav-list"),i=t.checkLoggedIn(),n.next=4,f.isPushNotificationSupported();case 4:if(o=n.sent,r.innerHTML='\n      <ul class="nav-list">\n      '.concat(i?'\n        <li><a href="#/stories"><i class="fas fa-book"></i> Stories</a></li>\n        <li><a href="#/stories/add"><i class="fas fa-plus"></i> Add Story</a></li>\n        <li><a href="#/bookmark"><i class="fas fa-bookmark"></i> Bookmark</a></li>\n        <li><a href="#/about"><i class="fas fa-info-circle"></i> About</a></li>\n        '.concat(o?'<li><a href="#" id="notificationButton" disabled><i class="fas fa-bell"></i> Notification</a></li>':"",'\n        <li><a href="#" id="logoutButton"><i class="fas fa-sign-out-alt"></i> Logout</a></li>\n      '):'\n        <li><a href="#/login"><i class="fas fa-sign-in-alt"></i> Login</a></li>\n        <li><a href="#/register"><i class="fas fa-user-plus"></i> Register</a></li>\n        <li><a href="#/about"><i class="fas fa-info-circle"></i> About</a></li>\n      ',"\n      </ul>\n    "),!i){n.next=14;break}if(document.getElementById("logoutButton").addEventListener("click",(function(t){t.preventDefault(),localStorage.removeItem("token"),window.location.hash="#/login"})),!o){n.next=14;break}return s=document.getElementById("notificationButton"),n.next=13,f.updateSubscriptionButton(s);case 13:s.addEventListener("click",function(){var t=y(g().mark((function t(n){var r,i,o,a;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),s.disabled=!0,t.prev=2,t.next=5,f.isSubscribed();case 5:if(!t.sent){t.next=13;break}return t.next=9,f.unsubscribe();case 9:console.log("Unsubscribed from push notifications."),null!==(r=window.Swal)&&void 0!==r&&r.fire?window.Swal.fire("Success","Notifications have been disabled","success"):e._showToast("Notifications have been disabled","success"),t.next=21;break;case 13:return t.next=15,f.subscribe();case 15:return console.log("Successfully subscribed to push notifications."),t.next=18,navigator.serviceWorker.getRegistration();case 18:(o=t.sent)&&o.showNotification("Subscribed!",{body:"You will now receive GeoTale story updates.",icon:"".concat(window.location.origin,"/icons/icon-192x192.png"),tag:"subscription-success",requireInteraction:!0}),null!==(i=window.Swal)&&void 0!==i&&i.fire?window.Swal.fire("Success","Notifications have been enabled","success"):e._showToast("Notifications have been enabled","success");case 21:return t.next=23,f.updateSubscriptionButton(s);case 23:t.next=29;break;case 25:t.prev=25,t.t0=t.catch(2),console.error("Subscription error:",t.t0),null!==(a=window.Swal)&&void 0!==a&&a.fire?window.Swal.fire("Error",t.t0.message,"error"):e._showToast(t.t0.message||"An error occurred","error");case 29:return t.prev=29,s.disabled=!1,t.finish(29);case 32:case"end":return t.stop()}}),t,null,[[2,25,29,32]])})));return function(e){return t.apply(this,arguments)}}());case 14:case"end":return n.stop()}}),n)}))),function(){return i.apply(this,arguments)})},{key:"_showToast",value:function(t){var e=document.createElement("div");e.className="toast",e.textContent=t,document.body.appendChild(e),setTimeout((function(){e.classList.add("show"),setTimeout((function(){e.classList.remove("show"),setTimeout((function(){document.body.removeChild(e)}),300)}),3e3)}),100)}},{key:"_checkLoggedIn",value:function(){return!!localStorage.getItem("token")}},{key:"_loggedInMenu",value:function(){return'\n        <li><a href="#/stories"><i class="fas fa-book"></i> Stories</a></li>\n        <li><a href="#/stories/add"><i class="fas fa-plus"></i> Add Story</a></li>\n        <li><a href="#/about"><i class="fas fa-info-circle"></i> About</a></li>\n        <li><a href="#" id="logoutButton"><i class="fas fa-sign-out-alt"></i> Logout</a></li>\n      '}},{key:"_loggedOutMenu",value:function(){return'\n        <li><a href="#/login"><i class="fas fa-sign-in-alt"></i> Login</a></li>\n        <li><a href="#/register"><i class="fas fa-user-plus"></i> Register</a></li>\n        <li><a href="#/about"><i class="fas fa-info-circle"></i> About</a></li>\n      '}},{key:"_logout",value:function(){localStorage.removeItem("token"),window.location.hash="#/login"}}],r&&v(n,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i}();function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function x(){x=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new R(r||[]);return i(s,"_invoke",{value:P(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(M([])));S&&S!==n&&r.call(S,s)&&(_=S);var L=w.prototype=y.prototype=Object.create(_);function C(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==b(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function P(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=T(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function M(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(b(e)+" is not iterable")}return v.prototype=w,i(L,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},C(k.prototype),c(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new k(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},C(L),c(L,l,"Generator"),c(L,s,(function(){return this})),c(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=M,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function E(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function S(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){E(o,r,i,s,a,"next",t)}function a(t){E(o,r,i,s,a,"throw",t)}s(void 0)}))}}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,C(r.key),r)}}function C(t){var e=function(t){if("object"!=b(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=b(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==b(e)?e:e+""}var k=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(r=S(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n\n\n      <section class="hero container">\n        <div class="hero-content">\n          <h1 class="hero-title">\n            Your Stories, Your Voice\n          </h1>\n          <p class="hero-description">\n            Capture meaningful moments, share experiences, and inspire the worldone story at a time.\n          </p>\n          <div class="hero-cta">\n            <a href="#/stories" class="btn btn-primary">\n              <i class="fas fa-book-reader"></i> Browse Stories\n            </a>\n            <a href="#/stories/add" class="btn btn-outline">\n              <i class="fas fa-pen-nib"></i> Start Writing\n            </a>\n          </div>\n        </div>\n        <div class="hero-image">\n          <img src="images/logo.png" alt="Storytelling Illustration" />\n        </div>\n      </section>\n\n      <section class="features container">\n        <h2 class="section-title">Why Tell Your Story Here?</h2>\n        <div class="features-grid">\n          <div class="feature-card">\n            <i class="fas fa-globe-asia feature-icon"></i>\n            <h3>Reach Globally</h3>\n            <p>Share your story with a worldwide community of readers and writers.</p>\n          </div>\n          <div class="feature-card">\n            <i class="fas fa-map-marked-alt feature-icon"></i>\n            <h3>Map Your Moments</h3>\n            <p>Pin your stories to real locations and let readers follow your journey.</p>\n          </div>\n          <div class="feature-card">\n            <i class="fas fa-camera-retro feature-icon"></i>\n            <h3>Visual Storytelling</h3>\n            <p>Enhance your narrative with photos captured on the spot or uploaded from your gallery.</p>\n          </div>\n        </div>\n      </section>\n\n      <section class="call-to-action container">\n        <h2>Ready to share your voice?</h2>\n        <p>Every story matters. Yours could be the one that inspires someone today.</p>\n        <a href="#/stories/add" class="btn btn-large btn-highlight">\n          <i class="fas fa-plus-circle"></i> Tell My Story\n        </a>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=S(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&L(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function T(){T=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new R(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(M([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==P(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function M(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(P(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=M,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:M(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function I(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function O(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){I(o,r,i,s,a,"next",t)}function a(t){I(o,r,i,s,a,"throw",t)}s(void 0)}))}}function R(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,M(r.key),r)}}function M(t){var e=function(t){if("object"!=P(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}var A=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(r=O(T().mark((function t(){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n<section class="about-container">\n  <div class="about-header">\n    <h1>About This Application</h1>\n    <p>This application is designed to make it easier for users to share their stories visually through an interactive map. The goal is to connect experiences and places in one intuitive platform.</p>\n  </div>\n\n  <h2 class="section-title">Key Features</h2>\n  <div class="card-list">\n    <div class="card">\n      <i class="fas fa-map-marked-alt"></i>\n      <h3>Story Mapping</h3>\n      <p>Every story you share is directly linked to a location on the map, making it more vivid and contextual.</p>\n    </div>\n    <div class="card">\n      <i class="fas fa-user-shield"></i>\n      <h3>Privacy Ensured</h3>\n      <p>You have full control over who can view your stories. We take personal data seriously.</p>\n    </div>\n    <div class="card">\n      <i class="fas fa-mobile-alt"></i>\n      <h3>Responsive & Lightweight</h3>\n      <p>Designed to work seamlessly across various devices, from mobile to desktop, without compromising performance.</p>\n    </div>\n    <div class="card">\n      <i class="fas fa-bell"></i>\n      <h3>Push Notifications</h3>\n      <p>Get real-time updates and notifications about new stories and activities.</p>\n    </div>\n    <div class="card">\n      <i class="fas fa-download"></i>\n      <h3>PWA Support</h3>\n      <p>Install this app on your device and use it offline like a native application.</p>\n    </div>\n  </div>\n\n  <h2 class="section-title">Technologies Used</h2>\n  <div class="card-list">\n    <div class="card">\n      <i class="fab fa-js-square"></i>\n      <h3>JavaScript</h3>\n      <p>Used as the main language to build interactivity in this application.</p>\n    </div>\n    <div class="card">\n      <i class="fab fa-openlayers"></i>\n      <h3>OpenLayers</h3>\n      <p>An open-source mapping framework that enables dynamic and accurate location visualization.</p>\n    </div>\n    <div class="card">\n      <i class="fas fa-bell"></i>\n      <h3>Push API</h3>\n      <p>Enables push notifications to keep users updated in real-time.</p>\n    </div>\n    <div class="card">\n      <i class="fas fa-download"></i>\n      <h3>Progressive Web App (PWA)</h3>\n      <p>Allows the app to be installed and used offline, providing a native-like experience.</p>\n    </div>\n  </div>\n\n  <div class="about-footer">\n    <p>Developed by Dionysus. Contact me if you have suggestions or questions.</p>\n  </div>\n</section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=O(T().mark((function t(){return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&R(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function j(){j=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==F(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(F(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function D(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function N(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){D(o,r,i,s,a,"next",t)}function a(t){D(o,r,i,s,a,"throw",t)}s(void 0)}))}}function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,B(r.key),r)}}function B(t){var e=function(t){if("object"!=F(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=F(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==F(e)?e:e+""}var z={REGISTER:"".concat(e,"/register"),LOGIN:"".concat(e,"/login"),GET_STORIES:"".concat(e,"/stories"),ADD_STORY:"".concat(e,"/stories"),DETAIL_STORY:function(t){return"".concat(e,"/stories/").concat(t)}};const W=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"register",value:(s=N(j().mark((function t(e){var n,r,i,o;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.name,r=e.email,i=e.password,t.next=3,fetch(z.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,email:r,password:i})});case 3:return o=t.sent,t.abrupt("return",o.json());case 5:case"end":return t.stop()}}),t)}))),function(t){return s.apply(this,arguments)})},{key:"login",value:(o=N(j().mark((function t(e){var n,r,i;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.email,r=e.password,t.next=3,fetch(z.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})});case 3:return i=t.sent,t.abrupt("return",i.json());case 5:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"getStories",value:(i=N(j().mark((function t(e){var n,r,i,o,s,a=arguments;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(n=a.length>1&&void 0!==a[1]?a[1]:{page:1,size:10}).page,i=n.size,(o=new URL(z.GET_STORIES)).searchParams.append("page",r),o.searchParams.append("size",i),t.next=6,fetch(o,{headers:{Authorization:"Bearer ".concat(e)}});case 6:return s=t.sent,t.abrupt("return",s.json());case 8:case"end":return t.stop()}}),t)}))),function(t){return i.apply(this,arguments)})},{key:"addStory",value:(r=N(j().mark((function t(e,n){var r,i,o,s,a,l;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.description,i=e.photo,o=e.lat,s=e.lon,(a=new FormData).append("description",r),a.append("photo",i),void 0!==o&&void 0!==s&&(a.append("lat",o.toString()),a.append("lon",s.toString())),t.next=7,fetch(z.ADD_STORY,{method:"POST",headers:{Authorization:"Bearer ".concat(n)},body:a});case 7:return l=t.sent,t.abrupt("return",l.json());case 9:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})},{key:"getStoryById",value:(n=N(j().mark((function t(e,n){var r,i;return j().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(z.DETAIL_STORY(e),{headers:{Authorization:"Bearer ".concat(n)}});case 3:return r=t.sent,t.next=6,r.json();case 6:return i=t.sent,t.abrupt("return",i);case 10:return t.prev=10,t.t0=t.catch(0),console.error("Get story detail error:",t.t0),t.abrupt("return",{error:!0,message:t.t0.message});case 14:case"end":return t.stop()}}),t,null,[[0,10]])}))),function(t,e){return n.apply(this,arguments)})}],e&&G(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i,o,s}();var Y=i(465),K=i.n(Y);function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function V(){V=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==X(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(X(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function $(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Z(r.key),r)}}function Z(t){var e=function(t){if("object"!=X(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==X(e)?e:e+""}function q(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function H(t,e){return t.get(Q(t,e))}function J(t,e,n){return t.set(Q(t,e),n),n}function Q(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tt=new WeakMap,et=new WeakMap,nt=new WeakMap;const rt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),q(this,tt,null),q(this,et,1),q(this,nt,10),J(tt,this,e)},e=[{key:"getCurrentPage",value:function(){return H(et,this)}},{key:"loadStories",value:(n=V().mark((function t(){var e,n,r,i=arguments;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:1,t.prev=1,n=localStorage.getItem("token")){t.next=5;break}throw new Error("Token not found");case 5:return J(et,this,e),t.next=8,W.getStories(n,{page:H(et,this),size:H(nt,this)});case 8:if(!(r=t.sent).error){t.next=11;break}throw new Error(r.message);case 11:return t.abrupt("return",{stories:r.listStory,hasMore:r.listStory.length>=H(nt,this),currentPage:H(et,this)});case 14:return t.prev=14,t.t0=t.catch(1),t.next=18,K().fire({icon:"error",title:"Failed to Load Stories",text:t.t0.message});case 18:return"Token not found"===t.t0.message&&(window.location.hash="#/login"),t.abrupt("return",null);case 20:case"end":return t.stop()}}),t,this,[[1,14]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function s(t){$(o,r,i,s,a,"next",t)}function a(t){$(o,r,i,s,a,"throw",t)}s(void 0)}))},function(){return r.apply(this,arguments)})}],e&&U(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function st(t,e,n){return(e=function(t){var e=function(t){if("object"!=it(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=it(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==it(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function at(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Date(t).toLocaleDateString(e,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach((function(e){st(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({year:"numeric",month:"long",day:"numeric"},n))}const lt="add",ct="remove",ht="propertychange",ut="change",dt="contextmenu",ft="click",pt="keydown",gt="keypress",mt="touchmove",yt="wheel",vt=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function wt(t,e){return t>e?1:t<e?-1:0}function _t(t,e){return t<e?1:t>e?-1:0}function bt(t,e,n){if(t[0]<=e)return 0;const r=t.length;if(e<=t[r-1])return r-1;if("function"==typeof n){for(let i=1;i<r;++i){const r=t[i];if(r===e)return i;if(r<e)return n(e,t[i-1],r)>0?i-1:i}return r-1}if(n>0){for(let n=1;n<r;++n)if(t[n]<e)return n-1;return r-1}if(n<0){for(let n=1;n<r;++n)if(t[n]<=e)return n;return r-1}for(let n=1;n<r;++n){if(t[n]==e)return n;if(t[n]<e)return t[n-1]-e<e-t[n]?n-1:n}return r-1}function xt(t,e,n){for(;e<n;){const r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function Et(t,e){const n=Array.isArray(e)?e:[e],r=n.length;for(let e=0;e<r;e++)t[t.length]=n[e]}function St(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function Lt(){return!0}function Ct(){return!1}function kt(){}function Pt(t){let e,n,r;return function(){const i=Array.prototype.slice.call(arguments);return n&&this===r&&St(i,n)||(r=this,n=i,e=t.apply(this,arguments)),e}}function Tt(t){for(const e in t)delete t[e]}function It(t){let e;for(e in t)return!1;return!e}const Ot=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},Rt=class extends vt{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);r.includes(e)||r.push(e)}dispatchEvent(t){const e="string"==typeof t,n=e?t:t.type,r=this.listeners_&&this.listeners_[n];if(!r)return;const i=e?new Ot(t):t;i.target||(i.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});let a;n in o||(o[n]=0,s[n]=0),++o[n];for(let t=0,e=r.length;t<e;++t)if(a="handleEvent"in r[t]?r[t].handleEvent(i):r[t].call(this,i),!1===a||i.propagationStopped){a=!1;break}if(0==--o[n]){let t=s[n];for(delete s[n];t--;)this.removeEventListener(n,kt);delete o[n]}return a}disposeInternal(){this.listeners_&&Tt(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const r=n.indexOf(e);-1!==r&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=kt,++this.pendingRemovals_[t]):(n.splice(r,1),0===n.length&&delete this.listeners_[t]))}};function Mt(t,e,n,r,i){if(i){const i=n;n=function(o){return t.removeEventListener(e,n),i.call(r??this,o)}}else r&&r!==t&&(n=n.bind(r));const o={target:t,type:e,listener:n};return t.addEventListener(e,n),o}function At(t,e,n,r){return Mt(t,e,n,r,!0)}function Ft(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Tt(t))}class jt extends Rt{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ut)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Mt(this,t[i],e);return r}return Mt(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const r=t.length;n=new Array(r);for(let i=0;i<r;++i)n[i]=At(this,t[i],e)}else n=At(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)Ft(t[e]);else Ft(t)}(n);else if(Array.isArray(t))for(let n=0,r=t.length;n<r;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}jt.prototype.on,jt.prototype.once,jt.prototype.un;const Dt=jt;function Nt(){throw new Error("Unimplemented abstract method.")}let Gt=0;function Bt(t){return t.ol_uid||(t.ol_uid=String(++Gt))}class zt extends Ot{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}const Wt=class extends Dt{constructor(t){super(),this.on,this.once,this.un,Bt(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new zt(n,t,e)),n=ht,this.hasListener(n)&&this.dispatchEvent(new zt(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const r=this.values_||(this.values_={});if(n)r[t]=e;else{const n=r[t];r[t]=e,n!==e&&this.notify(t,n)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],It(this.values_)&&(this.values_=null),e||this.notify(t,n)}}},Yt="length";class Kt extends Ot{constructor(t,e,n){super(t),this.element=e,this.index=n}}const Xt=class extends Wt{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,r=e.length;n<r;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Yt)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Kt(lt,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Kt(ct,e,t)),e}setAt(t,e){if(t>=this.getLength())return void this.insertAt(t,e);if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Kt(ct,n,t)),this.dispatchEvent(new Kt(lt,e,t))}updateLength_(){this.set(Yt,this.array_.length)}assertUnique_(t,e){for(let n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}},Vt=class extends Ot{constructor(t,e,n){super(t),this.map=e,this.frameState=void 0!==n?n:null}},$t=class extends Vt{constructor(t,e,n,r,i,o){super(t,e,i),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==r&&r,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},Ut={SINGLECLICK:"singleclick",CLICK:ft,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Zt="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",qt=(Zt.includes("safari")&&!Zt.includes("chrom")&&(Zt.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Zt)),Zt.includes("webkit")&&!Zt.includes("edge")),Ht=Zt.includes("macintosh"),Jt="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Qt="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,te="undefined"!=typeof Image&&Image.prototype.decode,ee=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t}(),ne="pointerdown",re=class extends Rt{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=Mt(n,ne,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Mt(n,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(mt,this.boundHandleTouchMove_,!!ee&&{passive:!1})}emulateClick_(t){let e=new $t(Ut.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new $t(Ut.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout((()=>{this.clickTimeoutId_=void 0;const e=new $t(Ut.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}),250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==Ut.POINTERUP||e.type==Ut.POINTERCANCEL){delete this.trackedTouches_[n];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=Ut.POINTERDOWN&&e.type!=Ut.POINTERMOVE||(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new $t(Ut.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(Ft),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new $t(Ut.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Mt(t,Ut.POINTERMOVE,this.handlePointerMove_,this),Mt(t,Ut.POINTERUP,this.handlePointerUp_,this),Mt(this.element_,Ut.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(Mt(this.element_.getRootNode(),Ut.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new $t(Ut.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new $t(Ut.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Ft(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(mt,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Ft(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ft),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},ie="postrender",oe="loadstart",se="loadend",ae="layergroup",le="size",ce="target",he="view";function ue(t,e){if(!t)throw new Error(e)}const de=1/0,fe=class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Tt(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const r=this.keyFunction_(n);return delete this.queuedElements_[r],n}enqueue(t){ue(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=de&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,r=e.length,i=e[t],o=n[t],s=t;for(;t<r>>1;){const i=this.getLeftChildIndex_(t),o=this.getRightChildIndex_(t),s=o<r&&n[o]<n[i]?o:i;e[t]=e[s],n[t]=n[s],t=s}e[t]=i,n[t]=o,this.siftDown_(s,t)}siftDown_(t,e){const n=this.elements_,r=this.priorities_,i=n[e],o=r[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(r[t]>o))break;n[e]=n[t],r[e]=r[t],e=t}n[e]=i,r[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let r=0;const i=e.length;let o,s,a;for(s=0;s<i;++s)o=e[s],a=t(o),a==de?delete this.queuedElements_[this.keyFunction_(o)]:(n[r]=a,e[r++]=o);e.length=r,n.length=r,this.heapify_()}},pe=class extends fe{constructor(t,e){super((e=>t.apply(null,e)),(t=>t[0].getKey())),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(ut,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(2===n||3===n||4===n){3!==n&&e.removeEventListener(ut,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n=0;for(;this.tilesLoading_<t&&n<e&&this.getCount()>0;){const t=this.dequeue()[0],e=t.getKey();0!==t.getState()||e in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[e]=!0,++this.tilesLoading_,++n,t.load())}}},ge={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function me(t,e,n){return Math.min(Math.max(t,e),n)}function ye(t,e,n,r,i,o){const s=i-n,a=o-r;if(0!==s||0!==a){const l=((t-n)*s+(e-r)*a)/(s*s+a*a);l>1?(n=i,r=o):l>0&&(n+=s*l,r+=a*l)}return ve(t,e,n,r)}function ve(t,e,n,r){const i=n-t,o=r-e;return i*i+o*o}function we(t){return 180*t/Math.PI}function _e(t){return t*Math.PI/180}function be(t,e){const n=t%e;return n*e<0?n+e:n}function xe(t,e,n){return t+n*(e-t)}function Ee(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function Se(t,e){return Math.floor(Ee(t,e))}function Le(t,e){return Math.ceil(Ee(t,e))}function Ce(t,e,n){if(t>=e&&t<n)return t;const r=n-e;return((t-e)%r+r)%r+e}function ke(t,e,n){return function(r,i,o,s,a){if(!r)return;if(!i&&!e)return r;const l=e?0:o[0]*i,c=e?0:o[1]*i,h=a?a[0]:0,u=a?a[1]:0;let d=t[0]+l/2+h,f=t[2]-l/2+h,p=t[1]+c/2+u,g=t[3]-c/2+u;d>f&&(d=(f+d)/2,f=d),p>g&&(p=(g+p)/2,g=p);let m=me(r[0],d,f),y=me(r[1],p,g);if(s&&n&&i){const t=30*i;m+=-t*Math.log(1+Math.max(0,d-r[0])/t)+t*Math.log(1+Math.max(0,r[0]-f)/t),y+=-t*Math.log(1+Math.max(0,p-r[1])/t)+t*Math.log(1+Math.max(0,r[1]-g)/t)}return[m,y]}}function Pe(t){return t}function Te(t){const e=[1/0,1/0,-1/0,-1/0];for(let n=0,r=t.length;n<r;++n)We(e,t[n]);return e}function Ie(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function Oe(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Re(t,e,n){let r,i;return r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,i=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0,r*r+i*i}function Me(t,e){return Fe(t,e[0],e[1])}function Ae(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Fe(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function je(t,e){const n=t[0],r=t[1],i=t[2],o=t[3],s=e[0],a=e[1];let l=0;return s<n?l|=16:s>i&&(l|=4),a<r?l|=8:a>o&&(l|=2),0===l&&(l=1),l}function De(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function Ne(t){return De(1/0,1/0,-1/0,-1/0,t)}function Ge(t,e){const n=t[0],r=t[1];return De(n,r,n,r,e)}function Be(t,e,n,r,i){return Ye(Ne(i),t,e,n,r)}function ze(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function We(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Ye(t,e,n,r,i){for(;n<r;n+=i)Ke(t,e[n],e[n+1]);return t}function Ke(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function Xe(t,e){let n;return n=e($e(t)),n||(n=e(Ue(t)),n||(n=e(nn(t)),n||(n=e(en(t)),n||!1)))}function Ve(t){let e=0;return sn(t)||(e=rn(t)*Qe(t)),e}function $e(t){return[t[0],t[1]]}function Ue(t){return[t[2],t[1]]}function Ze(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function qe(t,e){let n;if("bottom-left"===e)n=$e(t);else if("bottom-right"===e)n=Ue(t);else if("top-left"===e)n=en(t);else{if("top-right"!==e)throw new Error("Invalid corner");n=nn(t)}return n}function He(t,e,n,r,i){const[o,s,a,l,c,h,u,d]=Je(t,e,n,r);return De(Math.min(o,a,c,u),Math.min(s,l,h,d),Math.max(o,a,c,u),Math.max(s,l,h,d),i)}function Je(t,e,n,r){const i=e*r[0]/2,o=e*r[1]/2,s=Math.cos(n),a=Math.sin(n),l=i*s,c=i*a,h=o*s,u=o*a,d=t[0],f=t[1];return[d-l+u,f-c-h,d-l-u,f-c+h,d+l-u,f+c+h,d+l+u,f+c-h,d-l+u,f-c-h]}function Qe(t){return t[3]-t[1]}function tn(t,e,n){const r=n||[1/0,1/0,-1/0,-1/0];return on(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):Ne(r),r}function en(t){return[t[0],t[3]]}function nn(t){return[t[2],t[3]]}function rn(t){return t[2]-t[0]}function on(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function sn(t){return t[2]<t[0]||t[3]<t[1]}function an(t,e){const n=e.getExtent(),r=Ze(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){const e=rn(n),i=Math.floor((r[0]-n[0])/e)*e;t[0]-=i,t[2]-=i}return t}function ln(t,e,n){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[r[0],t[1],r[2],t[3]]];an(t,e);const i=rn(r);if(rn(t)>i&&!n)return[[r[0],t[1],r[2],t[3]]];if(t[0]<r[0])return[[t[0]+i,t[1],r[2],t[3]],[r[0],t[1],t[2],t[3]]];if(t[2]>r[2])return[[t[0],t[1],r[2],t[3]],[r[0],t[1],t[2]-i,t[3]]]}return[t]}function cn(t,e){let n=!0;for(let r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function hn(t,e){const n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,o=t[1]*n+t[0]*r;return t[0]=i,t[1]=o,t}function un(t,e){if(e.canWrapX()){const n=rn(e.getExtent()),r=function(t,e,n){const r=e.getExtent();let i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||rn(r),i=Math.floor((t[0]-r[0])/n)),i}(t,e,n);r&&(t[0]-=r*n)}return t}function dn(t){return Math.pow(t,3)}function fn(t){return 1-dn(1-t)}function pn(t){return 3*t*t-2*t*t*t}function gn(t){return t}const mn=2;let yn=1;function vn(...t){yn>mn||console.warn(...t)}const wn={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},_n=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||wn[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},bn=6378137,xn=Math.PI*bn,En=[-xn,-xn,xn,xn],Sn=[-180,-85,180,85],Ln=bn*Math.log(Math.tan(Math.PI/2));class Cn extends _n{constructor(t){super({code:t,units:"m",extent:En,global:!0,worldExtent:Sn,getPointResolution:function(t,e){return t/Math.cosh(e[1]/bn)}})}}const kn=[new Cn("EPSG:3857"),new Cn("EPSG:102100"),new Cn("EPSG:102113"),new Cn("EPSG:900913"),new Cn("http://www.opengis.net/def/crs/EPSG/0/3857"),new Cn("http://www.opengis.net/gml/srs/epsg.xml#3857")];const Pn=[-180,-90,180,90],Tn=6378137*Math.PI/180;class In extends _n{constructor(t,e){super({code:t,units:"degrees",extent:Pn,axisOrientation:e,global:!0,metersPerUnit:Tn,worldExtent:Pn})}}const On=[new In("CRS:84"),new In("EPSG:4326","neu"),new In("urn:ogc:def:crs:OGC:1.3:CRS84"),new In("urn:ogc:def:crs:OGC:2:84"),new In("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new In("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new In("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Rn={},Mn={};function An(t,e,n){const r=t.getCode(),i=e.getCode();r in Mn||(Mn[r]={}),Mn[r][i]=n}function Fn(t,e){return t in Mn&&e in Mn[t]?Mn[t][e]:null}const jn=.9996,Dn=.00669438,Nn=Dn*Dn,Gn=Nn*Dn,Bn=Dn/(1-Dn),zn=Math.sqrt(1-Dn),Wn=(1-zn)/(1+zn),Yn=Wn*Wn,Kn=Yn*Wn,Xn=Kn*Wn,Vn=Xn*Wn,$n=.9983242984503243,Un=15*Nn/256+45*Gn/1024,Zn=35*Gn/3072,qn=1.5*Wn-27/32*Kn+269/512*Vn,Hn=21/16*Yn-55/32*Xn,Jn=151/96*Kn-417/128*Vn,Qn=1097/512*Xn,tr=6378137;function er(t,e,n){const r=t-5e5,i=(n.north?e:e-1e7)/jn/(tr*$n),o=i+qn*Math.sin(2*i)+Hn*Math.sin(4*i)+Jn*Math.sin(6*i)+Qn*Math.sin(8*i),s=Math.sin(o),a=s*s,l=Math.cos(o),c=s/l,h=c*c,u=h*h,d=1-Dn*a,f=Math.sqrt(1-Dn*a),p=Bn*l**2,g=p*p,m=r/(tr/f*jn),y=m*m,v=y*m,w=v*m,_=w*m,b=o-c/((1-Dn)/d)*(y/2-w/24*(5+3*h+10*p-4*g-9*Bn))+_*m/720*(61+90*h+298*p+45*u-252*Bn-3*g);let x=(m-v/6*(1+2*h+p)+_/120*(5-2*p+28*h-3*g+8*Bn+24*u))/l;return x=Ce(x+_e(rr(n.number)),-Math.PI,Math.PI),[we(x),we(b)]}function nr(t,e,n){t=Ce(t,-180,180),e<-80?e=-80:e>84&&(e=84);const r=_e(e),i=Math.sin(r),o=Math.cos(r),s=i/o,a=s*s,l=a*a,c=_e(t),h=_e(rr(n.number)),u=tr/Math.sqrt(1-Dn*i**2),d=Bn*o**2,f=o*Ce(c-h,-Math.PI,Math.PI),p=f*f,g=p*f,m=g*f,y=m*f,v=y*f,w=tr*($n*r-.002514607064228144*Math.sin(2*r)+Un*Math.sin(4*r)-Zn*Math.sin(6*r)),_=jn*u*(f+g/6*(1-a+d)+y/120*(5-18*a+l+72*d-58*Bn))+5e5;let b=jn*(w+u*s*(p/2+m/24*(5-a+9*d+4*d**2)+v/720*(61-58*a+l+600*d-330*Bn)));return n.north||(b+=1e7),[_,b]}function rr(t){return 6*(t-1)-180+3}const ir=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function or(t){let e=0;for(const n of ir){const r=t.match(n);if(r){e=parseInt(r[1]);break}}if(!e)return null;let n=0,r=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(r=!0,n=e-32600),n?{number:n,north:r}:null}function sr(t,e){return function(n,r,i,o){const s=n.length;i=i>1?i:2,o=o??i,r||(r=i>2?n.slice():new Array(s));for(let i=0;i<s;i+=o){const o=n[i],s=n[i+1],a=t(o,s,e);r[i]=a[0],r[i+1]=a[1]}return r}}function ar(t,e,n){n=n||6371008.8;const r=_e(t[1]),i=_e(e[1]),o=(i-r)/2,s=_e(e[0]-t[0])/2,a=Math.sin(o)*Math.sin(o)+Math.sin(s)*Math.sin(s)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const lr=[function(t){const e=or(t.getCode());return e?{forward:sr(nr,e),inverse:sr(er,e)}:null}],cr=[function(t){return or(t)?new _n({code:t,units:"m"}):null}];let hr=!0;function ur(t){hr=!(void 0===t||t)}function dr(t,e){if(void 0!==e)for(let n=0,r=t.length;n<r;++n)e[n]=t[n];else e=t.slice();return e}function fr(t){!function(t,e){Rn[t]=e}(t.getCode(),t),An(t,t,dr)}function pr(t){if("string"!=typeof t)return t;const e=Rn[n=t]||Rn[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null;var n;if(e)return e;for(const e of cr){const n=e(t);if(n)return n}return null}function gr(t,e,n,r){let i;const o=(t=pr(t)).getPointResolutionFunc();if(o){if(i=o(e,n),r&&r!==t.getUnits()){const e=t.getMetersPerUnit();e&&(i=i*e/wn[r])}}else{const o=t.getUnits();if("degrees"==o&&!r||"degrees"==r)i=e;else{const s=br(t,pr("EPSG:4326"));if(s||"degrees"===o){let t=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];t=s(t,t,2),i=(ar(t.slice(0,2),t.slice(2,4))+ar(t.slice(4,6),t.slice(6,8)))/2}else i=e*t.getMetersPerUnit();const a=r?wn[r]:t.getMetersPerUnit();void 0!==a&&(i/=a)}}return i}function mr(t){!function(t){t.forEach(fr)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&An(e,t,dr)}))}))}function yr(t,e){return t?"string"==typeof t?pr(t):t:pr(e)}function vr(t,e){return ur(),Sr(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")}function wr(t,e){const n=Sr(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),r=n[0];return(r<-180||r>180)&&(n[0]=be(r+180,360)-180),n}function _r(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||br(t,e)===dr)&&n}function br(t,e){const n=t.getCode(),r=e.getCode();let i=Fn(n,r);if(i)return i;let o=null,s=null;for(const n of lr)o||(o=n(t)),s||(s=n(e));if(!o&&!s)return null;const a="EPSG:4326";if(s)if(o)i=xr(o.inverse,s.forward);else{const t=Fn(n,a);t&&(i=xr(t,s.forward))}else{const t=Fn(a,r);t&&(i=xr(o.inverse,t))}return i&&(fr(t),fr(e),An(t,e,i)),i}function xr(t,e){return function(n,r,i,o){return r=t(n,r,i,o),e(r,r,i,o)}}function Er(t,e){return br(pr(t),pr(e))}function Sr(t,e,n){const r=Er(e,n);if(!r){const t=pr(e).getCode(),r=pr(n).getCode();throw new Error(`No transform available between ${t} and ${r}`)}return r(t,void 0,t.length)}let Lr=null;function Cr(){return Lr}function kr(t,e){return t}function Pr(t,e){return hr&&!cn(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(hr=!1,vn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function Tr(t,e){return t}function Ir(t,e){return t}function Or(t,e){return t}var Rr,Mr,Ar;function Fr(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function jr(t,e,n,r,i,o,s,a){const l=Math.sin(o),c=Math.cos(o);return t[0]=r*c,t[1]=i*l,t[2]=-r*l,t[3]=i*c,t[4]=s*r*c-a*r*l+e,t[5]=s*i*l+a*i*c+n,t}function Dr(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;ue(0!==n,"Transformation matrix cannot be inverted");const i=e[0],o=e[1],s=e[2],a=e[3],l=e[4],c=e[5];return t[0]=a/n,t[1]=-o/n,t[2]=-s/n,t[3]=i/n,t[4]=(s*c-a*l)/n,t[5]=-(i*c-o*l)/n,t}mr(kn),mr(On),Rr=kn,Mr=function(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,void 0===e&&(e=n>2?t.slice():new Array(i));for(let n=0;n<i;n+=r){e[n]=xn*t[n]/180;let r=bn*Math.log(Math.tan(Math.PI*(+t[n+1]+90)/360));r>Ln?r=Ln:r<-Ln&&(r=-Ln),e[n+1]=r}return e},Ar=function(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,void 0===e&&(e=n>2?t.slice():new Array(i));for(let n=0;n<i;n+=r)e[n]=180*t[n]/xn,e[n+1]=360*Math.atan(Math.exp(t[n+1]/bn))/Math.PI-90;return e},On.forEach((function(t){Rr.forEach((function(e){An(t,e,Mr),An(e,t,Ar)}))})),new Array(6);const Nr=[1e5,1e5,1e5,1e5,2,2];function Gr(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function Br(t,e,n,r,i,o,s){o=o||[],s=s||2;let a=0;for(let l=e;l<n;l+=r){const e=t[l],n=t[l+1];o[a++]=i[0]*e+i[2]*n+i[4],o[a++]=i[1]*e+i[3]*n+i[5];for(let e=2;e<s;e++)o[a++]=t[l+e]}return o&&o.length!=a&&(o.length=a),o}function zr(t,e,n,r,i,o,s){s=s||[];const a=Math.cos(i),l=Math.sin(i),c=o[0],h=o[1];let u=0;for(let i=e;i<n;i+=r){const e=t[i]-c,n=t[i+1]-h;s[u++]=c+e*a-n*l,s[u++]=h+e*l+n*a;for(let e=i+2;e<i+r;++e)s[u++]=t[e]}return s&&s.length!=u&&(s.length=u),s}const Wr=[1,0,0,1,0,0],Yr=[NaN,NaN],Kr=class extends Wt{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Pt(((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const r=this.clone();return r.applyTransform(n),r.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return Nt()}closestPointXY(t,e,n,r){return Nt()}containsXY(t,e){return 0===this.closestPointXY(t,e,Yr,Number.MIN_VALUE)}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return Nt()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Ne(t),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}rotate(t,e){Nt()}scale(t,e,n){Nt()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return Nt()}getType(){return Nt()}applyTransform(t){Nt()}intersectsExtent(t){return Nt()}translate(t,e){Nt()}transform(t,e){const n=pr(t),r="tile-pixels"==n.getUnits()?function(t,r,i){const o=n.getExtent(),s=n.getWorldExtent(),a=Qe(s)/Qe(o);jr(Wr,s[0],s[3],a,-a,0,0,0);const l=Br(t,0,t.length,i,Wr,r),c=Er(n,e);return c?c(l,l,i):l}:Er(n,e);return this.applyTransform(r),this}};function Xr(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const Vr=class extends Kr{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Be(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return Nt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Xr(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){Nt()}setLayout(t,e,n){let r;if(t)r=Xr(t);else{for(let t=0;t<n;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}r=e.length,t=function(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(r)}this.layout=t,this.stride=r}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();zr(n,0,n.length,r,t,e,n),this.changed()}}scale(t,e,n){void 0===e&&(e=t),n||(n=Ze(this.getExtent()));const r=this.getFlatCoordinates();if(r){const i=this.getStride();!function(t,e,n,r,i,o,s,a){a=a||[];const l=s[0],c=s[1];let h=0;for(let e=0;e<n;e+=r){const n=t[e]-l,s=t[e+1]-c;a[h++]=l+i*n,a[h++]=c+o*s;for(let n=e+2;n<e+r;++n)a[h++]=t[n]}a&&a.length!=h&&(a.length=h)}(r,0,r.length,i,t,e,n,r),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const r=this.getStride();!function(t,e,n,r,i,o,s){s=s||[];let a=0;for(let e=0;e<n;e+=r){s[a++]=t[e]+i,s[a++]=t[e+1]+o;for(let n=e+2;n<e+r;++n)s[a++]=t[n]}s&&s.length!=a&&(s.length=a)}(n,0,n.length,r,t,e,n),this.changed()}}};function $r(t,e,n,r){let i=0;const o=t[n-r],s=t[n-r+1];let a=0,l=0;for(;e<n;e+=r){const n=t[e]-o,r=t[e+1]-s;i+=l*n-a*r,a=n,l=r}return i/2}function Ur(t,e,n,r,i,o,s){const a=t[e],l=t[e+1],c=t[n]-a,h=t[n+1]-l;let u;if(0===c&&0===h)u=e;else{const d=((i-a)*c+(o-l)*h)/(c*c+h*h);if(d>1)u=n;else{if(d>0){for(let i=0;i<r;++i)s[i]=xe(t[e+i],t[n+i],d);return void(s.length=r)}u=e}}for(let e=0;e<r;++e)s[e]=t[u+e];s.length=r}function Zr(t,e,n,r,i){let o=t[e],s=t[e+1];for(e+=r;e<n;e+=r){const n=t[e],r=t[e+1],a=ve(o,s,n,r);a>i&&(i=a),o=n,s=r}return i}function qr(t,e,n,r,i,o,s,a,l,c,h){if(e==n)return c;let u,d;if(0===i){if(d=ve(s,a,t[e],t[e+1]),d<c){for(u=0;u<r;++u)l[u]=t[e+u];return l.length=r,d}return c}h=h||[NaN,NaN];let f=e+r;for(;f<n;)if(Ur(t,f-r,f,r,s,a,h),d=ve(s,a,h[0],h[1]),d<c){for(c=d,u=0;u<r;++u)l[u]=h[u];l.length=r,f+=r}else f+=r*Math.max((Math.sqrt(d)-Math.sqrt(c))/i|0,1);if(o&&(Ur(t,n-r,e,r,s,a,h),d=ve(s,a,h[0],h[1]),d<c)){for(c=d,u=0;u<r;++u)l[u]=h[u];l.length=r}return c}function Hr(t,e,n,r){for(let i=0,o=n.length;i<o;++i){const o=n[i];for(let n=0;n<r;++n)t[e++]=o[n]}return e}function Jr(t,e,n,r,i){i=void 0!==i?i:[];let o=0;for(let s=e;s<n;s+=r)i[o++]=t.slice(s,s+r);return i.length=o,i}function Qr(t,e,n,r,i){i=void 0!==i?i:[];let o=0;for(let s=0,a=n.length;s<a;++s){const a=n[s];i[o++]=Jr(t,e,a,r,i[o]),e=a}return i.length=o,i}function ti(t,e,n,r,i){i=void 0!==i?i:[];let o=0;for(let s=0,a=n.length;s<a;++s){const a=n[s];i[o++]=1===a.length&&a[0]===e?[]:Qr(t,e,a,r,i[o]),e=a[a.length-1]}return i.length=o,i}function ei(t,e,n,r,i,o,s){const a=(n-e)/r;if(a<3){for(;e<n;e+=r)o[s++]=t[e],o[s++]=t[e+1];return s}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[e,n-r];let h=0;for(;c.length>0;){const n=c.pop(),o=c.pop();let s=0;const a=t[o],u=t[o+1],d=t[n],f=t[n+1];for(let e=o+r;e<n;e+=r){const n=ye(t[e],t[e+1],a,u,d,f);n>s&&(h=e,s=n)}s>i&&(l[(h-e)/r]=1,o+r<h&&c.push(o,h),h+r<n&&c.push(h,n))}for(let n=0;n<a;++n)l[n]&&(o[s++]=t[e+n*r],o[s++]=t[e+n*r+1]);return s}function ni(t,e){return e*Math.round(t/e)}function ri(t,e,n,r,i,o,s){if(e==n)return s;let a,l,c=ni(t[e],i),h=ni(t[e+1],i);e+=r,o[s++]=c,o[s++]=h;do{if(a=ni(t[e],i),l=ni(t[e+1],i),(e+=r)==n)return o[s++]=a,o[s++]=l,s}while(a==c&&l==h);for(;e<n;){const n=ni(t[e],i),u=ni(t[e+1],i);if(e+=r,n==a&&u==l)continue;const d=a-c,f=l-h,p=n-c,g=u-h;d*g==f*p&&(d<0&&p<d||d==p||d>0&&p>d)&&(f<0&&g<f||f==g||f>0&&g>f)?(a=n,l=u):(o[s++]=a,o[s++]=l,c=a,h=l,a=n,l=u)}return o[s++]=a,o[s++]=l,s}function ii(t,e,n,r,i,o,s,a){for(let l=0,c=n.length;l<c;++l){const c=n[l];s=ri(t,e,c,r,i,o,s),a.push(s),e=c}return s}class oi extends Vr{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new oi(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,r){return r<Re(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Zr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}getArea(){return $r(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Jr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=ei(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new oi(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Hr(this.flatCoordinates,0,t,this.stride),this.changed()}}const si=oi;class ai extends Vr{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new ai(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,r){const i=this.flatCoordinates,o=ve(t,e,i[0],i[1]);if(o<r){const t=this.stride;for(let e=0;e<t;++e)n[e]=i[e];return n.length=t,o}return r}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Ge(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Fe(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n){for(let r=0,i=n.length;r<i;++r)t[e++]=n[r];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}const li=ai;function ci(t,e,n,r,i){return!Xe(i,(function(i){return!hi(t,e,n,r,i[0],i[1])}))}function hi(t,e,n,r,i,o){let s=0,a=t[n-r],l=t[n-r+1];for(;e<n;e+=r){const n=t[e],r=t[e+1];l<=o?r>o&&(n-a)*(o-l)-(i-a)*(r-l)>0&&s++:r<=o&&(n-a)*(o-l)-(i-a)*(r-l)<0&&s--,a=n,l=r}return 0!==s}function ui(t,e,n,r,i,o){if(0===n.length)return!1;if(!hi(t,e,n[0],r,i,o))return!1;for(let e=1,s=n.length;e<s;++e)if(hi(t,n[e-1],n[e],r,i,o))return!1;return!0}function di(t,e,n,r,i,o,s){let a,l,c,h,u,d,f;const p=i[o+1],g=[];for(let i=0,o=n.length;i<o;++i){const o=n[i];for(h=t[o-r],d=t[o-r+1],a=e;a<o;a+=r)u=t[a],f=t[a+1],(p<=d&&f<=p||d<=p&&p<=f)&&(c=(p-d)/(f-d)*(u-h)+h,g.push(c)),h=u,d=f}let m=NaN,y=-1/0;for(g.sort(wt),h=g[0],a=1,l=g.length;a<l;++a){u=g[a];const i=Math.abs(u-h);i>y&&(c=(h+u)/2,ui(t,e,n,r,c,p)&&(m=c,y=i)),h=u}return isNaN(m)&&(m=i[o]),s?(s.push(m,p,y),s):[m,p,y]}function fi(t,e,n,r,i,o){return o=o??Ye([1/0,1/0,-1/0,-1/0],t,e,n,r),!!on(i,o)&&(o[0]>=i[0]&&o[2]<=i[2]||o[1]>=i[1]&&o[3]<=i[3]||function(t,e,n,r){let o;for(e+=r;e<n;e+=r)if(s=t.slice(e-r,e),a=t.slice(e,e+r),o=function(t,e,n){let r=!1;const i=je(t,e),o=je(t,n);if(1===i||1===o)r=!0;else{const s=t[0],a=t[1],l=t[2],c=t[3],h=e[0],u=e[1],d=n[0],f=n[1],p=(f-u)/(d-h);let g,m;2&o&&!(2&i)&&(g=d-(f-c)/p,r=g>=s&&g<=l),r||!(4&o)||4&i||(m=f-(d-l)*p,r=m>=a&&m<=c),r||!(8&o)||8&i||(g=d-(f-a)/p,r=g>=s&&g<=l),r||!(16&o)||16&i||(m=f-(d-s)*p,r=m>=a&&m<=c)}return r}(i,s,a),o)return o;var s,a;return!1}(t,e,n,r))}function pi(t,e,n,r,i){return!!(fi(t,e,n,r,i)||hi(t,e,n,r,i[0],i[1])||hi(t,e,n,r,i[0],i[3])||hi(t,e,n,r,i[2],i[1])||hi(t,e,n,r,i[2],i[3]))}function gi(t,e,n,r){for(;e<n-r;){for(let i=0;i<r;++i){const o=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=o}e+=r,n-=r}}function mi(t,e,n,r){let i=0,o=t[n-r],s=t[n-r+1];for(;e<n;e+=r){const n=t[e],r=t[e+1];i+=(n-o)*(r+s),o=n,s=r}return 0===i?void 0:i>0}function yi(t,e,n,r,i){i=void 0!==i&&i;for(let o=0,s=n.length;o<s;++o){const s=n[o],a=mi(t,e,s,r);(0===o?i&&a||!i&&!a:i&&!a||!i&&a)&&gi(t,e,s,r),e=s}return e}class vi extends Vr{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Et(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new vi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,r){return r<Re(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,r,i){for(let o=0,s=n.length;o<s;++o){const s=n[o];i=Zr(t,e,s,r,i),e=s}return i}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,r,i,o,s,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=n.length;u<d;++u){const d=n[u];c=qr(t,e,d,r,i,o,s,a,l,c,h),e=d}return c}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}containsXY(t,e){return ui(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return function(t,e,n,r){let i=0;for(let o=0,s=n.length;o<s;++o){const s=n[o];i+=$r(t,e,s,r),e=s}return i}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),yi(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Qr(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Ze(this.getExtent());this.flatInteriorPoint_=di(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new li(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new si(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[];let i=0;for(let o=0,s=n.length;o<s;++o){const s=n[o],a=new si(e.slice(i,s),t);r.push(a),i=s}return r}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;!function(t,e,n,r,i){i=void 0!==i&&i;for(let o=0,s=n.length;o<s;++o){const s=n[o],a=mi(t,e,s,r);if(0===o){if(i&&a||!i&&!a)return!1}else if(i&&!a||!i&&a)return!1;e=s}return!0}(t,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=yi(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=ii(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new vi(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return function(t,e,n,r,i){if(!pi(t,e,n[0],r,i))return!1;if(1===n.length)return!0;for(let e=1,o=n.length;e<o;++e)if(ci(t,n[e-1],n[e],r,i)&&!fi(t,n[e-1],n[e],r,i))return!1;return!0}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=function(t,e,n,r,i){i=i||[];let o=0;for(let s=0,a=n.length;s<a;++s){const a=Hr(t,e,n[s],r);i[o++]=a,e=a}return i.length=o,i}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}const wi=vi;function _i(t){if(sn(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],r=t[2],i=t[3],o=[e,n,e,i,r,i,r,n,e,n];return new vi(o,"XY",[o.length])}function bi(t,e,n,r){const i=rn(e)/n[0],o=Qe(e)/n[1];return r?Math.min(t,Math.max(i,o)):Math.min(t,Math.min(i,o))}function xi(t,e,n){let r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(r=Math.max(r,n),r/=Math.log(1+50*Math.max(0,n/t-1))/50+1),me(r,n/2,2*e)}function Ei(t,e,n,r,i){return n=void 0===n||n,function(o,s,a,l){if(void 0!==o){const s=r?bi(t,r,a,i):t;return n&&l?xi(o,s,e):me(o,e,s)}}}function Si(t){if(void 0!==t)return 0}function Li(t){if(void 0!==t)return t}function Ci(t,e){setTimeout((function(){t(e)}),0)}function ki(t){return!(t.sourceCenter&&t.targetCenter&&!cn(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function Pi(t,e,n,r,i){const o=Math.cos(-i);let s=Math.sin(-i),a=t[0]*o-t[1]*s,l=t[1]*o+t[0]*s;return a+=(e[0]/2-n[0])*r,l+=(n[1]-e[1]/2)*r,s=-s,[a*o-l*s,l*o+a*s]}const Ti=class extends Wt{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=yr(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&ur(),t.center&&(t.center=Pr(t.center,this.projection_)),t.extent&&(t.extent=Ir(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const t in ge)delete e[t];this.setProperties(e,!0);const n=function(t){let e,n,r;let i=void 0!==t.minZoom?t.minZoom:0,o=void 0!==t.maxZoom?t.maxZoom:28;const s=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,l=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,c=void 0!==t.showFullExtent&&t.showFullExtent,h=yr(t.projection,"EPSG:3857"),u=h.getExtent();let d=t.constrainOnlyCenter,f=t.extent;if(a||f||!h.isGlobal()||(d=!1,f=u),void 0!==t.resolutions){const s=t.resolutions;n=s[i],r=void 0!==s[o]?s[o]:s[s.length-1],e=t.constrainResolution?function(t,e,n,r){return e=void 0===e||e,function(i,o,s,a){if(void 0!==i){const l=t[0],c=t[t.length-1],h=n?bi(l,n,s,r):l;if(a)return e?xi(i,h,c):me(i,c,h);const u=Math.min(h,i),d=Math.floor(bt(t,u,o));return t[d]>h&&d<t.length-1?t[d+1]:t[d]}}}(s,l,!d&&f,c):Ei(n,r,l,!d&&f,c)}else{const a=(u?Math.max(rn(u),Qe(u)):360*wn.degrees/h.getMetersPerUnit())/256/Math.pow(2,0),p=a/Math.pow(2,28);n=t.maxResolution,void 0!==n?i=0:n=a/Math.pow(s,i),r=t.minResolution,void 0===r&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(s,o):a/Math.pow(s,o):p),o=i+Math.floor(Math.log(n/r)/Math.log(s)),r=n/Math.pow(s,o-i),e=t.constrainResolution?function(t,e,n,r,i,o){return r=void 0===r||r,n=void 0!==n?n:0,function(s,a,l,c){if(void 0!==s){const h=i?bi(e,i,l,o):e;if(c)return r?xi(s,h,n):me(s,n,h);const u=1e-9,d=Math.ceil(Math.log(e/h)/Math.log(t)-u),f=-a*(.5-u)+.5,p=Math.min(h,s),g=Math.floor(Math.log(e/p)/Math.log(t)+f),m=Math.max(d,g);return me(e/Math.pow(t,m),n,h)}}}(s,n,r,l,!d&&f,c):Ei(n,r,l,!d&&f,c)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:i,zoomFactor:s}}(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const r=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return ke(t.extent,t.constrainOnlyCenter,e)}const e=yr(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,ke(t,!1,!1)}return Pe}(t),i=n.constraint,o=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(){const t=_e(5);return function(e,n){return n||void 0===e?e:Math.abs(e)<=t?0:e}}():!1===e?Li:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):Li}return Si}(t);this.constraints_={center:r,resolution:i,rotation:o},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const r=t||[0,0,0,0];e=e||[0,0,0,0];const i=this.getResolution(),o=i/2*(r[3]-e[3]+e[1]-r[1]),s=i/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([n[0]+o,n[1]-s])}}getUpdatedOptions_(t){const e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let n=arguments[t];n.center&&(n=Object.assign({},n),n.center=Pr(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=Pr(n.anchor,this.getProjection())),e[t]=n}this.animateInternal.apply(this,e)}animateInternal(t){let e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);let r=0;for(;r<n&&!this.isDef();++r){const t=arguments[r];t.center&&this.setCenterInternal(t.center),void 0!==t.zoom?this.setZoom(t.zoom):t.resolution&&this.setResolution(t.resolution),void 0!==t.rotation&&this.setRotation(t.rotation)}if(r===n)return void(e&&Ci(e,!0));let i=Date.now(),o=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_;const l=[];for(;r<n;++r){const t=arguments[r],n={start:i,complete:!1,anchor:t.anchor,duration:void 0!==t.duration?t.duration:1e3,easing:t.easing||pn,callback:e};if(t.center&&(n.sourceCenter=o,n.targetCenter=t.center.slice(),o=n.targetCenter),void 0!==t.zoom?(n.sourceResolution=s,n.targetResolution=this.getResolutionForZoom(t.zoom),s=n.targetResolution):t.resolution&&(n.sourceResolution=s,n.targetResolution=t.resolution,s=n.targetResolution),void 0!==t.rotation){n.sourceRotation=a;const e=be(t.rotation-a+Math.PI,2*Math.PI)-Math.PI;n.targetRotation=a+e,a=n.targetRotation}ki(n)?n.complete=!0:i+=n.duration,l.push(n)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}getAnimating(){return this.hints_[0]>0}getInteracting(){return this.hints_[1]>0}cancelAnimations(){let t;this.setHint(0,-this.hints_[0]);for(let e=0,n=this.animations_.length;e<n;++e){const n=this.animations_[e];if(n[0].callback&&Ci(n[0].callback,!1),!t)for(let e=0,r=n.length;e<r;++e){const r=n[e];if(!r.complete){t=r.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const r=this.animations_[n];let i=!0;for(let n=0,o=r.length;n<o;++n){const o=r[n];if(o.complete)continue;const s=t-o.start;let a=o.duration>0?s/o.duration:1;a>=1?(o.complete=!0,a=1):i=!1;const l=o.easing(a);if(o.sourceCenter){const t=o.sourceCenter[0],e=o.sourceCenter[1],n=o.targetCenter[0],r=o.targetCenter[1];this.nextCenter_=o.targetCenter;const i=t+l*(n-t),s=e+l*(r-e);this.targetCenter_=[i,s]}if(o.sourceResolution&&o.targetResolution){const t=1===l?o.targetResolution:o.sourceResolution+l*(o.targetResolution-o.sourceResolution);if(o.anchor){const e=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(n,o.anchor)}this.nextResolution_=o.targetResolution,this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==o.sourceRotation&&void 0!==o.targetRotation){const t=1===l?be(o.targetRotation+Math.PI,2*Math.PI)-Math.PI:o.sourceRotation+l*(o.targetRotation-o.sourceRotation);if(o.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,o.anchor)}this.nextRotation_=o.targetRotation,this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!o.complete)break}if(i){this.animations_[n]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const t=r[0].callback;t&&Ci(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const r=this.getCenterInternal();var i,o;return void 0!==r&&(n=[r[0]-e[0],r[1]-e[1]],hn(n,t-this.getRotation()),o=e,(i=n)[0]+=+o[0],i[1]+=+o[1]),n}calculateCenterZoom(t,e){let n;const r=this.getCenterInternal(),i=this.getResolution();return void 0!==r&&void 0!==i&&(n=[e[0]-t*(e[0]-r[0])/i,e[1]-t*(e[1]-r[1])/i]),n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?kr(t,this.getProjection()):t}getCenterInternal(){return this.get(ge.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return Tr(this.calculateExtentInternal(t),this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();ue(e,"The view center is not defined");const n=this.getResolution();ue(void 0!==n,"The view resolution is not defined");const r=this.getRotation();return ue(void 0!==r,"The view rotation is not defined"),He(e,n,r,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(ge.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Ir(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=rn(t)/e[0],r=Qe(t)/e[1];return Math.max(n,r)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*r)}}getRotation(){return this.get(ge.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/e;return function(t){return Math.log(n/t)/e/i}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let r=this.getCenterInternal();const i=this.padding_;if(i){const t=this.getViewportSizeMinusPadding_();r=Pi(r,this.getViewportSize_(),[t[0]/2+i[3],t[1]/2+i[0]],e,n)}return{center:r.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,n,r=this.minZoom_||0;if(this.resolutions_){const i=bt(this.resolutions_,t,1);r=i,e=this.resolutions_[i],n=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,n=this.zoomFactor_;return r+Math.log(e/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_?.length){if(1===this.resolutions_.length)return this.resolutions_[0];const e=me(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,me(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(ue(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))ue(!sn(t),"Cannot fit empty extent provided as `geometry`"),n=_i(Ir(t,this.getProjection()));else if("Circle"===t.getType()){const e=Ir(t.getExtent(),this.getProjection());n=_i(e),n.rotate(this.getRotation(),Ze(e))}else{const e=Cr();n=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),r=Math.sin(-e),i=t.getFlatCoordinates(),o=t.getStride();let s=1/0,a=1/0,l=-1/0,c=-1/0;for(let t=0,e=i.length;t<e;t+=o){const e=i[t]*n-i[t+1]*r,o=i[t]*r+i[t+1]*n;s=Math.min(s,e),a=Math.min(a,o),l=Math.max(l,e),c=Math.max(c,o)}return[s,a,l,c]}fitInternal(t,e){let n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());const r=void 0!==e.padding?e.padding:[0,0,0,0],i=void 0!==e.nearest&&e.nearest;let o;o=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;const s=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(s,[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]);a=isNaN(a)?o:Math.max(a,o),a=this.getConstrainedResolution(a,i?0:1);const l=this.getRotation(),c=Math.sin(l),h=Math.cos(l),u=Ze(s);u[0]+=(r[1]-r[3])/2*a,u[1]+=(r[0]-r[2])/2*a;const d=u[0]*h-u[1]*c,f=u[1]*h+u[0]*c,p=this.getConstrainedCenter([d,f],a),g=e.callback?e.callback:kt;void 0!==e.duration?this.animateInternal({resolution:a,center:p,duration:e.duration,easing:e.easing},g):(this.targetResolution_=a,this.targetCenter_=p,this.applyTargetState_(!1,!0),Ci(g,!0))}centerOn(t,e,n){this.centerOnInternal(Pr(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(Pi(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,r){let i;const o=this.padding_;if(o&&t){const s=this.getViewportSizeMinusPadding_(-n),a=Pi(t,r,[s[0]/2+o[3],s[1]/2+o[0]],e,n);i=[t[0]-a[0],t[1]-a[1]]}return i}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=kr(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Pr(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Pr(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t?Pr(t,this.getProjection()):t)}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),i=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,i,n),s=this.constraints_.center(this.targetCenter_,o,i,n,this.calculateCenterShift(this.targetCenter_,o,r,i));this.get(ge.ROTATION)!==r&&this.set(ge.ROTATION,r),this.get(ge.RESOLUTION)!==o&&(this.set(ge.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),s&&this.get(ge.CENTER)&&cn(this.get(ge.CENTER),s)||this.set(ge.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=void 0!==t?t:200;const r=e||0,i=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(i),s=this.constraints_.resolution(this.targetResolution_,r,o),a=this.constraints_.center(this.targetCenter_,s,o,!1,this.calculateCenterShift(this.targetCenter_,s,i,o));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=s,this.targetRotation_=i,this.targetCenter_=a,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===s&&this.getRotation()===i&&this.getCenterInternal()&&cn(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:i,center:a,resolution:s,duration:t,easing:fn,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,n){n=n&&Pr(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}},Ii="ol-hidden",Oi="ol-unselectable",Ri="ol-control",Mi="ol-collapsed",Ai=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z0-9]+?)\\s*$"].join(""),"i"),Fi=["style","variant","weight","size","lineHeight","family"],ji=function(t){const e=t.match(Ai);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let t=0,r=Fi.length;t<r;++t){const r=e[t+1];void 0!==r&&(n[Fi[t]]=r)}return n.families=n.family.split(/,\s?/),n};function Di(t,e,n,r){let i;return i=n&&n.length?n.shift():Qt?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}let Ni;function Gi(){return Ni||(Ni=Di(1,1)),Ni}function Bi(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function zi(t){let e=t.offsetWidth;const n=getComputedStyle(t);return e+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10),e}function Wi(t){let e=t.offsetHeight;const n=getComputedStyle(t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10),e}function Yi(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function Ki(t){for(;t.lastChild;)t.lastChild.remove()}const Xi=class extends Wt{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&this.element?.remove();for(let t=0,e=this.listenerKeys.length;t<e;++t)Ft(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=t,t){const e=this.target_??t.getOverlayContainerStopEvent();this.element&&e.appendChild(this.element),this.render!==kt&&this.listenerKeys.push(Mt(t,ie,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},Vi=class extends Xi{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=void 0!==t.className?t.className:"ol-attribution",n=void 0!==t.tipLabel?t.tipLabel:"Attributions",r=void 0!==t.expandClassName?t.expandClassName:e+"-expand",i=void 0!==t.collapseLabel?t.collapseLabel:"",o=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse";"string"==typeof i?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=i,this.collapseLabel_.className=o):this.collapseLabel_=i;const s=void 0!==t.label?t.label:"i";"string"==typeof s?(this.label_=document.createElement("span"),this.label_.textContent=s,this.label_.className=r):this.label_=s;const a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(a),this.toggleButton_.addEventListener(ft,this.handleClick_.bind(this),!1);const l=e+" "+Oi+" "+Ri+(this.collapsed_&&this.collapsible_?" "+Mi:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=l,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),n=new Set(e.flatMap((e=>e.getAttributions(t))));if(void 0!==this.attributions_&&(Array.isArray(this.attributions_)?this.attributions_.forEach((t=>n.add(t))):n.add(this.attributions_)),!this.overrideCollapsible_){const t=!e.some((t=>!1===t.getSource()?.getAttributionsCollapsible()));this.setCollapsible(t)}return Array.from(n)}async updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=await Promise.all(this.collectSourceAttributions_(t).map((t=>{return e=()=>t,function(){let t;try{t=e()}catch(t){return Promise.reject(t)}return t instanceof Promise?t:Promise.resolve(t)}();var e}))),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!St(e,this.renderedAttributions_)){Ki(this.ulElement_);for(let t=0,n=e.length;t<n;++t){const n=document.createElement("li");n.innerHTML=e[t],this.ulElement_.appendChild(n)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Mi),this.collapsed_?Yi(this.collapseLabel_,this.label_):Yi(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},$i=class extends Xi{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=void 0!==t.className?t.className:"ol-rotate",n=void 0!==t.label?t.label:"",r=void 0!==t.compassClassName?t.compassClassName:"ol-compass";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className=r,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(r));const i=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=i,o.appendChild(this.label_),o.addEventListener(ft,this.handleClick_.bind(this),!1);const s=e+" "+Oi+" "+Ri,a=this.element;a.className=s,a.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ii)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:fn}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const t="rotate("+n+"rad)";if(this.autoHide_){const t=this.element.classList.contains(Ii);t||0!==n?t&&0!==n&&this.element.classList.remove(Ii):this.element.classList.add(Ii)}this.label_.style.transform=t}this.rotation_=n}},Ui=class extends Xi{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=void 0!==t.className?t.className:"ol-zoom",n=void 0!==t.delta?t.delta:1,r=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",i=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",o=void 0!==t.zoomInLabel?t.zoomInLabel:"+",s=void 0!==t.zoomOutLabel?t.zoomOutLabel:"",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=r,c.setAttribute("type","button"),c.title=a,c.appendChild("string"==typeof o?document.createTextNode(o):o),c.addEventListener(ft,this.handleClick_.bind(this,n),!1);const h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=l,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(ft,this.handleClick_.bind(this,-n),!1);const u=e+" "+Oi+" "+Ri,d=this.element;d.className=u,d.appendChild(c),d.appendChild(h),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const n=e.getZoom();if(void 0!==n){const r=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:r,duration:this.duration_,easing:fn})):e.setZoom(r)}}};function Zi(t){t=t||{};const e=new Xt;return(void 0===t.zoom||t.zoom)&&e.push(new Ui(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new $i(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new Vi(t.attributionOptions)),e}const qi=class{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;const i=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,i),this.initialVelocity_=Math.sqrt(i*i+o*o)/r,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}},Hi="active";function Ji(t,e,n,r){const i=t.getZoom();if(void 0===i)return;const o=t.getConstrainedZoom(i+e),s=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:s,anchor:n,duration:void 0!==r?r:250,easing:fn})}const Qi=class extends Wt{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Hi)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Hi,t)}setMap(t){this.map_=t}},to=class extends Qi{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;if(t.type==Ut.DBLCLICK){const n=t.originalEvent,r=t.map,i=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_;Ji(r.getView(),o,i,this.duration_),n.preventDefault(),e=!0}return!e}};function eo(t){const e=arguments;return function(t){let n=!0;for(let r=0,i=e.length;r<i&&(n=n&&e[r](t),n);++r);return n}}const no=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ro=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return!(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")||function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),r=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):e.contains(r)}(t)},io=Lt,oo=function(t){const e=t.originalEvent;return e instanceof PointerEvent&&0==e.button&&!(qt&&Ht&&e.ctrlKey)},so=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},ao=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},lo=function(t){const e=t.originalEvent,n=e.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!e.target.isContentEditable},co=function(t){const e=t.originalEvent;return e instanceof PointerEvent&&"mouse"==e.pointerType},ho=function(t){const e=t.originalEvent;return e instanceof PointerEvent&&e.isPrimary&&0===e.button};function uo(t){const e=t.length;let n=0,r=0;for(let i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}const fo=class extends Qi{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Ut.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Ut.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==Ut.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Ut.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}},po=class extends fo{constructor(t){super({stopDown:Ct}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:eo(so,ho);this.condition_=t.onFocusOnly?eo(ro,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,r=e.getEventPixel(uo(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){const e=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],n=t.map.getView();i=e,o=n.getResolution(),i[0]*=o,i[1]*=o,hn(e,n.getRotation()),n.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var i,o;this.lastCentroid=r,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),i=n.getCenterInternal(),o=e.getPixelFromCoordinateInternal(i),s=e.getCoordinateFromPixelInternal([o[0]-t*Math.cos(r),o[1]-t*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(s),duration:500,easing:fn})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}},go=class extends fo{constructor(t){t=t||{},super({stopDown:Ct}),this.condition_=t.condition?t.condition:no,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(!co(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===Si)return;const r=e.getSize(),i=t.pixel,o=Math.atan2(r[1]/2-i[1],i[0]-r[0]/2);if(void 0!==this.lastAngle_){const t=o-this.lastAngle_;n.adjustRotationInternal(-t)}this.lastAngle_=o}handleUpEvent(t){return!co(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!!co(t)&&(!(!oo(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}},mo=class extends vt{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+n,r.top=Math.min(t[1],e[1])+n,r.width=Math.abs(e[0]-t[0])+n,r.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new wi([n])}getGeometry(){return this.geometry_}},yo="boxcancel";class vo extends Ot{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}const wo=class extends fo{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new mo(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??oo,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const r=n[0]-e[0],i=n[1]-e[1];return r*r+i*i>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new vo("boxdrag",t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new vo(e?"boxend":yo,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new vo("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new vo(yo,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new vo(yo,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}},_o=class extends wo{constructor(t){super({condition:(t=t||{}).condition?t.condition:ao,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){const e=this.getMap().getView();let n=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(n),r=e.getResolutionForExtentInternal(t),i=e.getResolution()/r;n=n.clone(),n.scale(i*i)}e.fitInternal(n,{duration:this.duration_,easing:fn})}},bo="ArrowLeft",xo="ArrowRight",Eo="ArrowDown",So=class extends Qi{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return so(t)&&lo(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==pt){const n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==Eo||r==bo||r==xo||"ArrowUp"==r)){const i=t.map.getView(),o=i.getResolution()*this.pixelDelta_;let s=0,a=0;r==Eo?a=-o:r==bo?s=-o:r==xo?s=o:a=o;const l=[s,a];hn(l,i.getRotation()),function(t,e,n){const r=t.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:gn,center:t.getConstrainedCenter(i)})}}(i,l,this.duration_),n.preventDefault(),e=!0}}return!e}},Lo=class extends Qi{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(t){return!function(t){const e=t.originalEvent;return Ht?e.metaKey:e.ctrlKey}(t)&&lo(t)},this.delta_=t.delta?t.delta:1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;if(t.type==pt||t.type==gt){const n=t.originalEvent,r=n.key;if(this.condition_(t)&&("+"===r||"-"===r)){const i=t.map,o="+"===r?this.delta_:-this.delta_;Ji(i.getView(),o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}},Co=class extends Qi{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;const e=t.condition?t.condition:io;this.condition_=t.onFocusOnly?eo(ro,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==yt)return!0;const e=t.map,n=t.originalEvent;let r;if(n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel),t.type==yt&&(r=n.deltaY,n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(r*=40)),0===r)return!1;this.lastDelta_=r;const i=Date.now();void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const o=e.getView();if("trackpad"===this.mode_&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=i,!1;this.totalDelta_+=r;const s=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),s),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-me(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Ji(e,n,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}},ko=class extends fo{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=Ct),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],r=this.targetPointers[1],i=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(void 0!==this.lastAngle_){const t=i-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=i;const o=t.map,s=o.getView();s.getConstraints().rotation!==Si&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(uo(this.targetPointers))),this.rotating_&&(o.render(),s.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},Po=class extends fo{constructor(t){const e=t=t||{};e.stopDown||(e.stopDown=Ct),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],r=this.targetPointers[1],i=n.clientX-r.clientX,o=n.clientY-r.clientY,s=Math.sqrt(i*i+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/s),this.lastDistance_=s;const a=t.map,l=a.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(uo(this.targetPointers))),a.render(),l.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}},To="opacity",Io="visible",Oo="extent",Ro="zIndex",Mo="maxResolution",Ao="minResolution",Fo="maxZoom",jo="minZoom",Do="source",No=class extends Wt{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e[To]=void 0!==t.opacity?t.opacity:1,ue("number"==typeof e[To],"Layer opacity must be a number"),e[Io]=void 0===t.visible||t.visible,e[Ro]=t.zIndex,e[Mo]=void 0!==t.maxResolution?t.maxResolution:1/0,e[Ao]=void 0!==t.minResolution?t.minResolution:0,e[jo]=void 0!==t.minZoom?t.minZoom:-1/0,e[Fo]=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=me(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n||e.managed?n:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return Nt()}getLayerStatesArray(t){return Nt()}getExtent(){return this.get(Oo)}getMaxResolution(){return this.get(Mo)}getMinResolution(){return this.get(Ao)}getMinZoom(){return this.get(jo)}getMaxZoom(){return this.get(Fo)}getOpacity(){return this.get(To)}getSourceState(){return Nt()}getVisible(){return this.get(Io)}getZIndex(){return this.get(Ro)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Oo,t)}setMaxResolution(t){this.set(Mo,t)}setMinResolution(t){this.set(Ao,t)}setMaxZoom(t){this.set(Fo,t)}setMinZoom(t){this.set(jo,t)}setOpacity(t){ue("number"==typeof t,"Layer opacity must be a number"),this.set(To,t)}setVisible(t){this.set(Io,t)}setZIndex(t){this.set(Ro,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}};class Go extends Ot{constructor(t,e){super(t),this.layer=e}}const Bo="layers";class zo extends No{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Bo,this.handleLayersChanged_),n?Array.isArray(n)?n=new Xt(n.slice(),{unique:!0}):ue("function"==typeof n.getArray,"Expected `layers` to be an array or a `Collection`"):n=new Xt(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Ft),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(Mt(t,lt,this.handleLayersAdd_,this),Mt(t,ct,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(Ft);Tt(this.listenerKeys_);const e=t.getArray();for(let t=0,n=e.length;t<n;t++){const n=e[t];this.registerLayerListeners_(n),this.dispatchEvent(new Go("addlayer",n))}this.changed()}registerLayerListeners_(t){const e=[Mt(t,ht,this.handleLayerChange_,this),Mt(t,ut,this.handleLayerChange_,this)];t instanceof zo&&e.push(Mt(t,"addlayer",this.handleLayerGroupAdd_,this),Mt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[Bt(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Go("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Go("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Go("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=Bt(e);this.listenerKeys_[n].forEach(Ft),delete this.listenerKeys_[n],this.dispatchEvent(new Go("removelayer",e)),this.changed()}getLayers(){return this.get(Bo)}setLayers(t){const e=this.getLayers();if(e){const t=e.getArray();for(let e=0,n=t.length;e<n;++e)this.dispatchEvent(new Go("removelayer",t[e]))}this.set(Bo,t)}getLayersArray(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}getLayerStatesArray(t){const e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const r=this.getLayerState();let i=r.zIndex;t||void 0!==r.zIndex||(i=0);for(let t=n,o=e.length;t<o;t++){const n=e[t];n.opacity*=r.opacity,n.visible=n.visible&&r.visible,n.maxResolution=Math.min(n.maxResolution,r.maxResolution),n.minResolution=Math.max(n.minResolution,r.minResolution),n.minZoom=Math.max(n.minZoom,r.minZoom),n.maxZoom=Math.min(n.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==n.extent?n.extent=tn(n.extent,r.extent):n.extent=r.extent),void 0===n.zIndex&&(n.zIndex=i)}return e}getSourceState(){return"ready"}}const Wo=zo,Yo="prerender",Ko="postrender",Xo="precompose",Vo="rendercomplete";function $o(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}const Uo=class extends No{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(Do,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(Do)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Ft(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=Mt(t,ut,this.handleSourceChange_,this),"ready"===t.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0)),this.clearRenderer()),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}isVisible(t){let e;const n=this.getMapInternal();let r;if(!t&&n&&(t=n.getView()),e=t instanceof Ti?{viewState:t.getState(),extent:t.calculateExtent()}:t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray()),e.layerStatesArray){if(r=e.layerStatesArray.find((t=>t.layer===this)),!r)return!1}else r=this.getLayerState();const i=this.getExtent();return $o(r,e.viewState)&&(!i||on(i,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];let n=e(t instanceof Ti?t.getViewStateAndExtent():t);return Array.isArray(n)||(n=[n]),n}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(Ft(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Ft(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Mt(t,Xo,this.handlePrecompose_,this),this.mapRenderKey_=Mt(this,ut,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,n=this.getLayerState(!1);ue(!e.some((t=>t.layer===n.layer)),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(n)}setSource(t){this.set(Do,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}};function Zo(t,e,n=0,r=t.length-1,i=Ho){for(;r>n;){if(r-n>600){const o=r-n+1,s=e-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);Zo(t,e,Math.max(n,Math.floor(e-s*l/o+c)),Math.min(r,Math.floor(e+(o-s)*l/o+c)),i)}const o=t[e];let s=n,a=r;for(qo(t,n,e),i(t[r],o)>0&&qo(t,n,r);s<a;){for(qo(t,s,a),s++,a--;i(t[s],o)<0;)s++;for(;i(t[a],o)>0;)a--}0===i(t[n],o)?qo(t,n,a):(a++,qo(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function qo(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Ho(t,e){return t<e?-1:t>e?1:0}class Jo{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!cs(t,e))return n;const r=this.toBBox,i=[];for(;e;){for(let o=0;o<e.children.length;o++){const s=e.children[o],a=e.leaf?r(s):s;cs(t,a)&&(e.leaf?n.push(s):ls(t,a)?this._all(s,n):i.push(s))}e=i.pop()}return n}collides(t){let e=this.data;if(!cs(t,e))return!1;const n=[];for(;e;){for(let r=0;r<e.children.length;r++){const i=e.children[r],o=e.leaf?this.toBBox(i):i;if(cs(t,o)){if(e.leaf||ls(t,o))return!0;n.push(i)}}e=n.pop()}return!1}load(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(let e=0;e<t.length;e++)this.insert(t[e]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const t=this.data;this.data=e,e=t}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=hs([]),this}remove(t,e){if(!t)return this;let n=this.data;const r=this.toBBox(t),i=[],o=[];let s,a,l;for(;n||i.length;){if(n||(n=i.pop(),a=i[i.length-1],s=o.pop(),l=!0),n.leaf){const r=Qo(t,n.children,e);if(-1!==r)return n.children.splice(r,1),i.push(n),this._condense(i),this}l||n.leaf||!ls(n,r)?a?(s++,n=a.children[s],l=!1):n=null:(i.push(n),o.push(s),s=0,a=n,n=n.children[0])}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,r){const i=n-e+1;let o,s=this._maxEntries;if(i<=s)return o=hs(t.slice(e,n+1)),ts(o,this.toBBox),o;r||(r=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/Math.pow(s,r-1))),o=hs([]),o.leaf=!1,o.height=r;const a=Math.ceil(i/s),l=a*Math.ceil(Math.sqrt(s));us(t,e,n,l,this.compareMinX);for(let i=e;i<=n;i+=l){const e=Math.min(i+l-1,n);us(t,i,e,a,this.compareMinY);for(let n=i;n<=e;n+=a){const i=Math.min(n+a-1,e);o.children.push(this._build(t,n,i,r-1))}}return ts(o,this.toBBox),o}_chooseSubtree(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){let n,r=1/0,s=1/0;for(let a=0;a<e.children.length;a++){const l=e.children[a],c=os(l),h=(i=t,o=l,(Math.max(o.maxX,i.maxX)-Math.min(o.minX,i.minX))*(Math.max(o.maxY,i.maxY)-Math.min(o.minY,i.minY))-c);h<s?(s=h,r=c<r?c:r,n=l):h===s&&c<r&&(r=c,n=l)}e=n||e.children[0]}var i,o;return e}_insert(t,e,n){const r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),ns(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)}_split(t,e){const n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);const o=this._chooseSplitIndex(n,i,r),s=hs(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,ts(n,this.toBBox),ts(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)}_splitRoot(t,e){this.data=hs([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ts(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let r,i=1/0,o=1/0;for(let s=e;s<=n-e;s++){const e=es(t,0,s,this.toBBox),a=es(t,s,n,this.toBBox),l=as(e,a),c=os(e)+os(a);l<i?(i=l,r=s,o=c<o?c:o):l===i&&c<o&&(o=c,r=s)}return r||n-e}_chooseSplitAxis(t,e,n){const r=t.leaf?this.compareMinX:rs,i=t.leaf?this.compareMinY:is;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)}_allDistMargin(t,e,n,r){t.children.sort(r);const i=this.toBBox,o=es(t,0,e,i),s=es(t,n-e,n,i);let a=ss(o)+ss(s);for(let r=e;r<n-e;r++){const e=t.children[r];ns(o,t.leaf?i(e):e),a+=ss(o)}for(let r=n-e-1;r>=e;r--){const e=t.children[r];ns(s,t.leaf?i(e):e),a+=ss(s)}return a}_adjustParentBBoxes(t,e,n){for(let r=n;r>=0;r--)ns(e[r],t)}_condense(t){for(let e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children,e.splice(e.indexOf(t[n]),1)):this.clear():ts(t[n],this.toBBox)}}function Qo(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function ts(t,e){es(t,0,t.children.length,e,t)}function es(t,e,n,r,i){i||(i=hs(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=e;o<n;o++){const e=t.children[o];ns(i,t.leaf?r(e):e)}return i}function ns(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function rs(t,e){return t.minX-e.minX}function is(t,e){return t.minY-e.minY}function os(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function ss(t){return t.maxX-t.minX+(t.maxY-t.minY)}function as(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-r)}function ls(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function cs(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function hs(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function us(t,e,n,r,i){const o=[e,n];for(;o.length;){if((n=o.pop())-(e=o.pop())<=r)continue;const s=e+Math.ceil((n-e)/r/2)*r;Zo(t,s,e,n,i),o.push(e,s,s,n)}}const ds=[NaN,NaN,NaN,0];let fs;const ps=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,gs=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ms=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ys=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function vs(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function ws(t){throw new Error('failed to parse "'+t+'" as color')}function _s(t){if(t.toLowerCase().startsWith("rgb")){const e=t.match(gs)||t.match(ps)||t.match(ms);if(e){const t=e[4],n=100/255;return[me(vs(e[1],n)+.5|0,0,255),me(vs(e[2],n)+.5|0,0,255),me(vs(e[3],n)+.5|0,0,255),void 0!==t?me(vs(t,100),0,1):1]}ws(t)}if(t.startsWith("#")){if(ys.test(t)){const e=t.substring(1),n=e.length<=4?1:2,r=[0,0,0,255];for(let t=0,i=e.length;t<i;t+=n){let i=parseInt(e.substring(t,t+n),16);1===n&&(i+=i<<4),r[t/n]=i}return r[3]=r[3]/255,r}ws(t)}const e=(fs||(fs=Di(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),fs);e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&ws(t));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return _s(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=Ee(i[3]/255,3),i}const bs={};let xs=0;function Es(t){if(4===t.length)return t;const e=t.slice();return e[3]=1,e}function Ss(t){return t>.0031308?269.025*Math.pow(t,1/2.4)-14.025:3294.6*t}function Ls(t){return t>.2068965?Math.pow(t,3):108/841*(t-4/29)}function Cs(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function ks(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function Ps(t){const e=Cs(t[0]),n=Cs(t[1]),r=Cs(t[2]),i=ks(.222488403*e+.716873169*n+.06060791*r),o=500*(ks(.452247074*e+.399439023*n+.148375274*r)-i),s=200*(i-ks(.016863605*e+.117638439*n+.865350722*r)),a=Math.atan2(s,o)*(180/Math.PI);return[116*i-16,Math.sqrt(o*o+s*s),a<0?a+360:a,t[3]]}function Ts(t){if("none"===t)return ds;if(bs.hasOwnProperty(t))return bs[t];if(xs>=1024){let t=0;for(const e in bs)3&t++||(delete bs[e],--xs)}const e=_s(t);4!==e.length&&ws(t);for(const n of e)isNaN(n)&&ws(t);return bs[t]=e,++xs,e}function Is(t){return Array.isArray(t)?t:Ts(t)}function Os(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let n=t[1];n!=(0|n)&&(n=n+.5|0);let r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+e+","+n+","+r+","+(void 0===t[3]?1:Math.round(1e3*t[3])/1e3)+")"}function Rs(t){return t[0]>0&&t[1]>0}function Ms(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}let As=0;const Fs=1<<As++,js=1<<As++,Ds=1<<As++,Ns=1<<As++,Gs=1<<As++,Bs=1<<As++,zs=Math.pow(2,6)-1,Ws={[Fs]:"boolean",[js]:"number",[Ds]:"string",[Ns]:"color",[Gs]:"number[]",[Bs]:"size"},Ys=Object.keys(Ws).map(Number).sort(wt);function Ks(t){const e=[];for(const n of Ys)Xs(t,n)&&e.push(Ws[n]);return 0===e.length?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Xs(t,e){return(t&e)===e}function Vs(t,e){return t===e}class $s{constructor(t,e){if(!function(t){return t in Ws}(t))throw new Error(`literal expressions must have a specific type, got ${Ks(t)}`);this.type=t,this.value=e}}class Us{constructor(t,e,...n){this.type=t,this.operator=e,this.args=n}}function Zs(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function qs(t,e,n){switch(typeof t){case"boolean":if(Vs(e,Ds))return new $s(Ds,t?"true":"false");if(!Xs(e,Fs))throw new Error(`got a boolean, but expected ${Ks(e)}`);return new $s(Fs,t);case"number":if(Vs(e,Bs))return new $s(Bs,Ms(t));if(Vs(e,Fs))return new $s(Fs,!!t);if(Vs(e,Ds))return new $s(Ds,t.toString());if(!Xs(e,js))throw new Error(`got a number, but expected ${Ks(e)}`);return new $s(js,t);case"string":if(Vs(e,Ns))return new $s(Ns,Ts(t));if(Vs(e,Fs))return new $s(Fs,!!t);if(!Xs(e,Ds))throw new Error(`got a string, but expected ${Ks(e)}`);return new $s(Ds,t)}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(0===t.length)throw new Error("empty expression");if("string"==typeof t[0])return function(t,e,n){const r=t[0],i=Ka[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(t,e,n)}(t,e,n);for(const e of t)if("number"!=typeof e)throw new Error("expected an array of numbers");if(Vs(e,Bs)){if(2!==t.length)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new $s(Bs,t)}if(Vs(e,Ns)){if(3===t.length)return new $s(Ns,[...t,1]);if(4===t.length)return new $s(Ns,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!Xs(e,Gs))throw new Error(`got an array of numbers, but expected ${Ks(e)}`);return new $s(Gs,t)}const Hs="get",Js="var",Qs="concat",ta="geometry-type",ea="line-metric",na="any",ra="all",ia="!",oa="resolution",sa="zoom",aa="time",la="==",ca="!=",ha=">",ua=">=",da="<",fa="<=",pa="*",ga="/",ma="+",ya="-",va="clamp",wa="%",_a="^",ba="abs",xa="floor",Ea="ceil",Sa="round",La="sin",Ca="cos",ka="atan",Pa="sqrt",Ta="match",Ia="between",Oa="interpolate",Ra="coalesce",Ma="case",Aa="in",Fa="number",ja="string",Da="array",Na="color",Ga="id",Ba="band",za="palette",Wa="to-string",Ya="has",Ka={[Hs]:Ja(Ua(1,1/0),Xa),[Js]:Ja(Ua(1,1),(function(t,e,n){const r=t[1];if("string"!=typeof r)throw new Error("expected a string argument for var operation");return n.variables.add(r),[new $s(Ds,r)]})),[Ya]:Ja(Ua(1,1/0),Xa),[Ga]:Ja((function(t,e,n){n.featureId=!0}),$a),[Qs]:Ja(Ua(2,1/0),qa(Ds)),[ta]:Ja((function(t,e,n){n.geometryType=!0}),$a),[ea]:Ja($a),[oa]:Ja(Va,$a),[sa]:Ja(Va,$a),[aa]:Ja(Va,$a),[na]:Ja(Ua(2,1/0),qa(Fs)),[ra]:Ja(Ua(2,1/0),qa(Fs)),[ia]:Ja(Ua(1,1),qa(Fs)),[la]:Ja(Ua(2,2),qa(zs)),[ca]:Ja(Ua(2,2),qa(zs)),[ha]:Ja(Ua(2,2),qa(js)),[ua]:Ja(Ua(2,2),qa(js)),[da]:Ja(Ua(2,2),qa(js)),[fa]:Ja(Ua(2,2),qa(js)),[pa]:Ja(Ua(2,1/0),Za),[Ra]:Ja(Ua(2,1/0),Za),[ga]:Ja(Ua(2,2),qa(js)),[ma]:Ja(Ua(2,1/0),qa(js)),[ya]:Ja(Ua(2,2),qa(js)),[va]:Ja(Ua(3,3),qa(js)),[wa]:Ja(Ua(2,2),qa(js)),[_a]:Ja(Ua(2,2),qa(js)),[ba]:Ja(Ua(1,1),qa(js)),[xa]:Ja(Ua(1,1),qa(js)),[Ea]:Ja(Ua(1,1),qa(js)),[Sa]:Ja(Ua(1,1),qa(js)),[La]:Ja(Ua(1,1),qa(js)),[Ca]:Ja(Ua(1,1),qa(js)),[ka]:Ja(Ua(1,2),qa(js)),[Pa]:Ja(Ua(1,1),qa(js)),[Ta]:Ja(Ua(4,1/0),Ha,(function(t,e,n){const r=t.length-1,i=Ds|js|Fs,o=qs(t[1],i,n),s=qs(t[t.length-1],e,n),a=new Array(r-2);for(let e=0;e<r-2;e+=2){try{const r=qs(t[e+2],o.type,n);a[e]=r}catch(t){throw new Error(`failed to parse argument ${e+1} of match expression: ${t.message}`)}try{const r=qs(t[e+3],s.type,n);a[e+1]=r}catch(t){throw new Error(`failed to parse argument ${e+2} of match expression: ${t.message}`)}}return[o,...a,s]})),[Ia]:Ja(Ua(3,3),qa(js)),[Oa]:Ja(Ua(6,1/0),Ha,(function(t,e,n){const r=t[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const t=r[1];if("number"!=typeof t||t<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(t)} instead`);i=t;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const o=new $s(js,i);let s;try{s=qs(t[2],js,n)}catch(t){throw new Error(`failed to parse argument 1 in interpolate expression: ${t.message}`)}const a=new Array(t.length-3);for(let r=0;r<a.length;r+=2){try{const e=qs(t[r+3],js,n);a[r]=e}catch(t){throw new Error(`failed to parse argument ${r+2} for interpolate expression: ${t.message}`)}try{const i=qs(t[r+4],e,n);a[r+1]=i}catch(t){throw new Error(`failed to parse argument ${r+3} for interpolate expression: ${t.message}`)}}return[o,s,...a]})),[Ma]:Ja(Ua(3,1/0),(function(t,e,n){const r=t[0],i=t.length-1;if(i%2==0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}),(function(t,e,n){const r=qs(t[t.length-1],e,n),i=new Array(t.length-1);for(let e=0;e<i.length-1;e+=2){try{const r=qs(t[e+1],Fs,n);i[e]=r}catch(t){throw new Error(`failed to parse argument ${e} of case expression: ${t.message}`)}try{const o=qs(t[e+2],r.type,n);i[e+1]=o}catch(t){throw new Error(`failed to parse argument ${e+1} of case expression: ${t.message}`)}}return i[i.length-1]=r,i})),[Aa]:Ja(Ua(2,2),(function(t,e,n){let r,i=t[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');if("string"==typeof i[0]){if("literal"!==i[0])throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],r=Ds}else r=js;const o=new Array(i.length);for(let t=0;t<o.length;t++)try{const e=qs(i[t],r,n);o[t]=e}catch(e){throw new Error(`failed to parse haystack item ${t} for "in" expression: ${e.message}`)}return[qs(t[1],r,n),...o]})),[Fa]:Ja(Ua(1,1/0),qa(zs)),[ja]:Ja(Ua(1,1/0),qa(zs)),[Da]:Ja(Ua(1,1/0),qa(js)),[Na]:Ja(Ua(1,4),qa(js)),[Ba]:Ja(Ua(1,3),qa(js)),[za]:Ja(Ua(2,2),(function(t,e,n){let r;try{r=qs(t[1],js,n)}catch(t){throw new Error(`failed to parse first argument in palette expression: ${t.message}`)}const i=t[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const o=new Array(i.length);for(let t=0;t<o.length;t++){let e;try{e=qs(i[t],Ns,n)}catch(e){throw new Error(`failed to parse color at index ${t} in palette expression: ${e.message}`)}if(!(e instanceof $s))throw new Error(`the palette color at index ${t} must be a literal value`);o[t]=e}return[r,...o]})),[Wa]:Ja(Ua(1,1),qa(Fs|js|Ds|Ns))};function Xa(t,e,n){const r=t.length-1,i=new Array(r);for(let e=0;e<r;++e){const r=t[e+1];switch(typeof r){case"number":i[e]=new $s(js,r);break;case"string":i[e]=new $s(Ds,r);break;default:throw new Error(`expected a string key or numeric array index for a get operation, got ${r}`)}0===e&&n.properties.add(String(r))}return i}function Va(t,e,n){n.mapState=!0}function $a(t,e,n){const r=t[0];if(1!==t.length)throw new Error(`expected no arguments for ${r} operation`);return[]}function Ua(t,e){return function(n,r,i){const o=n[0],s=n.length-1;if(t===e){if(s!==t)throw new Error(`expected ${t} argument${1===t?"":"s"} for ${o}, got ${s}`)}else if(s<t||s>e)throw new Error(`expected ${e===1/0?`${t} or more`:`${t} to ${e}`} arguments for ${o}, got ${s}`)}}function Za(t,e,n){const r=t.length-1,i=new Array(r);for(let o=0;o<r;++o){const r=qs(t[o+1],e,n);i[o]=r}return i}function qa(t){return function(e,n,r){const i=e.length-1,o=new Array(i);for(let n=0;n<i;++n){const i=qs(e[n+1],t,r);o[n]=i}return o}}function Ha(t,e,n){const r=t[0],i=t.length-1;if(i%2==1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function Ja(...t){return function(e,n,r){const i=e[0];let o;for(let i=0;i<t.length;i++){const s=t[i](e,n,r);if(i==t.length-1){if(!s)throw new Error("expected last argument validator to return the parsed args");o=s}}return new Us(n,i,...o)}}function Qa(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Qa(t.getGeometries()[0]);default:return""}}function tl(t,e,n){return el(qs(t,e,n),n)}function el(t,e){if(t instanceof $s){if(t.type===Ns&&"string"==typeof t.value){const e=Ts(t.value);return function(){return e}}return function(){return t.value}}const n=t.operator;switch(n){case Fa:case ja:case Ra:return function(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let n=0;n<r;++n)i[n]=el(t.args[n],e);switch(n){case Ra:return t=>{for(let e=0;e<r;++e){const n=i[e](t);if(null!=n)return n}throw new Error("Expected one of the values to be non-null")};case Fa:case ja:return t=>{for(let e=0;e<r;++e){const r=i[e](t);if(typeof r===n)return r}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}(t,e);case Hs:case Js:case Ya:return function(t){const e=t.args[0].value;switch(t.operator){case Hs:return n=>{const r=t.args;let i=n.properties[e];for(let t=1,e=r.length;t<e;++t)i=i[r[t].value];return i};case Js:return t=>t.variables[e];case Ya:return n=>{const r=t.args;if(!(e in n.properties))return!1;let i=n.properties[e];for(let t=1,e=r.length;t<e;++t){const e=r[t].value;if(!i||!Object.hasOwn(i,e))return!1;i=i[e]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}(t);case"id":return t=>t.featureId;case ta:return t=>t.geometryType;case Qs:{const n=t.args.map((t=>el(t,e)));return t=>"".concat(...n.map((e=>e(t).toString())))}case oa:return t=>t.resolution;case na:case ra:case Ia:case Aa:case"!":return function(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let n=0;n<r;++n)i[n]=el(t.args[n],e);switch(n){case na:return t=>{for(let e=0;e<r;++e)if(i[e](t))return!0;return!1};case ra:return t=>{for(let e=0;e<r;++e)if(!i[e](t))return!1;return!0};case Ia:return t=>{const e=i[0](t),n=i[1](t),r=i[2](t);return e>=n&&e<=r};case Aa:return t=>{const e=i[0](t);for(let n=1;n<r;++n)if(e===i[n](t))return!0;return!1};case"!":return t=>!i[0](t);default:throw new Error(`Unsupported logical operator ${n}`)}}(t,e);case la:case ca:case"<":case fa:case">":case ua:return function(t,e){const n=t.operator,r=el(t.args[0],e),i=el(t.args[1],e);switch(n){case la:return t=>r(t)===i(t);case ca:return t=>r(t)!==i(t);case"<":return t=>r(t)<i(t);case fa:return t=>r(t)<=i(t);case">":return t=>r(t)>i(t);case ua:return t=>r(t)>=i(t);default:throw new Error(`Unsupported comparison operator ${n}`)}}(t,e);case"*":case"/":case"+":case"-":case va:case"%":case"^":case ba:case xa:case Ea:case Sa:case La:case Ca:case ka:case Pa:return function(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let n=0;n<r;++n)i[n]=el(t.args[n],e);switch(n){case"*":return t=>{let e=1;for(let n=0;n<r;++n)e*=i[n](t);return e};case"/":return t=>i[0](t)/i[1](t);case"+":return t=>{let e=0;for(let n=0;n<r;++n)e+=i[n](t);return e};case"-":return t=>i[0](t)-i[1](t);case va:return t=>{const e=i[0](t),n=i[1](t);if(e<n)return n;const r=i[2](t);return e>r?r:e};case"%":return t=>i[0](t)%i[1](t);case"^":return t=>Math.pow(i[0](t),i[1](t));case ba:return t=>Math.abs(i[0](t));case xa:return t=>Math.floor(i[0](t));case Ea:return t=>Math.ceil(i[0](t));case Sa:return t=>Math.round(i[0](t));case La:return t=>Math.sin(i[0](t));case Ca:return t=>Math.cos(i[0](t));case ka:return 2===r?t=>Math.atan2(i[0](t),i[1](t)):t=>Math.atan(i[0](t));case Pa:return t=>Math.sqrt(i[0](t));default:throw new Error(`Unsupported numeric operator ${n}`)}}(t,e);case Ma:return function(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=el(t.args[i],e);return t=>{for(let e=0;e<n-1;e+=2)if(r[e](t))return r[e+1](t);return r[n-1](t)}}(t,e);case Ta:return function(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=el(t.args[i],e);return t=>{const e=r[0](t);for(let i=1;i<n-1;i+=2)if(e===r[i](t))return r[i+1](t);return r[n-1](t)}}(t,e);case Oa:return function(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=el(t.args[i],e);return t=>{const e=r[0](t),i=r[1](t);let o,s;for(let a=2;a<n;a+=2){const n=r[a](t);let l=r[a+1](t);const c=Array.isArray(l);if(c&&(l=Es(l)),n>=i)return 2===a?l:c?rl(e,i,o,s,n,l):nl(e,i,o,s,n,l);o=n,s=l}return s}}(t,e);case Wa:return function(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let n=0;n<r;++n)i[n]=el(t.args[n],e);if(n===Wa)return e=>{const n=i[0](e);return t.args[0].type===Ns?Os(n):n.toString()};throw new Error(`Unsupported convert operator ${n}`)}(t,e);default:throw new Error(`Unsupported operator ${n}`)}}function nl(t,e,n,r,i,o){const s=i-n;if(0===s)return r;const a=e-n;return r+(1===t?a/s:(Math.pow(t,a)-1)/(Math.pow(t,s)-1))*(o-r)}function rl(t,e,n,r,i,o){if(0==i-n)return r;const s=Ps(r),a=Ps(o);let l=a[2]-s[2];return l>180?l-=360:l<-180&&(l+=360),function(t){const e=(t[0]+16)/116,n=t[1],r=t[2]*Math.PI/180,i=Ls(e),o=Ls(e+n/500*Math.cos(r)),s=Ls(e-n/200*Math.sin(r)),a=Ss(3.021973625*o-1.617392459*i-.404875592*s),l=Ss(-.943766287*o+1.916279586*i+.027607165*s),c=Ss(.069407491*o-.22898585*i+1.159737864*s);return[me(a+.5|0,0,255),me(l+.5|0,0,255),me(c+.5|0,0,255),t[3]]}([nl(t,e,n,s[0],i,a[0]),nl(t,e,n,s[1],i,a[1]),s[2]+nl(t,e,n,0,i,l),nl(t,e,n,r[3],i,o[3])])}function il(t,e,n){return e+":"+t+":"+(n?Is(n):"null")}const ol=new class{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];3&t++||n.hasListener()||(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,n){const r=il(t,e,n);return r in this.cache_?this.cache_[r]:null}getPattern(t,e,n){const r=il(t,e,n);return r in this.patternCache_?this.patternCache_[r]:null}set(t,e,n,r,i){const o=il(t,e,n),s=o in this.cache_;this.cache_[o]=r,i&&(0===r.getImageState()&&r.load(),1===r.getImageState()?r.ready().then((()=>{this.patternCache_[o]=Gi().createPattern(r.getImage(1),"repeat")})):this.patternCache_[o]=Gi().createPattern(r.getImage(1),"repeat")),s||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};let sl=null;class al extends Rt{constructor(t,e,n,r,i){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=i,this.imageState_=void 0===r?0:r,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&2===this.imageState_){sl||(sl=Di(1,1,void 0,{willReadFrequently:!0})),sl.drawImage(this.image_,0,0);try{sl.getImageData(0,0,1,1),this.tainted_=!1}catch{sl=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(ut)}handleImageError_(){this.imageState_=3,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=2,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=Di(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(0===this.imageState_){this.image_||this.initializeImage_(),this.imageState_=1;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&(t=this.image_,e=this.src_,e&&(t.src=e),t.src&&te?new Promise(((e,n)=>t.decode().then((()=>e(t))).catch((r=>t.complete&&t.width?e(t):n(r))))):function(t){return new Promise(((e,n)=>{function r(){o(),e(t)}function i(){o(),n(new Error("Image load error"))}function o(){t.removeEventListener("load",r),t.removeEventListener("error",i)}t.addEventListener("load",r),t.addEventListener("error",i)}))}(t)).then((t=>{this.image_=t,this.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}var t,e}replaceColor_(t){if(!this.color_||this.canvas_[t]||2!==this.imageState_)return;const e=this.image_,n=Di(Math.ceil(e.width*t),Math.ceil(e.height*t)),r=n.canvas;var i;n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle="string"==typeof(i=this.color_)?i:Os(i),n.fillRect(0,0,r.width/t,r.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=r}ready(){return this.ready_||(this.ready_=new Promise((t=>{if(2===this.imageState_||3===this.imageState_)t();else{const e=()=>{2!==this.imageState_&&3!==this.imageState_||(this.removeEventListener(ut,e),t())};this.addEventListener(ut,e)}}))),this.ready_}}function ll(t,e,n,r,i,o){let s=void 0===e?void 0:ol.get(e,n,i);return s||(s=new al(t,t&&"src"in t?t.src||void 0:e,n,r,i),ol.set(e,n,i,s,o)),o&&s&&!ol.getPattern(e,n,i)&&ol.set(e,n,i,s,o),s}const cl=al;function hl(t){return t?Array.isArray(t)?Os(t):"object"==typeof t&&"src"in t?function(t){if(!t.offset||!t.size)return ol.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,n=ol.getPattern(e,void 0,t.color);if(n)return n;const r=ol.get(t.src,"anonymous",null);if(2!==r.getImageState())return null;const i=Di(t.size[0],t.size[1]);return i.drawImage(r.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),ll(i.canvas,e,void 0,2,t.color,!0),ol.getPattern(e,void 0,t.color)}(t):t:null}const ul="10px sans-serif",dl="#000",fl="round",pl=[],gl="round",ml="#000",yl="center",vl="middle",wl=[0,0,0,0],_l=new Wt;let bl,xl=null;const El={},Sl=function(){const t="32px ",e=["monospace","serif"],n=e.length,r="wmytzilWMYTZIL@#/&?$%10";let i,o;function s(i,s,a){let l=!0;for(let c=0;c<n;++c){const n=e[c];if(o=kl(i+" "+s+" "+t+n,r),a!=n){const e=kl(i+" "+s+" "+t+a+","+n,r);l=l&&e!=o}}return!!l}function a(){let t=!0;const e=_l.getKeys();for(let n=0,r=e.length;n<r;++n){const r=e[n];if(_l.get(r)<100){const[e,n,i]=r.split("\n");s(e,n,i)?(Tt(El),xl=null,bl=void 0,_l.set(r,100)):(_l.set(r,_l.get(r)+1,!0),t=!1)}}t&&(clearInterval(i),i=void 0)}return function(t){const e=ji(t);if(!e)return;const n=e.families;for(let t=0,r=n.length;t<r;++t){const r=n[t],o=e.style+"\n"+e.weight+"\n"+r;void 0===_l.get(o)&&(_l.set(o,100,!0),s(e.style,e.weight,r)||(_l.set(o,0,!0),void 0===i&&(i=setInterval(a,32))))}}}(),Ll=function(){let t;return function(e){let n=El[e];if(null==n){if(Qt){const t=ji(e),r=Cl(e,"g");n=(isNaN(Number(t.lineHeight))?1.2:Number(t.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);El[e]=n}return n}}();function Cl(t,e){return xl||(xl=Di(1,1)),t!=bl&&(xl.font=t,bl=xl.font),xl.measureText(e)}function kl(t,e){return Cl(t,e).width}function Pl(t,e,n){if(e in n)return n[e];const r=e.split("\n").reduce(((e,n)=>Math.max(e,kl(t,n))),0);return n[e]=r,r}class Tl{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Ms(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Tl({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Nt()}getImage(t){return Nt()}getHitDetectionImage(){return Nt()}getPixelRatio(t){return 1}getImageState(){return Nt()}getImageSize(){return Nt()}getOrigin(){return Nt()}getSize(){return Nt()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ms(t)}listenImageChange(t){Nt()}load(){Nt()}unlistenImageChange(t){Nt()}ready(){return Promise.resolve()}}const Il=Tl;class Ol extends Il{constructor(t){super({opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?1:2,1===this.imageState_&&this.ready().then((()=>this.imageState_=2)),this.render()}clone(){const t=this.getScale(),e=new Ol({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){const e=this.fill_?.getKey(),n=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let r=ol.get(n,null,null)?.getImage(1);if(!r){const e=this.renderOptions_,i=Math.ceil(e.size*t),o=Di(i,i);this.draw_(e,o,t),r=o.canvas,ol.set(n,null,null,new cl(r,void 0,null,2,null))}return r}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;let r=this.radius,i=void 0===this.radius2_?r:this.radius2_;if(r<i){const t=r;r=i,i=t}const o=void 0===this.radius2_?this.points_:2*this.points_,s=2*Math.PI/o,a=i*Math.sin(s),l=r-Math.sqrt(i*i-a*a),c=Math.sqrt(a*a+l*l),h=c/a;if("miter"===t&&h<=n)return h*e;const u=e/2/h,d=e/2*(l/c),f=Math.sqrt((r+u)*(r+u)+d*d)-r;if(void 0===this.radius2_||"bevel"===t)return 2*f;const p=r*Math.sin(s),g=i-Math.sqrt(r*r-p*p),m=Math.sqrt(p*p+g*g)/p;if(m<=n){const t=m*e/2-i-r;return 2*Math.max(f,t)}return 2*f}createRenderOptions(){let t,e=fl,n=gl,r=0,i=null,o=0,s=0;this.stroke_&&(t=hl(this.stroke_.getColor()??ml),s=this.stroke_.getWidth()??1,i=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??gl,e=this.stroke_.getLineCap()??fl,r=this.stroke_.getMiterLimit()??10);const a=this.calculateLineJoinSize_(n,s,r),l=Math.max(this.radius,this.radius2_||0);return{strokeStyle:t,strokeWidth:s,size:Math.ceil(2*l+a),lineCap:e,lineDash:i,lineDashOffset:o,lineJoin:n,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let t=this.fill_.getColor();null===t&&(t=dl),e.fillStyle=hl(t),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let n=this.fill_.getColor(),r=0;"string"==typeof n&&(n=Is(n)),null===n?r=1:Array.isArray(n)&&(r=4===n.length?n[3]:1),0===r&&(e=Di(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const n=this.radius;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const r=void 0===this.radius2_?n:this.radius2_;void 0!==this.radius2_&&(e*=2);const i=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let s=0;s<e;s++){const e=i+s*o,a=s%2==0?n:r;t.lineTo(a*Math.cos(e),a*Math.sin(e))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=dl,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}const Rl=Ol;class Ml extends Rl{constructor(t){super({points:1/0,fill:(t=t||{radius:5}).fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Ml({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}const Al=Ml;class Fl{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,void 0!==t.color&&this.setColor(t.color)}clone(){const t=this.getColor();return new Fl({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(null!==t&&"object"==typeof t&&"src"in t){const e=ll(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then((()=>{this.patternImage_=null})),0===e.getImageState()&&e.load(),1===e.getImageState()&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?Bt(t):"object"==typeof t&&"src"in t?t.src+":"+t.offset:Is(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}const jl=Fl;function Dl(t,e,n,r){return void 0!==n&&void 0!==r?[n/t,r/e]:void 0!==n?n/t:void 0!==r?r/e:1}class Nl extends Il{constructor(t){const e=void 0!==(t=t||{}).opacity?t.opacity:1,n=void 0!==t.rotation?t.rotation:0,r=void 0!==t.scale?t.scale:1,i=void 0!==t.rotateWithView&&t.rotateWithView;super({opacity:e,rotation:n,scale:r,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:i,declutterMode:t.declutterMode}),this.anchor_=void 0!==t.anchor?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",this.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;const o=void 0!==t.img?t.img:null;let s,a=t.src;if(ue(!(void 0!==a&&o),"`image` and `src` cannot be provided at the same time"),void 0!==a&&0!==a.length||!o||(a=o.src||Bt(o)),ue(void 0!==a&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),ue(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?s=0:void 0!==o&&(s="complete"in o?o.complete?o.src?2:0:1:2),this.color_=void 0!==t.color?Is(t.color):null,this.iconImage_=ll(o,a,this.crossOrigin_,s,this.color_),this.offset_=void 0!==t.offset?t.offset:[0,0],this.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==t.size?t.size:null,this.initialOptions_,void 0!==t.width||void 0!==t.height){let e,n;if(t.size)[e,n]=t.size;else{const r=this.getImage(1);if(r.width&&r.height)e=r.width,n=r.height;else if(r instanceof HTMLImageElement){this.initialOptions_=t;const e=()=>{if(this.unlistenImageChange(e),!this.initialOptions_)return;const n=this.iconImage_.getSize();this.setScale(Dl(n[0],n[1],t.width,t.height))};return void this.listenImageChange(e)}}void 0!==e&&this.setScale(Dl(e,n,t.width,t.height))}}clone(){let t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Nl({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if("top-left"!=this.offsetOrigin_){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=n[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[0]*t[0]:void 0}getHeight(){const t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[1]*t[1]:void 0}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(ut,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(ut,t)}ready(){return this.iconImage_.ready()}}const Gl=Nl;class Bl{constructor(t){t=t||{},this.color_=void 0!==t.color?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=void 0!==t.lineDash?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Bl({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const zl=Bl;class Wl{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Xl,void 0!==t.geometry&&this.setGeometry(t.geometry),this.fill_=void 0!==t.fill?t.fill:null,this.image_=void 0!==t.image?t.image:null,this.renderer_=void 0!==t.renderer?t.renderer:null,this.hitDetectionRenderer_=void 0!==t.hitDetectionRenderer?t.hitDetectionRenderer:null,this.stroke_=void 0!==t.stroke?t.stroke:null,this.text_=void 0!==t.text?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&"object"==typeof t&&(t=t.clone()),new Wl({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Xl,this.geometry_=t}setZIndex(t){this.zIndex_=t}}let Yl=null;function Kl(t,e){if(!Yl){const t=new jl({color:"rgba(255,255,255,0.4)"}),e=new zl({color:"#3399CC",width:1.25});Yl=[new Wl({image:new Al({fill:t,stroke:e,radius:5}),fill:t,stroke:e})]}return Yl}function Xl(t){return t.getGeometry()}const Vl=Wl;class $l{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=Ms(void 0!==t.scale?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=void 0!==t.fill?t.fill:new jl({color:"#333"}),this.maxAngle_=void 0!==t.maxAngle?t.maxAngle:Math.PI/4,this.placement_=void 0!==t.placement?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=void 0!==t.stroke?t.stroke:null,this.offsetX_=void 0!==t.offsetX?t.offsetX:0,this.offsetY_=void 0!==t.offsetY?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=void 0===t.padding?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new $l({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ms(void 0!==t?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Ul=$l;function Zl(t){return!0}function ql(t){const e=Zs(),n=function(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i){const n=t[i],o="filter"in n?tl(n.filter,Fs,e):Zl;let s;if(Array.isArray(n.style)){const t=n.style.length;s=new Array(t);for(let r=0;r<t;++r)s[r]=Jl(n.style[r],e)}else s=[Jl(n.style,e)];r[i]={filter:o,styles:s}}return function(e){const i=[];let o=!1;for(let s=0;s<n;++s)if((0,r[s].filter)(e)&&(!t[s].else||!o)){o=!0;for(const t of r[s].styles){const n=t(e);n&&i.push(n)}}return i}}(t,e),r={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""};return function(t,i){if(r.properties=t.getPropertiesInternal(),r.resolution=i,e.featureId){const e=t.getId();r.featureId=void 0!==e?e:null}return e.geometryType&&(r.geometryType=Qa(t.getGeometry())),n(r)}}function Hl(t){const e=Zs(),n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Jl(t[i],e);const i={variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""},o=new Array(n);return function(t,s){if(i.properties=t.getPropertiesInternal(),i.resolution=s,e.featureId){const e=t.getId();i.featureId=void 0!==e?e:null}let a=0;for(let t=0;t<n;++t){const e=r[t](i);e&&(o[a]=e,a+=1)}return o.length=a,o}}function Jl(t,e){const n=Ql(t,"",e),r=tc(t,"",e),i=function(t,e){const n="text-",r=nc(t,n+"value",e);if(!r)return null;const i=Ql(t,n,e),o=Ql(t,n+"background-",e),s=tc(t,n,e),a=tc(t,n+"background-",e),l=nc(t,n+"font",e),c=ec(t,n+"max-angle",e),h=ec(t,n+"offset-x",e),u=ec(t,n+"offset-y",e),d=rc(t,n+"overflow",e),f=nc(t,n+"placement",e),p=ec(t,n+"repeat",e),g=lc(t,n+"scale",e),m=rc(t,n+"rotate-with-view",e),y=ec(t,n+"rotation",e),v=nc(t,n+"align",e),w=nc(t,n+"justify",e),_=nc(t,n+"baseline",e),b=rc(t,n+"keep-upright",e),x=oc(t,n+"padding",e),E=dc(t,n+"declutter-mode"),S=new Ul({declutterMode:E});return function(t){if(S.setText(r(t)),i&&S.setFill(i(t)),o&&S.setBackgroundFill(o(t)),s&&S.setStroke(s(t)),a&&S.setBackgroundStroke(a(t)),l&&S.setFont(l(t)),c&&S.setMaxAngle(c(t)),h&&S.setOffsetX(h(t)),u&&S.setOffsetY(u(t)),d&&S.setOverflow(d(t)),f){const e=f(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");S.setPlacement(e)}if(p&&S.setRepeat(p(t)),g&&S.setScale(g(t)),m&&S.setRotateWithView(m(t)),y&&S.setRotation(y(t)),v){const e=v(t);if("left"!==e&&"center"!==e&&"right"!==e&&"end"!==e&&"start"!==e)throw new Error("Expected left, right, center, start, or end for text-align");S.setTextAlign(e)}if(w){const e=w(t);if("left"!==e&&"right"!==e&&"center"!==e)throw new Error("Expected left, right, or center for text-justify");S.setJustify(e)}if(_){const e=_(t);if("bottom"!==e&&"top"!==e&&"middle"!==e&&"alphabetic"!==e&&"hanging"!==e)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");S.setTextBaseline(e)}return x&&S.setPadding(x(t)),b&&S.setKeepUpright(b(t)),S}}(t,e),o=function(t,e){return"icon-src"in t?function(t,e){const n="icon-",r=n+"src",i=pc(t[r],r),o=sc(t,n+"anchor",e),s=lc(t,n+"scale",e),a=ec(t,n+"opacity",e),l=sc(t,n+"displacement",e),c=ec(t,n+"rotation",e),h=rc(t,n+"rotate-with-view",e),u=hc(t,n+"anchor-origin"),d=uc(t,n+"anchor-x-units"),f=uc(t,n+"anchor-y-units"),p=function(t,e){const n=t[e];if(void 0!==n)return mc(n,e)}(t,n+"color"),g=function(t,e){const n=t[e];if(void 0!==n){if("string"!=typeof n)throw new Error(`Expected a string for ${e}`);return n}}(t,n+"cross-origin"),m=function(t,e){const n=t[e];if(void 0!==n)return fc(n,e)}(t,n+"offset"),y=hc(t,n+"offset-origin"),v=cc(t,n+"width"),w=cc(t,n+"height"),_=function(t,e){const n=t[e];if(void 0!==n){if("number"==typeof n)return Ms(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])throw new Error(`Expected a number or size array for ${e}`);return n}}(t,n+"size"),b=dc(t,n+"declutter-mode"),x=new Gl({src:i,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:p,crossOrigin:g,offset:m,offsetOrigin:y,height:w,width:v,size:_,declutterMode:b});return function(t){return a&&x.setOpacity(a(t)),l&&x.setDisplacement(l(t)),c&&x.setRotation(c(t)),h&&x.setRotateWithView(h(t)),s&&x.setScale(s(t)),o&&x.setAnchor(o(t)),x}}(t,e):"shape-points"in t?function(t,e){const n="shape-",r=n+"points",i=n+"radius",o=gc(t[r],r),s=gc(t[i],i),a=Ql(t,n,e),l=tc(t,n,e),c=lc(t,n+"scale",e),h=sc(t,n+"displacement",e),u=ec(t,n+"rotation",e),d=rc(t,n+"rotate-with-view",e),f=cc(t,n+"radius2"),p=cc(t,n+"angle"),g=dc(t,n+"declutter-mode"),m=new Rl({points:o,radius:s,radius2:f,angle:p,declutterMode:g});return function(t){return a&&m.setFill(a(t)),l&&m.setStroke(l(t)),h&&m.setDisplacement(h(t)),u&&m.setRotation(u(t)),d&&m.setRotateWithView(d(t)),c&&m.setScale(c(t)),m}}(t,e):"circle-radius"in t?function(t,e){const n="circle-",r=Ql(t,n,e),i=tc(t,n,e),o=ec(t,n+"radius",e),s=lc(t,n+"scale",e),a=sc(t,n+"displacement",e),l=ec(t,n+"rotation",e),c=rc(t,n+"rotate-with-view",e),h=dc(t,n+"declutter-mode"),u=new Al({radius:5,declutterMode:h});return function(t){return o&&u.setRadius(o(t)),r&&u.setFill(r(t)),i&&u.setStroke(i(t)),a&&u.setDisplacement(a(t)),l&&u.setRotation(l(t)),c&&u.setRotateWithView(c(t)),s&&u.setScale(s(t)),u}}(t,e):null}(t,e),s=ec(t,"z-index",e);if(!(n||r||i||o||It(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new Vl;return function(t){let e=!0;if(n){const r=n(t);r&&(e=!1),a.setFill(r)}if(r){const n=r(t);n&&(e=!1),a.setStroke(n)}if(i){const n=i(t);n&&(e=!1),a.setText(n)}if(o){const n=o(t);n&&(e=!1),a.setImage(n)}return s&&a.setZIndex(s(t)),e?null:a}}function Ql(t,e,n){let r;if(e+"fill-pattern-src"in t)r=function(t,e,n){const r=nc(t,e+"pattern-src",n),i=ac(t,e+"pattern-offset",n),o=ac(t,e+"pattern-size",n),s=ic(t,e+"color",n);return function(t){return{src:r(t),offset:i&&i(t),size:o&&o(t),color:s&&s(t)}}}(t,e+"fill-",n);else{if("none"===t[e+"fill-color"])return t=>null;r=ic(t,e+"fill-color",n)}if(!r)return null;const i=new jl;return function(t){const e=r(t);return e===ds?null:(i.setColor(e),i)}}function tc(t,e,n){const r=ec(t,e+"stroke-width",n),i=ic(t,e+"stroke-color",n);if(!r&&!i)return null;const o=nc(t,e+"stroke-line-cap",n),s=nc(t,e+"stroke-line-join",n),a=oc(t,e+"stroke-line-dash",n),l=ec(t,e+"stroke-line-dash-offset",n),c=ec(t,e+"stroke-miter-limit",n),h=new zl;return function(t){if(i){const e=i(t);if(e===ds)return null;h.setColor(e)}if(r&&h.setWidth(r(t)),o){const e=o(t);if("butt"!==e&&"round"!==e&&"square"!==e)throw new Error("Expected butt, round, or square line cap");h.setLineCap(e)}if(s){const e=s(t);if("bevel"!==e&&"round"!==e&&"miter"!==e)throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(e)}return a&&h.setLineDash(a(t)),l&&h.setLineDashOffset(l(t)),c&&h.setMiterLimit(c(t)),h}}function ec(t,e,n){if(!(e in t))return;const r=tl(t[e],js,n);return function(t){return gc(r(t),e)}}function nc(t,e,n){if(!(e in t))return null;const r=tl(t[e],Ds,n);return function(t){return pc(r(t),e)}}function rc(t,e,n){if(!(e in t))return null;const r=tl(t[e],Fs,n);return function(t){const n=r(t);if("boolean"!=typeof n)throw new Error(`Expected a boolean for ${e}`);return n}}function ic(t,e,n){if(!(e in t))return null;const r=tl(t[e],Ns,n);return function(t){return mc(r(t),e)}}function oc(t,e,n){if(!(e in t))return null;const r=tl(t[e],Gs,n);return function(t){return fc(r(t),e)}}function sc(t,e,n){if(!(e in t))return null;const r=tl(t[e],Gs,n);return function(t){const n=fc(r(t),e);if(2!==n.length)throw new Error(`Expected two numbers for ${e}`);return n}}function ac(t,e,n){if(!(e in t))return null;const r=tl(t[e],Gs,n);return function(t){return yc(r(t),e)}}function lc(t,e,n){if(!(e in t))return null;const r=tl(t[e],Gs|js,n);return function(t){return n=r(t),i=e,"number"==typeof n?n:yc(n,i);var n,i}}function cc(t,e){const n=t[e];if(void 0!==n){if("number"!=typeof n)throw new Error(`Expected a number for ${e}`);return n}}function hc(t,e){const n=t[e];if(void 0!==n){if("bottom-left"!==n&&"bottom-right"!==n&&"top-left"!==n&&"top-right"!==n)throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function uc(t,e){const n=t[e];if(void 0!==n){if("pixels"!==n&&"fraction"!==n)throw new Error(`Expected pixels or fraction for ${e}`);return n}}function dc(t,e){const n=t[e];if(void 0!==n){if("string"!=typeof n)throw new Error(`Expected a string for ${e}`);if("declutter"!==n&&"obstacle"!==n&&"none"!==n)throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function fc(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let r=0;r<n;++r)if("number"!=typeof t[r])throw new Error(`Expected an array of numbers for ${e}`);return t}function pc(t,e){if("string"!=typeof t)throw new Error(`Expected a string for ${e}`);return t}function gc(t,e){if("number"!=typeof t)throw new Error(`Expected a number for ${e}`);return t}function mc(t,e){if("string"==typeof t)return t;const n=fc(t,e),r=n.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function yc(t,e){const n=fc(t,e);if(2!==n.length)throw new Error(`Expected an array of two numbers for ${e}`);return n}const vc="renderOrder",wc=class extends Uo{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,this.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(vc)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const n=this.getDeclutter();n in t.declutter==0&&(t.declutter[n]=new Jo(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(vc,t)}setStyle(t){this.style_=void 0===t?Kl:t;const e=function(t){if(void 0===t)return Kl;if(!t)return null;if("function"==typeof t)return t;if(t instanceof Vl)return t;if(!Array.isArray(t))return Hl([t]);if(0===t.length)return[];const e=t.length,n=t[0];if(n instanceof Vl){const n=new Array(e);for(let r=0;r<e;++r){const e=t[r];if(!(e instanceof Vl))throw new Error("Expected a list of style instances");n[r]=e}return n}if("style"in n){const n=new Array(e);for(let r=0;r<e;++r){const e=t[r];if(!("style"in e))throw new Error("Expected a list of rules with a style property");n[r]=e}return ql(n)}return Hl(t)}(t);this.styleFunction_=null===t?void 0:function(t){let e;if("function"==typeof t)e=t;else{let n;Array.isArray(t)?n=t:(ue("function"==typeof t.getZIndex,"Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}},_c=class extends Ot{constructor(t,e,n,r){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=r}};function bc(t,e){ol.expire()}const xc=class extends vt{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){Nt()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;jr(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Dr(r,n)}forEachFeatureAtCoordinate(t,e,n,r,i,o,s,a){let l;const c=e.viewState;function h(t,e,n,r){return i.call(o,e,t?n:null,r)}const u=c.projection,d=un(t.slice(),u),f=[[0,0]];if(u.canWrapX()&&r){const t=rn(u.getExtent());f.push([-t,0],[t,0])}const p=e.layerStatesArray,g=p.length,m=[],y=[];for(let r=0;r<f.length;r++)for(let i=g-1;i>=0;--i){const o=p[i],u=o.layer;if(u.hasRenderer()&&$o(o,c)&&s.call(a,u)){const i=u.getRenderer(),s=u.getSource();if(i&&s){const a=s.getWrapX()?d:t,c=h.bind(null,o.managed);y[0]=a[0]+f[r][0],y[1]=a[1]+f[r][1],l=i.forEachFeatureAtCoordinate(y,e,n,c,m)}if(l)return l}}if(0===m.length)return;const v=1/m.length;return m.forEach(((t,e)=>t.distanceSq+=e*v)),m.sort(((t,e)=>t.distanceSq-e.distanceSq)),m.some((t=>l=t.callback(t.feature,t.layer,t.geometry))),l}hasFeatureAtCoordinate(t,e,n,r,i,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,r,Lt,this,i,o)}getMap(){return this.map_}renderFrame(t){Nt()}scheduleExpireIconCache(t){ol.canExpireCache()&&t.postRenderFunctions.push(bc)}},Ec=class extends xc{constructor(t){super(t),this.fontChangeListenerKey_=Mt(_l,ht,t.redrawText,t),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Oi+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const r=new _c(t,void 0,e);n.dispatchEvent(r)}}disposeInternal(){Ft(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(Xo,t);const e=t.layerStatesArray.sort(((t,e)=>t.zIndex-e.zIndex));e.some((t=>t.layer instanceof wc&&t.layer.getDeclutter()))&&(t.declutter={});const n=t.viewState;this.children_.length=0;const r=[];let i=null;for(let o=0,s=e.length;o<s;++o){const s=e[o];t.layerIndex=o;const a=s.layer,l=a.getSourceState();if(!$o(s,n)||"ready"!=l&&"undefined"!=l){a.unrender();continue}const c=a.render(t,i);c&&(c!==i&&(this.children_.push(c),i=c),r.push(s))}this.declutter(t,r),function(t,e){const n=t.childNodes;for(let r=0;;++r){const i=n[r],o=e[r];if(!i&&!o)break;i!==o&&(i?o?t.insertBefore(o,i):(t.removeChild(i),--r):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let n=e.length-1;n>=0;--n){const r=e[n],i=r.layer;i.getDeclutter()&&i.renderDeclutter(t,r)}e.forEach((e=>e.layer.renderDeferred(t)))}}};function Sc(t){t instanceof Uo?t.setMapInternal(null):t instanceof Wo&&t.getLayers().forEach(Sc)}function Lc(t,e){if(t instanceof Uo)t.setMapInternal(e);else if(t instanceof Wo){const n=t.getLayers().getArray();for(let t=0,r=n.length;t<r;++t)Lc(n[t],e)}}const Cc=class extends Wt{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},r=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Wo({layers:t.layers});let i,o,s;return n[ae]=r,n[ce]=t.target,n[he]=t.view instanceof Ti?t.view:new Ti,void 0!==t.controls&&(Array.isArray(t.controls)?i=new Xt(t.controls.slice()):(ue("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),i=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?o=new Xt(t.interactions.slice()):(ue("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),o=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?s=new Xt(t.overlays.slice()):(ue("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),s=t.overlays):s=new Xt,{controls:i,interactions:o,keyboardEventTarget:e,overlays:s,values:n}}(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Jt,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver((()=>this.updateSize())),this.controls=e.controls||Zi(),this.interactions=e.interactions||function(t){t=t||{};const e=new Xt,n=new qi(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new go),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new to({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new po({onFocusOnly:t.onFocusOnly,kinetic:n})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new ko),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new Po({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new So),e.push(new Lo({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new Co({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new _o({duration:t.zoomDuration})),e}({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new pe(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ae,this.handleLayerGroupChanged_),this.addChangeListener(he,this.handleViewChanged_),this.addChangeListener(le,this.handleSizeChanged_),this.addChangeListener(ce,this.handleTargetChanged_),this.setProperties(e.values);const n=this;!t.view||t.view instanceof Ti||t.view.then((function(t){n.setView(new Ti(t))})),this.controls.addEventListener(lt,(t=>{t.element.setMap(this)})),this.controls.addEventListener(ct,(t=>{t.element.setMap(null)})),this.interactions.addEventListener(lt,(t=>{t.element.setMap(this)})),this.interactions.addEventListener(ct,(t=>{t.element.setMap(null)})),this.overlays_.addEventListener(lt,(t=>{this.addOverlayInternal_(t.element)})),this.overlays_.addEventListener(ct,(t=>{const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)})),this.controls.forEach((t=>{t.setMap(this)})),this.interactions.forEach((t=>{t.setMap(this)})),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Lc(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const r=this.getCoordinateFromPixelInternal(t),i=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,o=void 0!==n.layerFilter?n.layerFilter:Lt,s=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,i,s,e,null,o,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n}getAllLayers(){const t=[];return function e(n){n.forEach((function(n){n instanceof Wo?e(n.getLayers()):t.push(n)}))}(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t),r=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:Lt,i=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,i,o,r,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),n=this.getSize(),r=e.width/n[0],i=e.height/n[1],o="changedTouches"in t?t.changedTouches[0]:t;return[(o.clientX-e.left)/r,(o.clientY-e.top)/i]}getTarget(){return this.get(ce)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return kr(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Fr(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ae)}setLayers(t){const e=this.getLayerGroup();if(t instanceof Xt)return void e.setLayers(t);const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e];if(!n.visible)continue;const r=n.layer.getRenderer();if(r&&!r.ready)return!0;const i=n.layer.getSource();if(i&&i.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Pr(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Fr(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(le)}getView(){return this.get(he)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,r){return function(t,e,n,r,i){if(!t||!(n in t.wantedTiles))return de;if(!t.wantedTiles[n][e.getKey()])return de;const o=t.viewState.center,s=r[0]-o[0],a=r[1]-o[1];return 65536*Math.log(i)+Math.sqrt(s*s+a*a)/i}(this.frameState_,t,e,n,r)}handleBrowserEvent(t,e){e=e||t.type;const n=new $t(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===ne||n===yt||n===pt){const t=this.getOwnerDocument(),n=this.viewport_.getRootNode?this.viewport_.getRootNode():t,r=e.target,i=n instanceof ShadowRoot?n.host===r?n.host.ownerDocument:n:n===t?t.documentElement:n;if(this.overlayContainerStopEvent_.contains(r)||!i.contains(r))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.getMap()===this&&r.getActive()&&this.getTargetElement()&&(!r.handleEvent(t)||t.propagationStopped))break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let n=this.maxTilesLoading_,r=n;if(t){const e=t.viewHints;if(e[0]||e[1]){const e=Date.now()-t.time>8;n=e?0:8,r=e?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,r))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(Vo)&&this.renderer_.dispatchRenderEvent(Vo,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new Vt(se,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new Vt(oe,this,t))));const n=this.postRenderFunctions_;if(t)for(let e=0,r=n.length;e<r;++e)n[e](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)Ft(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(dt,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(yt,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const t=this.targetElement_.getRootNode();t instanceof ShadowRoot&&this.resizeObserver_.unobserve(t.host),this.setSize(void 0)}const t=this.getTarget(),e="string"==typeof t?document.getElementById(t):t;if(this.targetElement_=e,e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Ec(this)),this.mapBrowserEventHandler_=new re(this,this.moveTolerance_);for(const t in Ut)this.mapBrowserEventHandler_.addEventListener(Ut[t],this.handleMapBrowserEvent.bind(this));let t;if(this.viewport_.addEventListener(dt,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(yt,this.boundHandleBrowserEvent_,!!ee&&{passive:!1}),this.keyboardEventTarget_)t=this.keyboardEventTarget_;else{const n=e.getRootNode();t=n instanceof ShadowRoot?n.host:e}this.targetChangeHandlerKeys_=[Mt(t,pt,this.handleBrowserEvent,this),Mt(t,gt,this.handleBrowserEvent,this)];const n=e.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(e)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Ft(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ft(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Mt(t,ht,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Mt(t,ut,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ft),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Go("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Mt(t,ht,this.render,this),Mt(t,ut,this.render,this),Mt(t,"addlayer",this.handleLayerAdd_,this),Mt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){Sc(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),r=this.frameState_;let i=null;if(void 0!==e&&Rs(e)&&n&&n.isDef()){const r=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=n.getState();if(i={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:He(o.center,o.resolution,o.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:o,viewHints:r,wantedTiles:{},mapId:Bt(this),renderTargets:{}},o.nextCenter&&o.nextResolution){const t=isNaN(o.nextRotation)?o.rotation:o.nextRotation;i.nextExtent=He(o.nextCenter,o.nextResolution,t,e)}}this.frameState_=i,this.renderer_.renderFrame(i),i&&(i.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,i.postRenderFunctions),r&&(!this.previousExtent_||!sn(this.previousExtent_)&&!ze(i.extent,this.previousExtent_))&&(this.dispatchEvent(new Vt("movestart",this,r)),this.previousExtent_=Ne(this.previousExtent_)),this.previousExtent_&&!i.viewHints[0]&&!i.viewHints[1]&&!ze(i.extent,this.previousExtent_)&&(this.dispatchEvent(new Vt("moveend",this,i)),Oe(i.extent,this.previousExtent_))),this.dispatchEvent(new Vt(ie,this,i)),this.renderComplete_=(this.hasListener(oe)||this.hasListener(se)||this.hasListener(Vo))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()}),0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Go("removelayer",e)),this.set(ae,t)}setSize(t){this.set(le,t)}setTarget(t){this.set(ce,t)}setView(t){if(!t||t instanceof Ti)return void this.set(he,t);this.set(he,new Ti);const e=this;t.then((function(t){e.setView(new Ti(t))}))}updateSize(){const t=this.getTargetElement();let e;if(t){const n=getComputedStyle(t),r=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),i=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);isNaN(r)||isNaN(i)||(e=[Math.max(0,r),Math.max(0,i)],!Rs(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&vn("No map visible because the map container's width or height are 0."))}const n=this.getSize();!e||n&&St(e,n)||(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}},kc=class extends Rt{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=void 0===n.transition?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(ut)}release(){this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(4!==this.state){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){Nt()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;const r=e-n+1e3/60;return r>=this.transition_?1:dn(r/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}};function Pc(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const Tc=new Error("disposed"),Ic=[256,256],Oc=class extends kc{constructor(t){super(t.tileCoord,0,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=Pc(this.data_);return t?[t.width,t.height]:Ic}getData(){return this.data_}getError(){return this.error_}load(){if(0!==this.state&&3!==this.state)return;this.state=1,this.changed();const t=this;this.loader_().then((function(e){t.data_=e,t.state=2,t.changed()})).catch((function(e){t.error_=e,t.state=3,t.changed()}))}disposeInternal(){this.controller_&&(this.controller_.abort(Tc),this.controller_=null),super.disposeInternal()}},Rc=class extends kc{constructor(t,e,n,r,i,o){super(t,e,o),this.crossOrigin_=r,this.src_=n,this.key=n,this.image_=new Image,null!==r&&(this.image_.crossOrigin=r),this.unlisten_=null,this.tileLoadFunction_=i}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const t=Di(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,n){const r=t;let i=!0,o=!1,s=!1;const a=[At(r,"load",(function(){s=!0,o||e()}))];return r.src&&te?(o=!0,r.decode().then((function(){i&&e()})).catch((function(t){i&&(s?e():n())}))):a.push(At(r,"error",n)),function(){i=!1,a.forEach(Ft)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};class Mc{constructor(t,e,n,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=r}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Ac(t,e,n,r,i){return void 0!==i?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new Mc(t,e,n,r)}const Fc=Mc;let jc;const Dc=[];function Nc(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function Gc(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function Bc(t,e,n,r){const i=Sr(n,e,t);let o=gr(e,r,n);const s=e.getMetersPerUnit();void 0!==s&&(o*=s);const a=t.getMetersPerUnit();void 0!==a&&(o/=a);const l=t.getExtent();if(!l||Me(l,i)){const e=gr(t,o,i)/o;isFinite(e)&&e>0&&(o/=e)}return o}const zc=class{constructor(t,e,n,r,i,o,s){this.sourceProj_=t,this.targetProj_=e;let a={};const l=s?(c=t=>Fr(s,Sr(t,this.targetProj_,this.sourceProj_)),function(t,e,n,r){const i=t.length;n=void 0!==n?n:2,r=r??n,e=void 0!==e?e:new Array(i);for(let o=0;o<i;o+=r){const i=c(t.slice(o,o+n)),s=i.length;for(let n=0,a=r;n<a;++n)e[o+n]=n>=s?t[o+n]:i[n]}return e}):Er(this.targetProj_,this.sourceProj_);var c;this.transformInv_=function(t){const e=t[0]+"/"+t[1];return a[e]||(a[e]=l(t)),a[e]},this.maxSourceExtent_=r,this.errorThresholdSquared_=i*i,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!r&&!!this.sourceProj_.getExtent()&&rn(r)>=rn(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?rn(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?rn(this.targetProj_.getExtent()):null;const h=en(n),u=nn(n),d=Ue(n),f=$e(n),p=this.transformInv_(h),g=this.transformInv_(u),m=this.transformInv_(d),y=this.transformInv_(f),v=10+(o?Math.max(0,Math.ceil(Math.log2(Ve(n)/(o*o*256*256)))):0);if(this.addQuad_(h,u,d,f,p,g,m,y,v),this.wrapsXInSource_){let t=1/0;this.triangles_.forEach((function(e,n,r){t=Math.min(t,e.source[0][0],e.source[1][0],e.source[2][0])})),this.triangles_.forEach((e=>{if(Math.max(e.source[0][0],e.source[1][0],e.source[2][0])-t>this.sourceWorldWidth_/2){const n=[[e.source[0][0],e.source[0][1]],[e.source[1][0],e.source[1][1]],[e.source[2][0],e.source[2][1]]];n[0][0]-t>this.sourceWorldWidth_/2&&(n[0][0]-=this.sourceWorldWidth_),n[1][0]-t>this.sourceWorldWidth_/2&&(n[1][0]-=this.sourceWorldWidth_),n[2][0]-t>this.sourceWorldWidth_/2&&(n[2][0]-=this.sourceWorldWidth_);const r=Math.min(n[0][0],n[1][0],n[2][0]);Math.max(n[0][0],n[1][0],n[2][0])-r<this.sourceWorldWidth_/2&&(e.source=n)}}))}a={}}addTriangle_(t,e,n,r,i,o){this.triangles_.push({source:[r,i,o],target:[t,e,n]})}addQuad_(t,e,n,r,i,o,s,a,l){const c=Te([i,o,s,a]),h=this.sourceWorldWidth_?rn(c)/this.sourceWorldWidth_:null,u=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&h>.5&&h<1;let f=!1;if(l>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(f=rn(Te([t,e,n,r]))/this.targetWorldWidth_>.25||f),!d&&this.sourceProj_.isGlobal()&&h&&(f=h>.25||f)),!f&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!on(c,this.maxSourceExtent_))return;let p=0;if(!(f||isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(s[0])&&isFinite(s[1])&&isFinite(a[0])&&isFinite(a[1])))if(l>0)f=!0;else if(p=(isFinite(i[0])&&isFinite(i[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(s[0])&&isFinite(s[1])?0:2)+(isFinite(a[0])&&isFinite(a[1])?0:1),1!=p&&2!=p&&4!=p&&8!=p)return;if(l>0){if(!f){const e=[(t[0]+n[0])/2,(t[1]+n[1])/2],r=this.transformInv_(e);let o;o=d?(be(i[0],u)+be(s[0],u))/2-be(r[0],u):(i[0]+s[0])/2-r[0];const a=(i[1]+s[1])/2-r[1];f=o*o+a*a>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const c=[(e[0]+n[0])/2,(e[1]+n[1])/2],h=this.transformInv_(c),u=[(r[0]+t[0])/2,(r[1]+t[1])/2],d=this.transformInv_(u);this.addQuad_(t,e,c,u,i,o,h,d,l-1),this.addQuad_(u,c,n,r,d,h,s,a,l-1)}else{const c=[(t[0]+e[0])/2,(t[1]+e[1])/2],h=this.transformInv_(c),u=[(n[0]+r[0])/2,(n[1]+r[1])/2],d=this.transformInv_(u);this.addQuad_(t,c,u,r,i,h,d,a,l-1),this.addQuad_(c,e,n,u,h,o,s,d,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}11&p||this.addTriangle_(t,n,r,i,s,a),14&p||this.addTriangle_(t,n,e,i,s,o),p&&(13&p||this.addTriangle_(e,r,t,o,a,i),7&p||this.addTriangle_(e,r,n,o,a,s))}calculateSourceExtent(){const t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,r){const i=e.source;We(t,i[0]),We(t,i[1]),We(t,i[2])})),t}getTriangles(){return this.triangles_}},Wc=class extends kc{constructor(t,e,n,r,i,o,s,a,l,c,h,u){super(i,0,u),this.renderEdges_=void 0!==h&&h,this.pixelRatio_=s,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=r,this.wrappedTileCoord_=o||i,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const d=r.getTileCoordExtent(this.wrappedTileCoord_),f=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const g=f?tn(d,f):d;if(0===Ve(g))return void(this.state=4);const m=t.getExtent();m&&(p=p?tn(p,m):m);const y=r.getResolution(this.wrappedTileCoord_[0]),v=function(t,e,n,r){const i=Ze(n);let o=Bc(t,e,i,r);return(!isFinite(o)||o<=0)&&Xe(n,(function(n){return o=Bc(t,e,n,r),isFinite(o)&&o>0})),o}(t,n,g,y);if(!isFinite(v)||v<=0)return void(this.state=4);const w=void 0!==c?c:.5;if(this.triangulation_=new zc(t,n,g,p,v*w,y),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=e.getZForResolution(v);let _=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(_[1]=me(_[1],p[1],p[3]),_[3]=me(_[3],p[1],p[3])):_=tn(_,p)),Ve(_)){let n=0,r=0;t.canWrapX()&&(n=rn(m),r=Math.floor((_[0]-m[0])/n)),ln(_.slice(),t,!0).forEach((t=>{const i=e.getTileRangeForExtentAndZ(t,this.sourceZ_);for(let t=i.minX;t<=i.maxX;t++)for(let e=i.minY;e<=i.maxY;e++){const i=l(this.sourceZ_,t,e,s);if(i){const t=r*n;this.sourceTiles_.push({tile:i,offset:t})}}++r})),0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach((e=>{const n=e.tile;if(n&&2==n.getState()){const r=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);r[0]+=e.offset,r[2]+=e.offset;const i=this.clipExtent_?.slice();i&&(i[0]+=e.offset,i[2]+=e.offset),t.push({extent:r,clipExtent:i,image:n.getImage()})}})),this.sourceTiles_.length=0,0===t.length)this.state=3;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),r="number"==typeof n?n:n[0],i="number"==typeof n?n:n[1],o=this.targetTileGrid_.getResolution(e),s=this.sourceTileGrid_.getResolution(this.sourceZ_),a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,n,r,i,o,s,a,l,c,h,u,d,f){const p=Di(Math.round(n*t),Math.round(n*e),Dc);if(u||(p.imageSmoothingEnabled=!1),0===l.length)return p.canvas;function g(t){return Math.round(t*n)/n}p.scale(n,n),p.globalCompositeOperation="lighter";const m=[1/0,1/0,-1/0,-1/0];let y;l.forEach((function(t,e,n){var r,i;r=m,(i=t.extent)[0]<r[0]&&(r[0]=i[0]),i[2]>r[2]&&(r[2]=i[2]),i[1]<r[1]&&(r[1]=i[1]),i[3]>r[3]&&(r[3]=i[3])}));const v=n/r,w=(u?1:1+Math.pow(2,-24))/v;if(!d||1!==l.length||0!==c){if(y=Di(Math.round(rn(m)*v),Math.round(Qe(m)*v),Dc),u||(y.imageSmoothingEnabled=!1),i&&f){const t=(i[0]-m[0])*v,e=-(i[3]-m[3])*v,n=rn(i)*v,r=Qe(i)*v;y.rect(t,e,n,r),y.clip()}l.forEach((function(t,e,n){if(t.image.width>0&&t.image.height>0){if(t.clipExtent){y.save();const e=(t.clipExtent[0]-m[0])*v,n=-(t.clipExtent[3]-m[3])*v,r=rn(t.clipExtent)*v,i=Qe(t.clipExtent)*v;y.rect(u?e:Math.round(e),u?n:Math.round(n),u?r:Math.round(e+r)-Math.round(e),u?i:Math.round(n+i)-Math.round(n)),y.clip()}const e=(t.extent[0]-m[0])*v,n=-(t.extent[3]-m[3])*v,r=rn(t.extent)*v,i=Qe(t.extent)*v;y.drawImage(t.image,c,c,t.image.width-2*c,t.image.height-2*c,u?e:Math.round(e),u?n:Math.round(n),u?r:Math.round(e+r)-Math.round(e),u?i:Math.round(n+i)-Math.round(n)),t.clipExtent&&y.restore()}}))}const _=en(s);return a.getTriangles().forEach((function(t,e,n){const r=t.source,i=t.target;let s=r[0][0],a=r[0][1],c=r[1][0],h=r[1][1],d=r[2][0],f=r[2][1];const v=g((i[0][0]-_[0])/o),b=g(-(i[0][1]-_[1])/o),x=g((i[1][0]-_[0])/o),E=g(-(i[1][1]-_[1])/o),S=g((i[2][0]-_[0])/o),L=g(-(i[2][1]-_[1])/o),C=s,k=a;s=0,a=0,c-=C,h-=k,d-=C,f-=k;const P=function(t){const e=t.length;for(let n=0;n<e;n++){let r=n,i=Math.abs(t[n][n]);for(let o=n+1;o<e;o++){const e=Math.abs(t[o][n]);e>i&&(i=e,r=o)}if(0===i)return null;const o=t[r];t[r]=t[n],t[n]=o;for(let r=n+1;r<e;r++){const i=-t[r][n]/t[n][n];for(let o=n;o<e+1;o++)n==o?t[r][o]=0:t[r][o]+=i*t[n][o]}}const n=new Array(e);for(let r=e-1;r>=0;r--){n[r]=t[r][e]/t[r][r];for(let i=r-1;i>=0;i--)t[i][e]-=t[i][r]*n[r]}return n}([[c,h,0,0,x-v],[d,f,0,0,S-v],[0,0,c,h,E-b],[0,0,d,f,L-b]]);if(!P)return;if(p.save(),p.beginPath(),function(){if(void 0===jc){const t=Di(6,6,Dc);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",Nc(t,4,5,4,0),Nc(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;jc=Gc(e,0)||Gc(e,4)||Gc(e,8),Bi(t),Dc.push(t.canvas)}return jc}()||!u){p.moveTo(x,E);const t=4,e=v-x,n=b-E;for(let r=0;r<t;r++)p.lineTo(x+g((r+1)*e/t),E+g(r*n/(t-1))),r!=t-1&&p.lineTo(x+g((r+1)*e/t),E+g((r+1)*n/(t-1)));p.lineTo(S,L)}else p.moveTo(x,E),p.lineTo(v,b),p.lineTo(S,L);let T;if(p.clip(),p.transform(P[0],P[2],P[1],P[3],v,b),p.translate(m[0]-C,m[3]-k),y)T=y.canvas,p.scale(w,-w);else{const t=l[0],e=t.extent;T=t.image,p.scale(rn(e)/T.width,-Qe(e)/T.height)}p.drawImage(T,0,0),p.restore()})),y&&(Bi(y),Dc.push(y.canvas)),h&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,a.getTriangles().forEach((function(t,e,n){const r=t.target,i=(r[0][0]-_[0])/o,s=-(r[0][1]-_[1])/o,a=(r[1][0]-_[0])/o,l=-(r[1][1]-_[1])/o,c=(r[2][0]-_[0])/o,h=-(r[2][1]-_[1])/o;p.beginPath(),p.moveTo(a,l),p.lineTo(i,s),p.lineTo(c,h),p.closePath(),p.stroke()})),p.restore()),p.canvas}(r,i,this.pixelRatio_,s,this.sourceTileGrid_.getExtent(),o,a,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((({tile:e})=>{const n=e.getState();if(0==n||1==n){t++;const n=Mt(e,ut,(r=>{const i=e.getState();2!=i&&3!=i&&4!=i||(Ft(n),t--,0===t&&(this.unlistenSources_(),this.reproject_()))}));this.sourcesListenerKeys_.push(n)}})),0===t?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function({tile:t},e,n){0==t.getState()&&t.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Ft),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Bi(this.canvas_.getContext("2d")),Dc.push(this.canvas_),this.canvas_=null),super.release()}},Yc=class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof vt&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return ue(void 0!==n,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return ue(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.key_;return t}getValues(){const t=new Array(this.count_);let e,n=0;for(e=this.newest_;e;e=e.older)t[n++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){ue(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}};function Kc(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}const Xc=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Gi(),{get:(t,e)=>{if("function"==typeof Gi()[e])return this.push_(e),this.pushMethodArgs_},set:(t,e,n)=>(this.push_(e,n),!0)})}push_(...t){const e=this.instructions_,n=this.zIndex+this.offset_;e[n]||(e[n]=[]),e[n].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach((e=>{for(let n=0,r=e.length;n<r;++n){const r=e[n];if("function"==typeof r){r(t);continue}const i=e[++n];if("function"==typeof t[r])t[r](...i);else{if("function"==typeof i){t[r]=i(t);continue}t[r]=i}}}))}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}},Vc=class extends Dt{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=5}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return Nt()}getData(t){return null}prepareFrame(t){return Nt()}renderFrame(t,e){return Nt()}forEachFeatureAtCoordinate(t,e,n,r,i){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;2!==e.getState()&&3!==e.getState()||this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return 2!=e&&3!=e&&t.addEventListener(ut,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}},$c=[];let Uc=null;const Zc=class extends Vc{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,n){let r;Uc||(Uc=Di(1,1,void 0,{willReadFrequently:!0})),Uc.clearRect(0,0,1,1);try{Uc.drawImage(t,e,n,1,1,0,0,1,1),r=Uc.getImageData(0,0,1,1).data}catch{return Uc=null,null}return r}getBackground(t){let e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,n){const r=this.getLayer().getClassName();let i,o;if(t&&t.className===r&&(!n||t&&t.style.backgroundColor&&St(Is(t.style.backgroundColor),Is(n)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(o=e.getContext("2d"))}if(o&&function(t,e){const n=Gr(t),r=Gr(e);for(let t=0;t<6;++t)if(0!==Math.round((n[t]-r[t])*Nr[t]))return!1;return!0}(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){i=document.createElement("div"),i.className=r;let t=i.style;t.position="absolute",t.width="100%",t.height="100%",o=Di();const e=o.canvas;i.appendChild(e),t=e.style,t.position="absolute",t.left="0",t.transformOrigin="top left",this.container=i,this.context=o}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const r=en(n),i=nn(n),o=Ue(n),s=$e(n);Fr(e.coordinateToPixelTransform,r),Fr(e.coordinateToPixelTransform,i),Fr(e.coordinateToPixelTransform,o),Fr(e.coordinateToPixelTransform,s);const a=this.inversePixelTransform;Fr(a,r),Fr(a,i),Fr(a,o),Fr(a,s),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()}prepareContainer(t,e){const n=t.extent,r=t.viewState.resolution,i=t.viewState.rotation,o=t.pixelRatio,s=Math.round(rn(n)/r*o),a=Math.round(Qe(n)/r*o);jr(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,i,-s/2,-a/2),Dr(this.inversePixelTransform,this.pixelTransform);const l="matrix("+this.pixelTransform.join(", ")+")";if(this.useContainer(e,l,this.getBackground(t)),!this.containerReused){const t=this.context.canvas;t.width!=s||t.height!=a?(t.width=s,t.height=a):this.context.clearRect(0,0,s,a),l!==t.style.transform&&(t.style.transform=l)}}dispatchRenderEvent_(t,e,n){const r=this.getLayer();if(r.hasListener(t)){const i=new _c(t,this.inversePixelTransform,n,e);r.dispatchEvent(i)}}preRender(t,e){this.frameState=e,e.declutter||this.dispatchRenderEvent_(Yo,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Ko,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new Xc),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Yo,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Ko,this.context,t))}getRenderTransform(t,e,n,r,i,o,s){const a=i/2,l=o/2,c=r/e,h=-c,u=-t[0]+s,d=-t[1];return jr(this.tempTransform,a,l,c,h,-n,u,d)}disposeInternal(){delete this.frameState,super.disposeInternal()}};function qc(t,e,n,r){return`${t},${function(t,e,n){return t+"/"+e+"/"+n}(e,n,r)}`}function Hc(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const r=t[n],i=r.has(e);return i||r.add(e),!i}function Jc(t,e,n){const r=t[n];return!!r&&r.delete(e)}function Qc(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=tn(e,Ir(n.extent,t.viewState.projection)));const r=n.layer.getRenderSource();if(!r.getWrapX()){const n=r.getTileGridForProjection(t.viewState.projection).getExtent();n&&(e=tn(e,n))}return e}const th=class extends Zc{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision_,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=[1/0,1/0,-1/0,-1/0],this.tempTileRange_=new Fc(0,0,0,0),this.tempTileCoord_=Kc(0,0,0);const n=void 0!==e.cacheSize?e.cacheSize:512;this.tileCache_=new Yc(n),this.maxStaleKeys=.5*n}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,n,r){const i=this.tileCache_,o=this.getLayer().getSource(),s=qc(o.getKey(),t,e,n);let a;if(i.containsKey(s))a=i.get(s);else{if(a=o.getTile(t,e,n,r.pixelRatio,r.viewState.projection),!a)return null;i.set(s,a)}return a}getTile(t,e,n,r){return this.getOrCreateTile(t,e,n,r)||null}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),r=Fr(e.pixelToCoordinateTransform,t.slice()),i=n.getExtent();if(i&&!Me(i,r))return null;const o=e.viewState,s=n.getRenderSource(),a=s.getTileGridForProjection(o.projection),l=s.getTilePixelRatio(e.pixelRatio);for(let t=a.getZForResolution(o.resolution);t>=a.getMinZoom();--t){const n=a.getTileCoordForCoordAndZ(r,t),i=this.getTile(t,n[1],n[2],e);if(!i||2!==i.getState())continue;const c=a.getOrigin(t),h=Ms(a.getTileSize(t)),u=a.getResolution(t);let d;if(i instanceof Rc||i instanceof Wc)d=i.getImage();else{if(!(i instanceof Oc))continue;if(d=Pc(i.getData()),!d)continue}const f=Math.floor(l*((r[0]-c[0])/u-n[1]*h[0])),p=Math.floor(l*((c[1]-r[1])/u-n[2]*h[1])),g=Math.round(l*s.getGutterForProjection(o.projection));return this.getImageData(d,f+g,p+g)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const n=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==n&&(this.renderedRevision_=n,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=n,!0}enqueueTiles(t,e,n,r,i){const o=t.viewState,s=this.getLayer(),a=s.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=Bt(a);c in t.wantedTiles||(t.wantedTiles[c]={});const h=t.wantedTiles[c],u=s.getMapInternal(),d=Math.max(n-i,l.getMinZoom(),l.getZForResolution(Math.min(s.getMaxResolution(),u?u.getView().getResolutionForZoom(Math.max(s.getMinZoom(),0)):l.getResolution(0)),a.zDirection)),f=o.rotation,p=f?Je(o.center,o.resolution,f,t.size):void 0;for(let i=n;i>=d;--i){const n=l.getTileRangeForExtentAndZ(e,i,this.tempTileRange_),o=l.getResolution(i);for(let e=n.minX;e<=n.maxX;++e)for(let s=n.minY;s<=n.maxY;++s){if(f&&!l.tileCoordIntersectsViewport([i,e,s],p))continue;const n=this.getTile(i,e,s,t);if(!n)continue;if(!Hc(r,n,i))continue;const a=n.getKey();if(h[a]=!0,0===n.getState()&&!t.tileQueue.isKeyQueued(a)){const r=Kc(i,e,s,this.tempTileCoord_);t.tileQueue.enqueue([n,c,l.getTileCoordCenter(r),o])}}}}findStaleTile_(t,e){const n=this.tileCache_,r=t[0],i=t[1],o=t[2],s=this.getStaleKeys();for(let t=0;t<s.length;++t){const a=qc(s[t],r,i,o);if(n.containsKey(a)){const t=n.peek(a);if(2===t.getState())return t.endTransition(Bt(this)),Hc(e,t,r),!0}}return!1}findAltTiles_(t,e,n,r){const i=t.getTileRangeForTileCoordAndZ(e,n,this.tempTileRange_);if(!i)return!1;let o=!0;const s=this.tileCache_,a=this.getLayer().getRenderSource().getKey();for(let t=i.minX;t<=i.maxX;++t)for(let e=i.minY;e<=i.maxY;++e){const i=qc(a,n,t,e);let l=!1;if(s.containsKey(i)){const t=s.peek(i);2===t.getState()&&(Hc(r,t,n),l=!0)}l||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const n=t.layerStatesArray[t.layerIndex],r=t.viewState,i=r.projection,o=r.resolution,s=r.center,a=t.pixelRatio,l=this.getLayer(),c=l.getSource(),h=c.getTileGridForProjection(i),u=h.getZForResolution(o,c.zDirection),d=h.getResolution(u),f=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==f&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=f):this.renderedSourceKey_=f;let p=t.extent;const g=c.getTilePixelRatio(a);this.prepareContainer(t,e);const m=this.context.canvas.width,y=this.context.canvas.height,v=n.extent&&Ir(n.extent);v&&(p=tn(p,Ir(n.extent)));const w=d*m/2/g,_=d*y/2/g,b=[s[0]-w,s[1]-_,s[0]+w,s[1]+_],x={};this.renderedTiles.length=0;const E=l.getPreload();if(t.nextExtent){const e=h.getZForResolution(r.nextResolution,c.zDirection),n=Qc(t,t.nextExtent);this.enqueueTiles(t,n,e,x,E)}const S=Qc(t,p);if(this.enqueueTiles(t,S,u,x,0),E>0&&setTimeout((()=>{this.enqueueTiles(t,S,u-1,x,E-1)}),0),!(u in x))return this.container;const L=Bt(this),C=t.time;for(const e of x[u]){const n=e.getState();if(4===n)continue;const r=e.tileCoord;if(2===n&&1===e.getAlpha(L,C)){e.endTransition(L);continue}if(3!==n&&(this.renderComplete=!1),this.findStaleTile_(r,x)){Jc(x,e,u),t.animate=!0;continue}if(this.findAltTiles_(h,r,u+1,x))continue;const i=h.getMinZoom();for(let t=u-1;t>=i&&!this.findAltTiles_(h,r,t,x);--t);}const k=d/o*a/g,P=this.getRenderContext(t);jr(this.tempTransform,m/2,y/2,k,k,0,-m/2,-y/2),n.extent&&this.clipUnrotated(P,t,v),c.getInterpolate()||(P.imageSmoothingEnabled=!1),this.preRender(P,t);const T=Object.keys(x).map(Number);let I;T.sort(wt);const O=[],R=[];for(let e=T.length-1;e>=0;--e){const n=T[e],r=c.getTilePixelSize(n,a,i),o=h.getResolution(n)/d,s=r[0]*o*k,l=r[1]*o*k,u=h.getTileCoordForCoordAndZ(en(b),n),f=h.getTileCoordExtent(u),p=Fr(this.tempTransform,[g*(f[0]-b[0])/d,g*(b[3]-f[3])/d]),m=g*c.getGutterForProjection(i);for(const e of x[n]){if(2!==e.getState())continue;const r=e.tileCoord,i=u[1]-r[1],o=Math.round(p[0]-(i-1)*s),a=u[2]-r[2],h=Math.round(p[1]-(a-1)*l),d=Math.round(p[0]-i*s),f=Math.round(p[1]-a*l),g=o-d,y=h-f,v=1===T.length;let w=!1;I=[d,f,d+g,f,d+g,f+y,d,f+y];for(let t=0,e=O.length;t<e;++t)if(!v&&n<R[t]){const e=O[t];on([d,f,d+g,f+y],[e[0],e[3],e[4],e[7]])&&(w||(P.save(),w=!0),P.beginPath(),P.moveTo(I[0],I[1]),P.lineTo(I[2],I[3]),P.lineTo(I[4],I[5]),P.lineTo(I[6],I[7]),P.moveTo(e[6],e[7]),P.lineTo(e[4],e[5]),P.lineTo(e[2],e[3]),P.lineTo(e[0],e[1]),P.clip())}O.push(I),R.push(n),this.drawTile(e,t,d,f,g,y,m,v),w&&P.restore(),this.renderedTiles.unshift(e),this.updateUsedTiles(t.usedTiles,c,e)}}if(this.renderedResolution=d,this.extentChanged=!this.renderedExtent_||!ze(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=a,this.postRender(this.context,t),n.extent&&P.restore(),P.imageSmoothingEnabled=!0,this.renderComplete){const e=(t,e)=>{const n=Bt(c),r=e.wantedTiles[n],i=r?Object.keys(r).length:0;this.updateCacheSize(i),this.tileCache_.expireCache()};t.postRenderFunctions.push(e)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,2*t)}drawTile(t,e,n,r,i,o,s,a){let l;if(t instanceof Oc){if(l=Pc(t.getData()),!l)throw new Error("Rendering array data is not yet supported")}else l=this.getTileImage(t);if(!l)return;const c=this.getRenderContext(e),h=Bt(this),u=e.layerStatesArray[e.layerIndex],d=u.opacity*(a?t.getAlpha(h,e.time):1),f=d!==c.globalAlpha;f&&(c.save(),c.globalAlpha=d),c.drawImage(l,s,s,l.width-2*s,l.height-2*s,n,r,i,o),f&&c.restore(),d!==u.opacity?e.animate=!0:a&&t.endTransition(h)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,n){const r=Bt(e);r in t||(t[r]={}),t[r][n.getKey()]=!0}},eh="preload",nh="useInterimTilesOnError",rh=class extends Uo{constructor(t){t=t||{};const e=Object.assign({},t),n=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=n,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(eh)}setPreload(t){this.set(eh,t)}getUseInterimTilesOnError(){return this.get(nh)}setUseInterimTilesOnError(t){this.set(nh,t)}getData(t){return super.getData(t)}},ih=class extends rh{constructor(t){super(t)}createRenderer(){return new th(this,{cacheSize:this.getCacheSize()})}},oh=[0,0,0],sh=class{constructor(t){let e;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,ue(function(t){const e=((t,e)=>e-t)||wt;return t.every((function(n,r){if(0===r)return!0;const i=e(t[r-1],n);return!(i>0||0===i)}))}(this.resolutions_),"`resolutions` must be sorted in descending order"),!t.origins)for(let t=0,n=this.resolutions_.length-1;t<n;++t)if(e){if(this.resolutions_[t]/this.resolutions_[t+1]!==e){e=void 0;break}}else e=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,ue(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;void 0===n||this.origin_||this.origins_||(this.origin_=en(n)),ue(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,ue(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,ue(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==n?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(((t,e)=>{const r=new Fc(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(n){const t=this.getTileRangeForExtentAndZ(n,e);r.minX=Math.max(t.minX,r.minX),r.maxX=Math.min(t.maxX,r.maxX),r.minY=Math.max(t.minY,r.minY),r.maxY=Math.min(t.maxY,r.maxY)}return r})):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const r=this.getTileRangeForExtentAndZ(t,e);for(let t=r.minX,i=r.maxX;t<=i;++t)for(let i=r.minY,o=r.maxY;i<=o;++i)n([e,t,i])}forEachTileCoordParentTileRange(t,e,n,r){let i,o,s,a=null,l=t[0]-1;for(2===this.zoomFactor_?(o=t[1],s=t[2]):a=this.getTileCoordExtent(t,r);l>=this.minZoom;){if(void 0!==o&&void 0!==s?(o=Math.floor(o/2),s=Math.floor(s/2),i=Ac(o,o,s,s,n)):i=this.getTileRangeForExtentAndZ(a,l,n),e(l,i))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const n=2*t[1],r=2*t[2];return Ac(n,n+1,r,r+1,e)}const r=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(r,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const r=t[0],i=t[1],o=t[2];if(e===r)return Ac(i,o,i,o,n);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-r),s=Math.floor(i*t),a=Math.floor(o*t);return e<r?Ac(s,s,a,a,n):Ac(s,Math.floor(t*(i+1))-1,a,Math.floor(t*(o+1))-1,n)}const s=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,oh);const r=oh[1],i=oh[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,oh),Ac(r,oh[1],i,oh[2],n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=Ms(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),r=this.getResolution(t[0]),i=Ms(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*i[0]*r,s=n[1]-(t[2]+1)*i[1]*r;return De(o,s,o+i[0]*r,s+i[1]*r,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,r,i){const o=this.getZForResolution(n),s=n/this.getResolution(o),a=this.getOrigin(o),l=Ms(this.getTileSize(o),this.tmpSize_);let c=s*(t-a[0])/n/l[0],h=s*(a[1]-e)/n/l[1];return r?(c=Le(c,5)-1,h=Le(h,5)-1):(c=Se(c,5),h=Se(h,5)),Kc(o,c,h,i)}getTileCoordForXYAndZ_(t,e,n,r,i){const o=this.getOrigin(n),s=this.getResolution(n),a=Ms(this.getTileSize(n),this.tmpSize_);let l=(t-o[0])/s/a[0],c=(o[1]-e)/s/a[1];return r?(l=Le(l,5)-1,c=Le(c,5)-1):(l=Se(l,5),c=Se(c,5)),Kc(n,l,c,i)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return me(bt(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return pi(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n}};function ah(t){let e=t.getDefaultTileGrid();return e||(e=function(t){return function(t,e,n,r){r=void 0!==r?r:"top-left";const i=lh(t,e,n);return new sh({extent:t,origin:qe(t,r),resolutions:i,tileSize:n})}(ch(t),void 0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function lh(t,e,n,r){e=void 0!==e?e:42,n=Ms(void 0!==n?n:256);const i=Qe(t),o=rn(t);r=r>0?r:Math.max(o/n[0],i/n[1]);const s=e+1,a=new Array(s);for(let t=0;t<s;++t)a[t]=r/Math.pow(2,t);return a}function ch(t){let e=(t=pr(t)).getExtent();if(!e){const n=180*wn.degrees/t.getMetersPerUnit();e=De(-n,-n,n,n)}return e}const hh=/\{z\}/g,uh=/\{x\}/g,dh=/\{y\}/g,fh=/\{-y\}/g;function ph(t,e){return function(n,r,i){if(!n)return;let o;const s=n[0];if(e){const t=e.getFullTileRange(s);t&&(o=t.getHeight()-1)}return function(t,e,n,r,i){return t.replace(hh,e.toString()).replace(uh,n.toString()).replace(dh,r.toString()).replace(fh,(function(){if(void 0===i)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()}))}(t,s,n[1],n[2],o)}}function gh(t){return t?"function"==typeof t?t:(Array.isArray(t)||(t=[t]),e=>t):null}const mh=class extends Wt{constructor(t){super(),this.projection=pr(t.projection),this.attributions_=gh(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise((function(t,n){e.viewResolver=t,e.viewRejector=n}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=gh(t),this.changed()}setState(t){this.state_=t,this.changed()}};class yh extends Ot{constructor(t,e){super(t),this.tile=e}}const vh=class extends mh{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null;this.tileGrid&&Ms(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tmpSize=[0,0],this.key_=t.key||Bt(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,r,i){return Nt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:ah(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const r=this.getTileGridForProjection(n),i=this.getTilePixelRatio(e),o=Ms(r.getTileSize(t),this.tmpSize);return 1==i?o:(s=o,a=i,void 0===(l=this.tmpSize)&&(l=[0,0]),l[0]=s[0]*a+.5|0,l[1]=s[1]*a+.5|0,l);var s,a,l}getTileCoordForTileUrlFunction(t,e){const n=void 0!==e?e:this.getProjection(),r=void 0!==e?this.getTileGridForProjection(n):this.tileGrid||this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=function(t,e,n){const r=e[0],i=t.getTileCoordCenter(e),o=ch(n);if(!Me(o,i)){const e=rn(o),n=Math.ceil((o[0]-i[0])/e);return i[0]+=e*n,t.getTileCoordForCoordAndZ(i,r)}return e}(r,t,n)),function(t,e){const n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const o=e.getFullTileRange(n);return!o||o.containsXY(r,i)}(t,r)?t:null}clear(){}refresh(){this.clear(),super.refresh()}};class wh extends vh{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===wh.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=Bt(e),r=e.getState();let i;1==r?(this.tileLoadingKeys_[n]=!0,i="tileloadstart"):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],i=3==r?"tileloaderror":2==r?"tileloadend":void 0),null!=i&&this.dispatchEvent(new yh(i,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,void 0!==e?this.setKey(e):this.changed()}setUrl(t){const e=function(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const r=n[1].charCodeAt(0),i=n[2].charCodeAt(0);let o;for(o=r;o<=i;++o)e.push(t.replace(n[0],String.fromCharCode(o)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const r=parseInt(n[2],10);for(let i=parseInt(n[1],10);i<=r;i++)e.push(t.replace(n[0],i.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=ph(t[i],e);return function(t){return 1===t.length?t[0]:function(e,n,r){if(!e)return;const i=function(t){return e=t[0],(t[1]<<e)+t[2];var e}(e),o=be(i,t.length);return t[o](e,n,r)}}(r)}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}}const _h=wh;function bh(t,e){t.getImage().src=e}const xh=class extends _h{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:bh,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:Rc,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!_r(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||_r(e,t)))return this.tileGrid;const n=Bt(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=ah(t)),this.tileGridForProjection[n]}createTile_(t,e,n,r,i,o){const s=[t,e,n],a=this.getTileCoordForTileUrlFunction(s,i),l=a?this.tileUrlFunction(a,r,i):void 0,c=new this.tileClass(s,void 0!==l?0:4,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(ut,this.handleTileChange.bind(this)),c}getTile(t,e,n,r,i){const o=this.getProjection();if(!o||!i||_r(o,i))return this.getTileInternal(t,e,n,r,o||i);const s=[t,e,n],a=this.getKey(),l=this.getTileGridForProjection(o),c=this.getTileGridForProjection(i),h=this.getTileCoordForTileUrlFunction(s,i),u=new Wc(o,l,i,c,s,h,this.getTilePixelRatio(r),this.getGutter(),((t,e,n,r)=>this.getTileInternal(t,e,n,r,o)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return u.key=a,u}getTileInternal(t,e,n,r,i){const o=this.getKey();return this.createTile_(t,e,n,r,i,o)}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const n=pr(t);if(n){const t=Bt(n);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}},Eh=class extends xh{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",n=void 0!==t.tileGrid?t.tileGrid:function(t){const e=t||{},n=e.extent||pr("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:lh(n,e.maxZoom,e.tileSize,e.maxResolution)};return new sh(r)}({extent:ch(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},Sh=class extends Eh{constructor(t){let e;e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];const n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",r=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}};function Lh(t,e){return function(n,r,i,o,s){!function(t,e,n,r,i,o,s){const a=new XMLHttpRequest;a.open("GET","function"==typeof t?t(n,r,i):t,!0),"arraybuffer"==e.getType()&&(a.responseType="arraybuffer"),a.withCredentials=false,a.onload=function(t){if(!a.status||a.status>=200&&a.status<300){const t=e.getType();try{let r;"text"==t||"json"==t?r=a.responseText:"xml"==t?r=a.responseXML||a.responseText:"arraybuffer"==t&&(r=a.response),r?o(e.readFeatures(r,{extent:n,featureProjection:i}),e.readProjection(r)):s()}catch{s()}}else s()},a.onerror=s,a.send()}(t,e,n,r,i,((t,e)=>{this.addFeatures(t),void 0!==o&&o(t)}),(()=>{this.changed(),void 0!==s&&s()}))}}function Ch(t,e){return[[-1/0,-1/0,1/0,1/0]]}function kh(t,e,n,r,i,o,s){let a,l;const c=(n-e)/r;if(1===c)a=e;else if(2===c)a=e,l=i;else if(0!==c){let o=t[e],s=t[e+1],c=0;const h=[0];for(let i=e+r;i<n;i+=r){const e=t[i],n=t[i+1];c+=Math.sqrt((e-o)*(e-o)+(n-s)*(n-s)),h.push(c),o=e,s=n}const u=i*c,d=function(t,e,n){let r,i;n=n||wt;let o=0,s=t.length,a=!1;for(;o<s;)r=o+(s-o>>1),i=+n(t[r],e),i<0?o=r+1:(s=r,a=!i);return a?o:~o}(h,u);d<0?(l=(u-h[-d-2])/(h[-d-1]-h[-d-2]),a=e+(-d-2)*r):a=e+d*r}s=s>1?s:2,o=o||new Array(s);for(let e=0;e<s;++e)o[e]=void 0===a?NaN:void 0===l?t[a+e]:xe(t[a+e],t[a+r+e],l);return o}const Ph=[1,0,0,1,0,0];class Th{constructor(t,e,n,r,i,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=i,this.squaredTolerance_,this.stride_=r,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_="Point"===this.type_?Ge(this.flatCoordinates_):Be(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=Ze(this.getExtent());this.flatInteriorPoints_=di(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=function(t,e){const n=[];let r,i=0,o=0;for(let s=0,a=e.length;s<a;++s){const a=e[s],l=mi(t,i,a,2);if(void 0===r&&(r=l),l===r)n.push(e.slice(o,s+1));else{if(0===n.length)continue;n[n.length-1].push(e[o])}o=s+1,i=a}return n}(this.flatCoordinates_,this.ends_),e=function(t,e,n){const r=[];let i=[1/0,1/0,-1/0,-1/0];for(let o=0,s=n.length;o<s;++o){const s=n[o];i=Be(t,e,s[0],2),r.push((i[0]+i[2])/2,(i[1]+i[3])/2),e=s[s.length-1]}return r}(this.flatCoordinates_,0,t);this.flatInteriorPoints_=function(t,e,n,r,i){let o=[];for(let r=0,s=n.length;r<s;++r){const s=n[r];o=di(t,e,s,2,i,2*r,o),e=s[s.length-1]}return o}(this.flatCoordinates_,0,t,0,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=kh(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let r=0,i=n.length;r<i;++r){const i=n[r],o=kh(t,e,i,2,.5);Et(this.flatMidpoints_,o),e=i}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){const e=(t=pr(t)).getExtent(),n=t.getWorldExtent();if(e&&n){const t=Qe(n)/Qe(e);jr(Ph,n[0],n[3],t,-t,0,0,0),Br(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Ph,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new Th(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Pt(((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let r;switch(this.type_){case"LineString":n.length=ei(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),r=[n.length];break;case"MultiLineString":r=[],n.length=function(t,e,n,r,i,o,s,a){for(let l=0,c=n.length;l<c;++l){const c=n[l];s=ei(t,e,c,r,i,o,s),a.push(s),e=c}return s}(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,r);break;case"Polygon":r=[],n.length=ii(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,r)}return r&&(this.simplifiedGeometry_=new Th(this.type_,n,r,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_})),this}}Th.prototype.getFlatCoordinates=Th.prototype.getOrientedFlatCoordinates;const Ih=Th,Oh=class{constructor(t){this.rbush_=new Jo(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[Bt(e)]=n}load(t,e){const n=new Array(e.length);for(let r=0,i=e.length;r<i;r++){const i=t[r],o=e[r],s={minX:i[0],minY:i[1],maxX:i[2],maxY:i[3],value:o};n[r]=s,this.items_[Bt(o)]=s}this.rbush_.load(n)}remove(t){const e=Bt(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)}update(t,e){const n=this.items_[Bt(e)];ze([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map((function(t){return t.value}))}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let r=0,i=t.length;r<i;r++)if(n=e(t[r]),n)return n;return n}isEmpty(){return It(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return De(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}},Rh="addfeature",Mh="removefeature";class Ah extends Ot{constructor(t,e,n){super(t),this.feature=e,this.features=n}}const Fh=class extends mh{constructor(t){super({attributions:(t=t||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX}),this.on,this.once,this.un,this.loader_=kt,this.format_=t.format||null,this.overlaps_=void 0===t.overlaps||t.overlaps,this.url_=t.url,void 0!==t.loader?this.loader_=t.loader:void 0!==this.url_&&(ue(this.format_,"`format` must be set when `url` is set"),this.loader_=Lh(this.url_,this.format_)),this.strategy_=void 0!==t.strategy?t.strategy:Ch;const e=void 0===t.useSpatialIndex||t.useSpatialIndex;let n,r;this.featuresRtree_=e?new Oh:null,this.loadedExtentsRtree_=new Oh,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(t.features)?r=t.features:t.features&&(n=t.features,r=n.getArray()),e||void 0!==n||(n=new Xt(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==n&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=Bt(t);if(!this.addToIndex_(e,t))return void(this.featuresCollection_&&this.featuresCollection_.remove(t));this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const e=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(e,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Ah(Rh,t))}setupChangeEvents_(t,e){e instanceof Ih||(this.featureChangeKeys_[t]=[Mt(e,ut,this.handleFeatureChange_,this),Mt(e,ht,this.handleFeatureChange_,this)])}addToIndex_(t,e){let n=!0;if(void 0!==e.getId()){const t=String(e.getId());if(t in this.idIndex_)if(e instanceof Ih){const r=this.idIndex_[t];r instanceof Ih?Array.isArray(r)?r.push(e):this.idIndex_[t]=[r,e]:n=!1}else n=!1;else this.idIndex_[t]=e}return n&&(ue(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],r=[];for(let e=0,r=t.length;e<r;e++){const r=t[e],i=Bt(r);this.addToIndex_(i,r)&&n.push(r)}for(let t=0,i=n.length;t<i;t++){const i=n[t],o=Bt(i);this.setupChangeEvents_(o,i);const s=i.getGeometry();if(s){const t=s.getExtent();e.push(t),r.push(i)}else this.nullGeometryFeatures_[o]=i}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(Rh))for(let t=0,e=n.length;t<e;t++)this.dispatchEvent(new Ah(Rh,n[t]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Rh,(function(n){e||(e=!0,t.push(n.feature),e=!1)})),this.addEventListener(Mh,(function(n){e||(e=!0,t.remove(n.feature),e=!1)})),t.addEventListener(lt,(t=>{e||(e=!0,this.addFeature(t.element),e=!1)})),t.addEventListener(ct,(t=>{e||(e=!0,this.removeFeature(t.element),e=!1)})),this.featuresCollection_=t}clear(t){if(t){for(const t in this.featureChangeKeys_)this.featureChangeKeys_[t].forEach(Ft);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach((t=>{this.removeFeatureInternal(t)}));for(const t in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[t])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Ah("clear");this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,(function(n){const r=n.getGeometry();if(r instanceof Ih||r.intersectsCoordinate(t))return e(n)}))}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,(function(n){const r=n.getGeometry();if(r instanceof Ih||r.intersectsExtent(t)){const t=e(n);if(t)return t}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),It(this.nullGeometryFeatures_)||Et(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const n=ln(t,e);return[].concat(...n.map((t=>this.featuresRtree_.getInExtent(t))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const n=t[0],r=t[1];let i=null;const o=[NaN,NaN];let s=1/0;const a=[-1/0,-1/0,1/0,1/0];return e=e||Lt,this.featuresRtree_.forEachInExtent(a,(function(t){if(e(t)){const e=t.getGeometry(),l=s;if(s=e instanceof Ih?0:e.closestPointXY(n,r,o,s),s<l){i=t;const e=Math.sqrt(s);a[0]=n-e,a[1]=r-e,a[2]=n+e,a[3]=r+e}}})),i}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return void 0!==e?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return void 0!==e?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=Bt(e),r=e.getGeometry();if(r){const t=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(t,e)):this.featuresRtree_&&this.featuresRtree_.update(t,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);const i=e.getId();if(void 0!==i){const t=i.toString();this.idIndex_[t]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[t]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new Ah("changefeature",e))}hasFeature(t){const e=t.getId();return void 0!==e?e in this.idIndex_:Bt(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&It(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(t,e,n){const r=this.loadedExtentsRtree_,i=this.strategy_(t,e,n);for(let t=0,o=i.length;t<o;++t){const o=i[t];r.forEachInExtent(o,(function(t){return Ae(t.extent,o)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new Ah("featuresloadstart")),this.loader_.call(this,o,e,n,(t=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ah("featuresloadend",void 0,t))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ah("featuresloaderror"))})),r.insert(o,{extent:o.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_,n=e.forEachInExtent(t,(function(e){if(ze(e.extent,t))return e}));n&&e.remove(n)}removeFeatures(t){let e=!1;for(let n=0,r=t.length;n<r;++n)e=this.removeFeatureInternal(t[n])||e;e&&this.changed()}removeFeature(t){t&&this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=Bt(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const n=this.featureChangeKeys_[e];n?.forEach(Ft),delete this.featureChangeKeys_[e];const r=t.getId();if(void 0!==r){const e=r.toString(),n=this.idIndex_[e];n===t?delete this.idIndex_[e]:Array.isArray(n)&&(n.splice(n.indexOf(t),1),1===n.length&&(this.idIndex_[e]=n[0]))}return delete this.uidIndex_[e],this.hasListener(Mh)&&this.dispatchEvent(new Ah(Mh,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){ue(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Lh(t,this.format_))}setOverlaps(t){this.overlaps_=t,this.changed()}},jh=class{drawCustom(t,e,n,r,i){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,n){}drawFeature(t,e,n){}drawGeometryCollection(t,e,n){}drawLineString(t,e,n){}drawMultiLineString(t,e,n){}drawMultiPoint(t,e,n){}drawMultiPolygon(t,e,n){}drawPoint(t,e,n){}drawPolygon(t,e,n){}drawText(t,e,n){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}},Dh={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Nh=[Dh.FILL],Gh=[Dh.STROKE],Bh=[Dh.BEGIN_PATH],zh=[Dh.CLOSE_PATH],Wh=Dh,Yh=class extends jh{constructor(t,e,n,r){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=r,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,i=this.coordinates;let o=i.length;for(let s=0,a=t.length;s<a;s+=e)r[0]=t[s],r[1]=t[s+1],Me(n,r)&&(i[o++]=r[0],i[o++]=r[1]);return o}appendFlatLineCoordinates(t,e,n,r,i,o){const s=this.coordinates;let a=s.length;const l=this.getBufferedMaxExtent();o&&(e+=r);let c=t[e],h=t[e+1];const u=this.tmpCoordinate_;let d,f,p,g=!0;for(d=e+r;d<n;d+=r)u[0]=t[d],u[1]=t[d+1],p=je(l,u),p!==f?(g&&(s[a++]=c,s[a++]=h,g=!1),s[a++]=u[0],s[a++]=u[1]):1===p?(s[a++]=u[0],s[a++]=u[1],g=!1):g=!0,c=u[0],h=u[1],f=p;return(i&&g||d===e+r)&&(s[a++]=c,s[a++]=h),a}drawCustomCoordinates_(t,e,n,r,i){for(let o=0,s=n.length;o<s;++o){const s=n[o],a=this.appendFlatLineCoordinates(t,e,s,r,!1,!1);i.push(a),e=s}return e}drawCustom(t,e,n,r,i){this.beginGeometry(t,e,i);const o=t.getType(),s=t.getStride(),a=this.coordinates.length;let l,c,h,u,d;switch(o){case"MultiPolygon":l=t.getOrientedFlatCoordinates(),u=[];const e=t.getEndss();d=0;for(let t=0,n=e.length;t<n;++t){const n=[];d=this.drawCustomCoordinates_(l,d,e[t],s,n),u.push(n)}this.instructions.push([Wh.CUSTOM,a,u,t,n,ti,i]),this.hitDetectionInstructions.push([Wh.CUSTOM,a,u,t,r||n,ti,i]);break;case"Polygon":case"MultiLineString":h=[],l="Polygon"==o?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),d=this.drawCustomCoordinates_(l,0,t.getEnds(),s,h),this.instructions.push([Wh.CUSTOM,a,h,t,n,Qr,i]),this.hitDetectionInstructions.push([Wh.CUSTOM,a,h,t,r||n,Qr,i]);break;case"LineString":case"Circle":l=t.getFlatCoordinates(),c=this.appendFlatLineCoordinates(l,0,l.length,s,!1,!1),this.instructions.push([Wh.CUSTOM,a,c,t,n,Jr,i]),this.hitDetectionInstructions.push([Wh.CUSTOM,a,c,t,r||n,Jr,i]);break;case"MultiPoint":l=t.getFlatCoordinates(),c=this.appendFlatPointCoordinates(l,s),c>a&&(this.instructions.push([Wh.CUSTOM,a,c,t,n,Jr,i]),this.hitDetectionInstructions.push([Wh.CUSTOM,a,c,t,r||n,Jr,i]));break;case"Point":l=t.getFlatCoordinates(),this.coordinates.push(l[0],l[1]),c=this.coordinates.length,this.instructions.push([Wh.CUSTOM,a,c,t,n,void 0,i]),this.hitDetectionInstructions.push([Wh.CUSTOM,a,c,t,r||n,void 0,i])}this.endGeometry(e)}beginGeometry(t,e,n){this.beginGeometryInstruction1_=[Wh.BEGIN_GEOMETRY,e,0,t,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Wh.BEGIN_GEOMETRY,e,0,t,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;let e;t.reverse();const n=t.length;let r,i,o=-1;for(e=0;e<n;++e)r=t[e],i=r[0],i==Wh.END_GEOMETRY?o=e:i==Wh.BEGIN_GEOMETRY&&(r[2]=e,xt(this.hitDetectionInstructions,o,e),o=-1)}fillStyleToState(t,e={}){if(t){const n=t.getColor();e.fillPatternScale=n&&"object"==typeof n&&"src"in n?this.pixelRatio:1,e.fillStyle=hl(n||dl)}else e.fillStyle=void 0;return e}strokeStyleToState(t,e={}){if(t){const n=t.getColor();e.strokeStyle=hl(n||ml);const r=t.getLineCap();e.lineCap=void 0!==r?r:fl;const i=t.getLineDash();e.lineDash=i?i.slice():pl;const o=t.getLineDashOffset();e.lineDashOffset=o||0;const s=t.getLineJoin();e.lineJoin=void 0!==s?s:gl;const a=t.getWidth();e.lineWidth=void 0!==a?a:1;const l=t.getMiterLimit();e.miterLimit=void 0!==l?l:10,e.lineWidth>this.maxLineWidth&&(this.maxLineWidth=e.lineWidth,this.bufferedMaxExtent_=null)}else e.strokeStyle=void 0,e.lineCap=void 0,e.lineDash=null,e.lineDashOffset=void 0,e.lineJoin=void 0,e.lineWidth=void 0,e.miterLimit=void 0;return e}setFillStrokeStyle(t,e){const n=this.state;this.fillStyleToState(t,n),this.strokeStyleToState(e,n)}createFill(t){const e=t.fillStyle,n=[Wh.SET_FILL_STYLE,e];return"string"!=typeof e&&n.push(t.fillPatternScale),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[Wh.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,t.lineDash?this.applyPixelRatio(t.lineDash):null,t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,r=t.lineCap,i=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,l=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=r||i!=t.currentLineDash&&!St(t.currentLineDash,i)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=l)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=r,t.currentLineDash=i,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=l)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[Wh.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Oe(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Ie(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}},Kh=class extends Yh{constructor(t,e,n,r){super(t,e,n,r)}drawFlatCoordinatess_(t,e,n,r){const i=this.state,o=void 0!==i.fillStyle,s=void 0!==i.strokeStyle,a=n.length;this.instructions.push(Bh),this.hitDetectionInstructions.push(Bh);for(let i=0;i<a;++i){const o=n[i],a=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,o,r,!0,!s),c=[Wh.MOVE_TO_LINE_TO,a,l];this.instructions.push(c),this.hitDetectionInstructions.push(c),s&&(this.instructions.push(zh),this.hitDetectionInstructions.push(zh)),e=o}return o&&(this.instructions.push(Nh),this.hitDetectionInstructions.push(Nh)),s&&(this.instructions.push(Gh),this.hitDetectionInstructions.push(Gh)),e}drawCircle(t,e,n){const r=this.state,i=r.fillStyle,o=r.strokeStyle;if(void 0===i&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([Wh.SET_FILL_STYLE,dl]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([Wh.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,pl,0]);const s=t.getFlatCoordinates(),a=t.getStride(),l=this.coordinates.length;this.appendFlatLineCoordinates(s,0,s.length,a,!1,!1);const c=[Wh.CIRCLE,l];this.instructions.push(Bh,c),this.hitDetectionInstructions.push(Bh,c),void 0!==r.fillStyle&&(this.instructions.push(Nh),this.hitDetectionInstructions.push(Nh)),void 0!==r.strokeStyle&&(this.instructions.push(Gh),this.hitDetectionInstructions.push(Gh)),this.endGeometry(e)}drawPolygon(t,e,n){const r=this.state,i=r.fillStyle,o=r.strokeStyle;if(void 0===i&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([Wh.SET_FILL_STYLE,dl]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([Wh.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,pl,0]);const s=t.getEnds(),a=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(a,0,s,l),this.endGeometry(e)}drawMultiPolygon(t,e,n){const r=this.state,i=r.fillStyle,o=r.strokeStyle;if(void 0===i&&void 0===o)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),void 0!==r.fillStyle&&this.hitDetectionInstructions.push([Wh.SET_FILL_STYLE,dl]),void 0!==r.strokeStyle&&this.hitDetectionInstructions.push([Wh.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,pl,0]);const s=t.getEndss(),a=t.getOrientedFlatCoordinates(),l=t.getStride();let c=0;for(let t=0,e=s.length;t<e;++t)c=this.drawFlatCoordinatess_(a,c,s[t],l);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(0!==t){const e=this.coordinates;for(let n=0,r=e.length;n<r;++n)e[n]=ni(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}};function Xh(t,e,n,r,i){const o=[];let s=n,a=0,l=e.slice(n,2);for(;a<t&&s+i<r;){const[n,r]=l.slice(-2),c=e[s+i],h=e[s+i+1],u=Math.sqrt((c-n)*(c-n)+(h-r)*(h-r));if(a+=u,a>=t){const e=(t-a+u)/u,d=xe(n,c,e),f=xe(r,h,e);l.push(d,f),o.push(l),l=[d,f],a==t&&(s+=i),a=0}else if(a<t)l.push(e[s+i],e[s+i+1]),s+=i;else{const t=u-a,e=xe(n,c,t/u),d=xe(r,h,t/u);l.push(e,d),o.push(l),l=[e,d],a=0,s+=i}}return a>0&&o.push(l),o}function Vh(t,e,n,r,i){let o,s,a,l,c,h,u,d,f,p,g=n,m=n,y=0,v=0,w=n;for(s=n;s<r;s+=i){const n=e[s],r=e[s+1];void 0!==c&&(f=n-c,p=r-h,l=Math.sqrt(f*f+p*p),void 0!==u&&(v+=a,o=Math.acos((u*f+d*p)/(a*l)),o>t&&(v>y&&(y=v,g=w,m=s),v=0,w=s-i)),a=l,u=f,d=p),c=n,h=r}return v+=l,v>y?[w,s]:[g,m]}const $h={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Uh={Circle:Kh,Default:Yh,Image:class extends Yh{constructor(t,e,n,r){super(t,e,n,r),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,n){if(!this.image_||this.maxExtent&&!Me(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,n);const r=t.getFlatCoordinates(),i=t.getStride(),o=this.coordinates.length,s=this.appendFlatPointCoordinates(r,i);this.instructions.push([Wh.DRAW_IMAGE,o,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Wh.DRAW_IMAGE,o,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,n){if(!this.image_)return;this.beginGeometry(t,e,n);const r=t.getFlatCoordinates(),i=[];for(let e=0,n=r.length;e<n;e+=t.getStride())this.maxExtent&&!Me(this.maxExtent,r.slice(e,e+2))||i.push(r[e],r[e+1]);const o=this.coordinates.length,s=this.appendFlatPointCoordinates(i,2);this.instructions.push([Wh.DRAW_IMAGE,o,s,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Wh.DRAW_IMAGE,o,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),r=t.getSize(),i=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=i[0],this.originY_=i[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}},LineString:class extends Yh{constructor(t,e,n,r){super(t,e,n,r)}drawFlatCoordinates_(t,e,n,r){const i=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,r,!1,!1),s=[Wh.MOVE_TO_LINE_TO,i,o];return this.instructions.push(s),this.hitDetectionInstructions.push(s),n}drawLineString(t,e,n){const r=this.state,i=r.strokeStyle,o=r.lineWidth;if(void 0===i||void 0===o)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([Wh.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,pl,0],Bh);const s=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(s,0,s.length,a),this.hitDetectionInstructions.push(Gh),this.endGeometry(e)}drawMultiLineString(t,e,n){const r=this.state,i=r.strokeStyle,o=r.lineWidth;if(void 0===i||void 0===o)return;this.updateStrokeStyle(r,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([Wh.SET_STROKE_STYLE,r.strokeStyle,r.lineWidth,r.lineCap,r.lineJoin,r.miterLimit,pl,0],Bh);const s=t.getEnds(),a=t.getFlatCoordinates(),l=t.getStride();let c=0;for(let t=0,e=s.length;t<e;++t)c=this.drawFlatCoordinates_(a,c,s[t],l);this.hitDetectionInstructions.push(Gh),this.endGeometry(e)}finish(){const t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Gh),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Gh),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Bh)}},Polygon:Kh,Text:class extends Yh{constructor(t,e,n,r){super(t,e,n,r),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[dl]={fillStyle:dl},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,n){const r=this.textFillState_,i=this.textStrokeState_,o=this.textState_;if(""===this.text_||!o||!r&&!i)return;const s=this.coordinates;let a=s.length;const l=t.getType();let c=null,h=t.getStride();if("line"!==o.placement||"LineString"!=l&&"MultiLineString"!=l&&"Polygon"!=l&&"MultiPolygon"!=l){let r=o.overflow?null:[];switch(l){case"Point":case"MultiPoint":c=t.getFlatCoordinates();break;case"LineString":c=t.getFlatMidpoint();break;case"Circle":c=t.getCenter();break;case"MultiLineString":c=t.getFlatMidpoints(),h=2;break;case"Polygon":c=t.getFlatInteriorPoint(),o.overflow||r.push(c[2]/this.resolution),h=3;break;case"MultiPolygon":const e=t.getFlatInteriorPoints();c=[];for(let t=0,n=e.length;t<n;t+=3)o.overflow||r.push(e[t+2]/this.resolution),c.push(e[t],e[t+1]);if(0===c.length)return;h=2}const i=this.appendFlatPointCoordinates(c,h);if(i===a)return;if(r&&(i-a)/2!=c.length/h){let t=a/2;r=r.filter(((e,n)=>{const r=s[2*(t+n)]===c[n*h]&&s[2*(t+n)+1]===c[n*h+1];return r||--t,r}))}this.saveTextStates_();const u=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,d=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(t,e,n);let f=o.padding;if(f!=wl&&(o.scale[0]<0||o.scale[1]<0)){let t=o.padding[0],e=o.padding[1],n=o.padding[2],r=o.padding[3];o.scale[0]<0&&(e=-e,r=-r),o.scale[1]<0&&(t=-t,n=-n),f=[t,e,n,r]}const p=this.pixelRatio;this.instructions.push([Wh.DRAW_IMAGE,a,i,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,f==wl?wl:f.map((function(t){return t*p})),u,d,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,r]);const g=1/p,m=u?u.slice(0):null;m&&(m[1]=dl),this.hitDetectionInstructions.push([Wh.DRAW_IMAGE,a,i,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[g,g],NaN,this.declutterMode_,this.declutterImageWithText_,f,m,d,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?dl:this.fillKey_,this.textOffsetX_,this.textOffsetY_,r]),this.endGeometry(e)}else{if(!on(this.maxExtent,t.getExtent()))return;let r;if(c=t.getFlatCoordinates(),"LineString"==l)r=[c.length];else if("MultiLineString"==l)r=t.getEnds();else if("Polygon"==l)r=t.getEnds().slice(0,1);else if("MultiPolygon"==l){const e=t.getEndss();r=[];for(let t=0,n=e.length;t<n;++t)r.push(e[t][0])}this.beginGeometry(t,e,n);const i=o.repeat,u=i?void 0:o.textAlign;let d=0;for(let t=0,e=r.length;t<e;++t){let e;e=i?Xh(i*this.resolution,c,d,r[t],h):[c.slice(d,r[t])];for(let n=0,i=e.length;n<i;++n){const i=e[n];let l=0,c=i.length;if(null==u){const t=Vh(o.maxAngle,i,0,i.length,2);l=t[0],c=t[1]}for(let t=l;t<c;t+=h)s.push(i[t],i[t+1]);const f=s.length;d=r[t],this.drawChars_(a,f),a=f}}this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const i=this.textKey_;i in this.textStates||(this.textStates[i]={font:e.font,textAlign:e.textAlign||yl,justify:e.justify,textBaseline:e.textBaseline||vl,scale:e.scale});const o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,r=this.textState_,i=this.strokeKey_,o=this.textKey_,s=this.fillKey_;this.saveTextStates_();const a=this.pixelRatio,l=$h[r.textBaseline],c=this.textOffsetY_*a,h=this.text_,u=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Wh.DRAW_CHARS,t,e,l,r.overflow,s,r.maxAngle,a,c,i,u*a,h,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Wh.DRAW_CHARS,t,e,l,r.overflow,s?dl:s,r.maxAngle,a,c,i,u*a,h,o,1/a,this.declutterMode_,this.textKeepUpright_])}setTextStyle(t,e){let n,r,i;if(t){const e=t.getFill();e?(r=this.textFillState_,r||(r={},this.textFillState_=r),r.fillStyle=hl(e.getColor()||dl)):(r=null,this.textFillState_=r);const o=t.getStroke();if(o){i=this.textStrokeState_,i||(i={},this.textStrokeState_=i);const t=o.getLineDash(),e=o.getLineDashOffset(),n=o.getWidth(),r=o.getMiterLimit();i.lineCap=o.getLineCap()||fl,i.lineDash=t?t.slice():pl,i.lineDashOffset=void 0===e?0:e,i.lineJoin=o.getLineJoin()||gl,i.lineWidth=void 0===n?1:n,i.miterLimit=void 0===r?10:r,i.strokeStyle=hl(o.getColor()||ml)}else i=null,this.textStrokeState_=i;n=this.textState_;const s=t.getFont()||ul;Sl(s);const a=t.getScaleArray();n.overflow=t.getOverflow(),n.font=s,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||vl,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||wl,n.scale=void 0===a?[1,1]:a;const l=t.getOffsetX(),c=t.getOffsetY(),h=t.getRotateWithView(),u=t.getKeepUpright(),d=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===l?0:l,this.textOffsetY_=void 0===c?0:c,this.textRotateWithView_=void 0!==h&&h,this.textKeepUpright_=void 0===u||u,this.textRotation_=void 0===d?0:d,this.strokeKey_=i?("string"==typeof i.strokeStyle?i.strokeStyle:Bt(i.strokeStyle))+i.lineCap+i.lineDashOffset+"|"+i.lineWidth+i.lineJoin+i.miterLimit+"["+i.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=r&&r.fillStyle?"string"==typeof r.fillStyle?r.fillStyle:"|"+Bt(r.fillStyle):""}else this.text_="";this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}},Zh=class{constructor(t,e,n,r){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=r,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const r in n){const i=n[r].finish();t[e][r]=i}}return t}getBuilder(t,e){const n=void 0!==t?t.toString():"0";let r=this.buildersByZIndex_[n];void 0===r&&(r={},this.buildersByZIndex_[n]=r);let i=r[e];return void 0===i&&(i=new(0,Uh[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=i),i}};function qh(t,e,n,r){let i=t[e],o=t[e+1],s=0;for(let a=e+r;a<n;a+=r){const e=t[a],n=t[a+1];s+=Math.sqrt((e-i)*(e-i)+(n-o)*(n-o)),i=e,o=n}return s}function Hh(t,e,n,r,i,o,s,a,l,c,h,u,d=!0){let f=t[e],p=t[e+1],g=0,m=0,y=0,v=0;function w(){g=f,m=p,f=t[e+=r],p=t[e+1],v+=y,y=Math.sqrt((f-g)*(f-g)+(p-m)*(p-m))}do{w()}while(e<n-r&&v+y<o);let _=0===y?0:(o-v)/y;const b=xe(g,f,_),x=xe(m,p,_),E=e-r,S=v,L=o+a*l(c,i,h);for(;e<n-r&&v+y<L;)w();_=0===y?0:(L-v)/y;const C=xe(g,f,_),k=xe(m,p,_);let P=!1;if(d)if(u){const t=[b,x,C,k];zr(t,0,4,2,u,t,t),P=t[0]>t[2]}else P=b>C;const T=Math.PI,I=[],O=E+r===e;let R;if(y=0,v=S,f=t[e=E],p=t[e+1],O){w(),R=Math.atan2(p-m,f-g),P&&(R+=R>0?-T:T);const t=(C+b)/2,e=(k+x)/2;return I[0]=[t,e,(L-o)/2,R,i],I}for(let t=0,u=(i=i.replace(/\n/g," ")).length;t<u;){w();let d=Math.atan2(p-m,f-g);if(P&&(d+=d>0?-T:T),void 0!==R){let t=d-R;if(t+=t>T?-2*T:t<-T?2*T:0,Math.abs(t)>s)return null}R=d;const b=t;let x=0;for(;t<u;++t){const s=a*l(c,i[P?u-t-1:t],h);if(e+r<n&&v+y<o+x+s/2)break;x+=s}if(t===b)continue;const E=P?i.substring(u-b,u-t):i.substring(b,t);_=0===y?0:(o+x/2-v)/y;const S=xe(g,f,_),L=xe(m,p,_);I.push([S,L,x/2,d,E]),o+=x}return I}const Jh=[1/0,1/0,-1/0,-1/0],Qh=[],tu=[],eu=[],nu=[];function ru(t){return t[3].declutterBox}const iu=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function ou(t,e){return"start"===e?e=iu.test(t)?"right":"left":"end"===e&&(e=iu.test(t)?"left":"right"),$h[e]}function su(t,e,n){return n>0&&t.push("\n",""),t.push(e,""),t}function au(t,e,n){return n%2==0&&(t+=e),t}const lu=class{constructor(t,e,n,r,i){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=i?new Xc:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,n,r){const i=t+e+n+r;if(this.labels_[i])return this.labels_[i];const o=r?this.strokeStates[r]:null,s=n?this.fillStates[n]:null,a=this.textStates[e],l=this.pixelRatio,c=[a.scale[0]*l,a.scale[1]*l],h=a.justify?$h[a.justify]:ou(Array.isArray(t)?t[0]:t,a.textAlign||yl),u=r&&o.lineWidth?o.lineWidth:0,d=Array.isArray(t)?t:String(t).split("\n").reduce(su,[]),{width:f,height:p,widths:g,heights:m,lineWidths:y}=function(t,e){const n=[],r=[],i=[];let o=0,s=0,a=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const u=e[c];if("\n"===u||c===h){o=Math.max(o,s),i.push(s),s=0,a+=l,l=0;continue}const d=e[c+1]||t.font,f=kl(d,u);n.push(f),s+=f;const p=Ll(d);r.push(p),l=Math.max(l,p)}return{width:o,height:a,widths:n,heights:r,lineWidths:i}}(a,d),v=f+u,w=[],_=(v+2)*c[0],b=(p+u)*c[1],x={width:_<0?Math.floor(_):Math.ceil(_),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:w};1==c[0]&&1==c[1]||w.push("scale",c),r&&(w.push("strokeStyle",o.strokeStyle),w.push("lineWidth",u),w.push("lineCap",o.lineCap),w.push("lineJoin",o.lineJoin),w.push("miterLimit",o.miterLimit),w.push("setLineDash",[o.lineDash]),w.push("lineDashOffset",o.lineDashOffset)),n&&w.push("fillStyle",s.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");const E=.5-h;let S=h*v+E*u;const L=[],C=[];let k,P=0,T=0,I=0,O=0;for(let t=0,e=d.length;t<e;t+=2){const e=d[t];if("\n"===e){T+=P,P=0,S=h*v+E*u,++O;continue}const i=d[t+1]||a.font;i!==k&&(r&&L.push("font",i),n&&C.push("font",i),k=i),P=Math.max(P,m[I]);const o=[e,S+E*g[I]+h*(g[I]-y[O]),.5*(u+P)+T];S+=g[I],r&&L.push("strokeText",o),n&&C.push("fillText",o),++I}return Array.prototype.push.apply(w,L),Array.prototype.push.apply(w,C),this.labels_[i]=x,x}replayTextBackground_(t,e,n,r,i,o,s){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,i),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],t.fillStyle=o[1],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,r,i,o,s,a,l,c,h,u,d,f,p,g){let m=n-(s*=u[0]),y=r-(a*=u[1]);const v=i+l>t?t-l:i,w=o+c>e?e-c:o,_=f[3]+v*u[0]+f[1],b=f[0]+w*u[1]+f[2],x=m-f[3],E=y-f[0];let S;return(p||0!==h)&&(Qh[0]=x,nu[0]=x,Qh[1]=E,tu[1]=E,tu[0]=x+_,eu[0]=tu[0],eu[1]=E+b,nu[1]=eu[1]),0!==h?(S=jr([1,0,0,1,0,0],n,r,1,1,h,-n,-r),Fr(S,Qh),Fr(S,tu),Fr(S,eu),Fr(S,nu),De(Math.min(Qh[0],tu[0],eu[0],nu[0]),Math.min(Qh[1],tu[1],eu[1],nu[1]),Math.max(Qh[0],tu[0],eu[0],nu[0]),Math.max(Qh[1],tu[1],eu[1],nu[1]),Jh)):De(Math.min(x,x+_),Math.min(E,E+b),Math.max(x,x+_),Math.max(E,E+b),Jh),d&&(m=Math.round(m),y=Math.round(y)),{drawImageX:m,drawImageY:y,drawImageW:v,drawImageH:w,originX:l,originY:c,declutterBox:{minX:Jh[0],minY:Jh[1],maxX:Jh[2],maxY:Jh[3],value:g},canvasTransform:S,scale:u}}replayImageOrLabel_(t,e,n,r,i,o,s){const a=!(!o&&!s),l=r.declutterBox,c=s?s[2]*r.scale[0]/2:0;return l.minX-c<=e[0]&&l.maxX+c>=0&&l.minY-c<=e[1]&&l.maxY+c>=0&&(a&&this.replayTextBackground_(t,Qh,tu,eu,nu,o,s),function(t,e,n,r,i,o,s,a,l,c,h){t.save(),1!==n&&(void 0===t.globalAlpha?t.globalAlpha=t=>t.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(l,c),t.scale(h[0],h[1]),function(t,e){const n=t.contextInstructions;for(let t=0,r=n.length;t<r;t+=2)Array.isArray(n[t+1])?e[n[t]].apply(e,n[t+1]):e[n[t]]=n[t+1]}(r,t)):h[0]<0||h[1]<0?(t.translate(l,c),t.scale(h[0],h[1]),t.drawImage(r,i,o,s,a,0,0,s,a)):t.drawImage(r,i,o,s,a,l,c,s*h[0],a*h[1]),t.restore()}(t,r.canvasTransform,i,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const n=Fr(this.renderedTransform_,[0,0]),r=512*this.pixelRatio;t.save(),t.translate(n[0]%r,n[1]%r),1!==e&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,n,r){const i=this.textStates[e],o=this.createLabel(t,e,r,n),s=this.strokeStates[n],a=this.pixelRatio,l=ou(Array.isArray(t)?t[0]:t,i.textAlign||yl),c=$h[i.textBaseline||vl],h=s&&s.lineWidth?s.lineWidth:0;return{label:o,anchorX:l*(o.width/a-2*i.scale[0])+2*(.5-l)*h,anchorY:c*o.height/a+2*(.5-c)*h}}execute_(t,e,n,r,i,o,s,a){const l=this.zIndexContext_;let c;var h,u;this.pixelCoordinates_&&St(n,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=Br(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),u=n,(h=this.renderedTransform_)[0]=u[0],h[1]=u[1],h[2]=u[2],h[3]=u[3],h[4]=u[4],h[5]=u[5]);let d=0;const f=r.length;let p,g,m,y,v,w,_,b,x,E,S,L,C,k=0,P=0,T=0;const I=this.coordinateCache_,O=this.viewRotation_,R=Math.round(1e12*Math.atan2(-n[1],n[0]))/1e12,M={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:O},A=this.instructions!=r||this.overlaps?0:200;let F,j,D,N;for(;d<f;){const n=r[d];switch(n[0]){case Wh.BEGIN_GEOMETRY:F=n[1],N=n[3],F.getGeometry()?void 0===s||on(s,N.getExtent())?++d:d=n[2]+1:d=n[2],l&&(l.zIndex=n[4]);break;case Wh.BEGIN_PATH:P>A&&(this.fill_(t),P=0),T>A&&(t.stroke(),T=0),P||T||(t.beginPath(),v=NaN,w=NaN),++d;break;case Wh.CIRCLE:k=n[1];const r=c[k],h=c[k+1],u=c[k+2]-r,f=c[k+3]-h,G=Math.sqrt(u*u+f*f);t.moveTo(r+G,h),t.arc(r,h,G,0,2*Math.PI,!0),++d;break;case Wh.CLOSE_PATH:t.closePath(),++d;break;case Wh.CUSTOM:k=n[1],p=n[2];const B=n[3],z=n[4],W=n[5];M.geometry=B,M.feature=F,d in I||(I[d]=[]);const Y=I[d];W?W(c,k,p,2,Y):(Y[0]=c[k],Y[1]=c[k+1],Y.length=2),l&&(l.zIndex=n[6]),z(Y,M),++d;break;case Wh.DRAW_IMAGE:k=n[1],p=n[2],x=n[3],g=n[4],m=n[5];let K=n[6];const X=n[7],V=n[8],$=n[9],U=n[10];let Z=n[11];const q=n[12];let H=n[13];y=n[14]||"declutter";const J=n[15];if(!x&&n.length>=20){E=n[19],S=n[20],L=n[21],C=n[22];const t=this.drawLabelWithPointPlacement_(E,S,L,C);x=t.label,n[3]=x;const e=n[23];g=(t.anchorX-e)*this.pixelRatio,n[4]=g;const r=n[24];m=(t.anchorY-r)*this.pixelRatio,n[5]=m,K=x.height,n[6]=K,H=x.width,n[13]=H}let Q,tt,et,nt;n.length>25&&(Q=n[25]),n.length>17?(tt=n[16],et=n[17],nt=n[18]):(tt=wl,et=null,nt=null),U&&R?Z+=O:U||R||(Z-=O);let rt=0;for(;k<p;k+=2){if(Q&&Q[rt++]<H/this.pixelRatio)continue;const n=this.calculateImageOrLabelDimensions_(x.width,x.height,c[k],c[k+1],H,K,g,m,V,$,Z,q,i,tt,!!et||!!nt,F),r=[t,e,x,n,X,et,nt];if(a){let t,e,i,o,s;if(J){const n=p-k;if(!J[n]){J[n]={args:r,declutterMode:y};continue}const o=J[n];t=o.args,e=o.declutterMode,delete J[n],i=ru(t)}if(!t||"declutter"===e&&a.collides(i)||(o=!0),"declutter"===y&&a.collides(n.declutterBox)||(s=!0),"declutter"===e&&"declutter"===y){const t=o&&s;o=t,s=t}o&&("none"!==e&&a.insert(i),this.replayImageOrLabel_.apply(this,t)),s&&("none"!==y&&a.insert(n.declutterBox),this.replayImageOrLabel_.apply(this,r))}else this.replayImageOrLabel_.apply(this,r)}++d;break;case Wh.DRAW_CHARS:const it=n[1],ot=n[2],st=n[3],at=n[4];C=n[5];const lt=n[6],ct=n[7],ht=n[8];L=n[9];const ut=n[10];E=n[11],Array.isArray(E)&&(E=E.reduce(au,"")),S=n[12];const dt=[n[13],n[13]];y=n[14]||"declutter";const ft=n[15],pt=this.textStates[S],gt=pt.font,mt=[pt.scale[0]*ct,pt.scale[1]*ct];let yt;gt in this.widths_?yt=this.widths_[gt]:(yt={},this.widths_[gt]=yt);const vt=qh(c,it,ot,2),wt=Math.abs(mt[0])*Pl(gt,E,yt);if(at||wt<=vt){const n=Hh(c,it,ot,2,E,(vt-wt)*ou(E,this.textStates[S].textAlign),lt,Math.abs(mt[0]),Pl,gt,yt,R?0:this.viewRotation_,ft);t:if(n){const r=[];let i,o,s,l,c;if(L)for(i=0,o=n.length;i<o;++i){c=n[i],s=c[4],l=this.createLabel(s,S,"",L),g=c[2]+(mt[0]<0?-ut:ut),m=st*l.height+2*(.5-st)*ut*mt[1]/mt[0]-ht;const o=this.calculateImageOrLabelDimensions_(l.width,l.height,c[0],c[1],l.width,l.height,g,m,0,0,c[3],dt,!1,wl,!1,F);if(a&&"declutter"===y&&a.collides(o.declutterBox))break t;r.push([t,e,l,o,1,null,null])}if(C)for(i=0,o=n.length;i<o;++i){c=n[i],s=c[4],l=this.createLabel(s,S,C,""),g=c[2],m=st*l.height-ht;const o=this.calculateImageOrLabelDimensions_(l.width,l.height,c[0],c[1],l.width,l.height,g,m,0,0,c[3],dt,!1,wl,!1,F);if(a&&"declutter"===y&&a.collides(o.declutterBox))break t;r.push([t,e,l,o,1,null,null])}a&&"none"!==y&&a.load(r.map(ru));for(let t=0,e=r.length;t<e;++t)this.replayImageOrLabel_.apply(this,r[t])}}++d;break;case Wh.END_GEOMETRY:if(void 0!==o){F=n[1];const t=o(F,N,y);if(t)return t}++d;break;case Wh.FILL:A?P++:this.fill_(t),++d;break;case Wh.MOVE_TO_LINE_TO:for(k=n[1],p=n[2],j=c[k],D=c[k+1],t.moveTo(j,D),v=j+.5|0,w=D+.5|0,k+=2;k<p;k+=2)j=c[k],D=c[k+1],_=j+.5|0,b=D+.5|0,k!=p-2&&_===v&&b===w||(t.lineTo(j,D),v=_,w=b);++d;break;case Wh.SET_FILL_STYLE:this.alignAndScaleFill_=n[2],P&&(this.fill_(t),P=0,T&&(t.stroke(),T=0)),t.fillStyle=n[1],++d;break;case Wh.SET_STROKE_STYLE:T&&(t.stroke(),T=0),this.setStrokeStyle_(t,n),++d;break;case Wh.STROKE:A?T++:t.stroke(),++d;break;default:++d}}P&&this.fill_(t),T&&t.stroke()}execute(t,e,n,r,i,o){this.viewRotation_=r,this.execute_(t,e,n,this.instructions,i,void 0,void 0,o)}executeHitDetection(t,e,n,r,i){return this.viewRotation_=n,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,r,i)}},cu=["Polygon","Circle","LineString","Image","Text","Default"],hu=["Image","Text"],uu=cu.filter((t=>!hu.includes(t))),du={},fu=class{constructor(t,e,n,r,i,o,s){this.maxExtent_=t,this.overlaps_=r,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(i,s)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t,e){for(const n in t){let r=this.executorsByZIndex_[n];void 0===r&&(r={},this.executorsByZIndex_[n]=r);const i=t[n];for(const t in i){const n=i[t];r[t]=new lu(this.resolution_,this.pixelRatio_,this.overlaps_,n,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let e=0,r=t.length;e<r;++e)if(t[e]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,r,i,o){const s=2*(r=Math.round(r))+1,a=jr(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-n,-t[0],-t[1]),l=!this.hitDetectionContext_;l&&(this.hitDetectionContext_=Di(s,s));const c=this.hitDetectionContext_;let h;c.canvas.width!==s||c.canvas.height!==s?(c.canvas.width=s,c.canvas.height=s):l||c.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(h=[1/0,1/0,-1/0,-1/0],We(h,t),Ie(h,e*(this.renderBuffer_+r),h));const u=function(t){if(void 0!==du[t])return du[t];const e=2*t+1,n=t*t,r=new Array(n+1);for(let i=0;i<=t;++i)for(let o=0;o<=t;++o){const s=i*i+o*o;if(s>n)break;let a=r[s];a||(a=[],r[s]=a),a.push(4*((t+i)*e+(t+o))+3),i>0&&a.push(4*((t-i)*e+(t+o))+3),o>0&&(a.push(4*((t+i)*e+(t-o))+3),i>0&&a.push(4*((t-i)*e+(t-o))+3))}const i=[];for(let t=0,e=r.length;t<e;++t)r[t]&&i.push(...r[t]);return du[t]=i,i}(r);let d;function f(t,e,n){const a=c.getImageData(0,0,s,s).data;for(let l=0,h=u.length;l<h;l++)if(a[u[l]]>0){if(!o||"none"===n||"Image"!==d&&"Text"!==d||o.includes(t)){const n=(u[l]-3)/4,o=r-n%s,a=r-(n/s|0),c=i(t,e,o*o+a*a);if(c)return c}c.clearRect(0,0,s,s);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);let g,m,y,v,w;for(p.sort(wt),g=p.length-1;g>=0;--g){const t=p[g].toString();for(y=this.executorsByZIndex_[t],m=cu.length-1;m>=0;--m)if(d=cu[m],v=y[d],void 0!==v&&(w=v.executeHitDetection(c,a,n,f,h),w))return w}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],r=e[1],i=e[2],o=e[3],s=[n,r,n,o,i,o,i,r];return Br(s,0,8,2,t,s),s}isEmpty(){return It(this.executorsByZIndex_)}execute(t,e,n,r,i,o,s){const a=Object.keys(this.executorsByZIndex_).map(Number);a.sort(s?_t:wt),o=o||cu;const l=cu.length;for(let c=0,h=a.length;c<h;++c){const h=a[c].toString(),u=this.executorsByZIndex_[h];for(let h=0,d=o.length;h<d;++h){const d=o[h],f=u[d];if(void 0!==f){const o=null===s?void 0:f.getZIndexContext(),u=o?o.getContext():t,p=this.maxExtent_&&"Image"!==d&&"Text"!==d;if(p&&(u.save(),this.clip(u,n)),o&&"Text"!==d&&"Image"!==d?o.pushFunction((t=>f.execute(t,e,n,r,i,s))):f.execute(u,e,n,r,i,s),p&&u.restore(),o){o.offset();const t=a[c]*l+h;this.deferredZIndexContexts_[t]||(this.deferredZIndexContexts_[t]=[]),this.deferredZIndexContexts_[t].push(o)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(wt);for(let n=0,r=e.length;n<r;++n)t[e[n]].forEach((t=>{t.draw(this.renderedContext_),t.clear()})),t[e[n]].length=0}},pu=class extends jh{constructor(t,e,n,r,i,o,s){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=r,this.transformRotation_=r?Ee(Math.atan2(r[1],r[0]),10):0,this.viewRotation_=i,this.squaredTolerance_=o,this.userTransform_=s,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=[1,0,0,1,0,0]}drawImages_(t,e,n,r){if(!this.image_)return;const i=Br(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,s=this.tmpLocalTransform_,a=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=a*this.imageOpacity_);let l=this.imageRotation_;0===this.transformRotation_&&(l-=this.viewRotation_),this.imageRotateWithView_&&(l+=this.viewRotation_);for(let t=0,e=i.length;t<e;t+=2){const e=i[t]-this.imageAnchorX_,n=i[t+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const t=e+this.imageAnchorX_,r=n+this.imageAnchorY_;jr(s,t,r,1,1,l,-t,-r),o.save(),o.transform.apply(o,s),o.translate(t,r),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,e,n,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=a)}drawText_(t,e,n,r){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const i=Br(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_;let s=this.textRotation_;for(0===this.transformRotation_&&(s-=this.viewRotation_),this.textRotateWithView_&&(s+=this.viewRotation_);e<n;e+=r){const t=i[e]+this.textOffsetX_,n=i[e+1]+this.textOffsetY_;0!==s||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.save(),o.translate(t-this.textOffsetX_,n-this.textOffsetY_),o.rotate(s),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,t,n),this.textFillState_&&o.fillText(this.text_,t,n))}}moveToLineTo_(t,e,n,r,i){const o=this.context_,s=Br(t,e,n,r,this.transform_,this.pixelCoordinates_);o.moveTo(s[0],s[1]);let a=s.length;i&&(a-=2);for(let t=2;t<a;t+=2)o.lineTo(s[t],s[t+1]);return i&&o.closePath(),n}drawRings_(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e=this.moveToLineTo_(t,e,n[i],r,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),on(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=function(t,e,n){const r=t.getFlatCoordinates();if(!r)return null;const i=t.getStride();return Br(r,0,r.length,i,e,n)}(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],r=e[3]-e[1],i=Math.sqrt(n*n+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],i,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}drawFeature(t,e){const n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let t=0,n=e.length;t<n;++t)this.drawGeometry(e[t])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),on(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(on(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();let r=0;const i=t.getEnds(),o=t.getStride();e.beginPath();for(let t=0,e=i.length;t<e;++t)r=this.moveToLineTo_(n,r,i[t],o,!1);e.stroke()}if(""!==this.text_){const e=t.getFlatMidpoints();this.drawText_(e,0,e.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),on(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),on(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let r=0;const i=t.getEndss(),o=t.getStride();e.beginPath();for(let t=0,e=i.length;t<e;++t){const e=i[t];r=this.drawRings_(n,r,e,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),St(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,r=t.textAlign?t.textAlign:yl;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=r&&(n.textAlign=r,e.textAlign=r),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(t){const e=t.getColor();this.fillState_={fillStyle:hl(e||dl)}}else this.fillState_=null;if(e){const t=e.getColor(),n=e.getLineCap(),r=e.getLineDash(),i=e.getLineDashOffset(),o=e.getLineJoin(),s=e.getWidth(),a=e.getMiterLimit(),l=r||pl;this.strokeState_={lineCap:void 0!==n?n:fl,lineDash:1===this.pixelRatio_?l:l.map((t=>t*this.pixelRatio_)),lineDashOffset:(i||0)*this.pixelRatio_,lineJoin:void 0!==o?o:gl,lineWidth:(void 0!==s?s:1)*this.pixelRatio_,miterLimit:void 0!==a?a:10,strokeStyle:hl(t||ml)}}else this.strokeState_=null}setImageStyle(t){let e;if(!t||!(e=t.getSize()))return void(this.image_=null);const n=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),i=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*n,this.imageAnchorY_=r[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=i[0],this.imageOriginY_=i[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(t){const e=t.getFill();if(e){const t=e.getColor();this.textFillState_={fillStyle:hl(t||dl)}}else this.textFillState_=null;const n=t.getStroke();if(n){const t=n.getColor(),e=n.getLineCap(),r=n.getLineDash(),i=n.getLineDashOffset(),o=n.getLineJoin(),s=n.getWidth(),a=n.getMiterLimit();this.textStrokeState_={lineCap:void 0!==e?e:fl,lineDash:r||pl,lineDashOffset:i||0,lineJoin:void 0!==o?o:gl,lineWidth:void 0!==s?s:1,miterLimit:void 0!==a?a:10,strokeStyle:hl(t||ml)}}else this.textStrokeState_=null;const r=t.getFont(),i=t.getOffsetX(),o=t.getOffsetY(),s=t.getRotateWithView(),a=t.getRotation(),l=t.getScaleArray(),c=t.getText(),h=t.getTextAlign(),u=t.getTextBaseline();this.textState_={font:void 0!==r?r:ul,textAlign:void 0!==h?h:yl,textBaseline:void 0!==u?u:vl},this.text_=void 0!==c?Array.isArray(c)?c.reduce(((t,e,n)=>t+(n%2?" ":e)),""):c:"",this.textOffsetX_=void 0!==i?this.pixelRatio_*i:0,this.textOffsetY_=void 0!==o?this.pixelRatio_*o:0,this.textRotateWithView_=void 0!==s&&s,this.textRotation_=void 0!==a?a:0,this.textScale_=[this.pixelRatio_*l[0],this.pixelRatio_*l[1]]}else this.text_=""}},gu=.5,mu={Point:function(t,e,n,r,i,o){const s=n.getImage(),a=n.getText(),l=a&&a.getText(),c=o&&s&&l?{}:void 0;if(s){if(2!=s.getImageState())return;const o=t.getBuilder(n.getZIndex(),"Image");o.setImageStyle(s,c),o.drawPoint(e,r,i)}if(l){const o=t.getBuilder(n.getZIndex(),"Text");o.setTextStyle(a,c),o.drawText(e,r,i)}},LineString:function(t,e,n,r,i){const o=n.getStroke();if(o){const s=t.getBuilder(n.getZIndex(),"LineString");s.setFillStrokeStyle(null,o),s.drawLineString(e,r,i)}const s=n.getText();if(s&&s.getText()){const o=t.getBuilder(n.getZIndex(),"Text");o.setTextStyle(s),o.drawText(e,r,i)}},Polygon:function(t,e,n,r,i){const o=n.getFill(),s=n.getStroke();if(o||s){const a=t.getBuilder(n.getZIndex(),"Polygon");a.setFillStrokeStyle(o,s),a.drawPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const o=t.getBuilder(n.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}},MultiPoint:function(t,e,n,r,i,o){const s=n.getImage(),a=s&&0!==s.getOpacity(),l=n.getText(),c=l&&l.getText(),h=o&&a&&c?{}:void 0;if(a){if(2!=s.getImageState())return;const o=t.getBuilder(n.getZIndex(),"Image");o.setImageStyle(s,h),o.drawMultiPoint(e,r,i)}if(c){const o=t.getBuilder(n.getZIndex(),"Text");o.setTextStyle(l,h),o.drawText(e,r,i)}},MultiLineString:function(t,e,n,r,i){const o=n.getStroke();if(o){const s=t.getBuilder(n.getZIndex(),"LineString");s.setFillStrokeStyle(null,o),s.drawMultiLineString(e,r,i)}const s=n.getText();if(s&&s.getText()){const o=t.getBuilder(n.getZIndex(),"Text");o.setTextStyle(s),o.drawText(e,r,i)}},MultiPolygon:function(t,e,n,r,i){const o=n.getFill(),s=n.getStroke();if(s||o){const a=t.getBuilder(n.getZIndex(),"Polygon");a.setFillStrokeStyle(o,s),a.drawMultiPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const o=t.getBuilder(n.getZIndex(),"Text");o.setTextStyle(a),o.drawText(e,r,i)}},GeometryCollection:function(t,e,n,r,i,o){const s=e.getGeometriesArray();let a,l;for(a=0,l=s.length;a<l;++a)(0,mu[s[a].getType()])(t,s[a],n,r,i,o)},Circle:function(t,e,n,r,i){const o=n.getFill(),s=n.getStroke();if(o||s){const a=t.getBuilder(n.getZIndex(),"Circle");a.setFillStrokeStyle(o,s),a.drawCircle(e,r,i)}const a=n.getText();if(a&&a.getText()){const i=t.getBuilder(n.getZIndex(),"Text");i.setTextStyle(a),i.drawText(e,r)}}};function yu(t,e){return parseInt(Bt(t),10)-parseInt(Bt(e),10)}function vu(t,e){const n=wu(t,e);return n*n}function wu(t,e){return.5*t/e}function _u(t,e,n,r,i,o,s,a){const l=[],c=n.getImage();if(c){let t=!0;const e=c.getImageState();2==e||3==e?t=!1:0==e&&c.load(),t&&l.push(c.ready())}const h=n.getFill();h&&h.loading()&&l.push(h.ready());const u=l.length>0;return u&&Promise.all(l).then((()=>i(null))),function(t,e,n,r,i,o,s){const a=n.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(r,i);n.getRenderer()?bu(t,l,n,e,s):(0,mu[l.getType()])(t,l,n,e,s,o)}(t,e,n,r,o,s,a),u}function bu(t,e,n,r,i){if("GeometryCollection"!=e.getType())t.getBuilder(n.getZIndex(),"Default").drawCustom(e,r,n.getRenderer(),n.getHitDetectionRenderer(),i);else{const o=e.getGeometries();for(let e=0,s=o.length;e<s;++e)bu(t,o[e],n,r,i)}}const xu=class extends Zc{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=[1/0,1/0,-1/0,-1/0],this.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,n){const r=e.extent,i=e.viewState,o=i.center,s=i.resolution,a=i.projection,l=i.rotation,c=a.getExtent(),h=this.getLayer().getSource(),u=this.getLayer().getDeclutter(),d=e.pixelRatio,f=e.viewHints,p=!(f[0]||f[1]),g=this.context,m=Math.round(rn(r)/s*d),y=Math.round(Qe(r)/s*d),v=h.getWrapX()&&a.canWrapX(),w=v?rn(c):null,_=v?Math.ceil((r[2]-c[2])/w)+1:1;let b=v?Math.floor((r[0]-c[0])/w):0;do{let r=this.getRenderTransform(o,s,0,d,m,y,b*w);e.declutter&&(r=r.slice(0)),t.execute(g,[g.canvas.width,g.canvas.height],r,l,p,void 0===n?cu:n?hu:uu,n?u&&e.declutter[u]:void 0)}while(++b<_)}setDrawContext_(){1!==this.opacity_&&(this.targetContext_=this.context,this.context=Di(this.context.canvas.width,this.context.canvas.height,$c))}resetDrawContext_(){if(1!==this.opacity_){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Bi(this.context),$c.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){this.replayGroup_&&this.getLayer().getDeclutter()&&this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex];this.opacity_=n.opacity;const r=t.viewState;this.prepareContainer(t,e);const i=this.context,o=this.replayGroup_;let s=o&&!o.isEmpty();if(!s&&!this.getLayer().hasListener(Yo)&&!this.getLayer().hasListener(Ko))return this.container;this.setDrawContext_(),this.preRender(i,t);r.projection;if(this.clipped_=!1,s&&n.extent&&this.clipping){const e=Ir(n.extent);s=on(e,t.extent),this.clipped_=s&&!Ae(e,t.extent),this.clipped_&&this.clipUnrotated(i,t,e)}return s&&this.renderWorlds(o,t,!this.getLayer().getDeclutter()&&void 0),!t.declutter&&this.clipped_&&i.restore(),this.postRender(i,t),this.renderedRotation_!==r.rotation&&(this.renderedRotation_=r.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise((e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const t=this.frameState.size.slice(),e=this.renderedCenter_,n=this.renderedResolution_,r=this.renderedRotation_,i=this.renderedProjection_,o=this.wrappedRenderedExtent_,s=this.getLayer(),a=[],l=t[0]*gu,c=t[1]*gu;a.push(this.getRenderTransform(e,n,r,gu,l,c,0).slice());const h=s.getSource(),u=i.getExtent();if(h.getWrapX()&&i.canWrapX()&&!Ae(u,o)){let t=o[0];const i=rn(u);let s,h=0;for(;t<u[0];)--h,s=i*h,a.push(this.getRenderTransform(e,n,r,gu,l,c,s).slice()),t+=i;for(h=0,t=o[2];t>u[2];)++h,s=i*h,a.push(this.getRenderTransform(e,n,r,gu,l,c,s).slice()),t-=i}const d=Cr();this.hitDetectionImageData_=function(t,e,n,r,i,o,s,a,l){const c=l?Tr(i):i,h=Di(t[0]*gu,t[1]*gu);h.imageSmoothingEnabled=!1;const u=h.canvas,d=new pu(h,gu,i,null,s,a,l?br(Cr(),l):null),f=n.length,p=Math.floor(16777215/f),g={};for(let t=1;t<=f;++t){const e=n[t-1],i=e.getStyleFunction()||r;if(!i)continue;let s=i(e,o);if(!s)continue;Array.isArray(s)||(s=[s]);const a=(t*p).toString(16).padStart(7,"#00000");for(let t=0,n=s.length;t<n;++t){const n=s[t],r=n.getGeometryFunction()(e);if(!r||!on(c,r.getExtent()))continue;const i=n.clone(),o=i.getFill();o&&o.setColor(a);const l=i.getStroke();l&&(l.setColor(a),l.setLineDash(null)),i.setText(void 0);const h=n.getImage();if(h){const t=h.getImageSize();if(!t)continue;const e=Di(t[0],t[1],void 0,{alpha:!1}),n=e.canvas;e.fillStyle=a,e.fillRect(0,0,n.width,n.height),i.setImage(new Gl({img:n,anchor:h.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:h.getOrigin(),opacity:1,size:h.getSize(),scale:h.getScale(),rotation:h.getRotation(),rotateWithView:h.getRotateWithView()}))}const u=i.getZIndex()||0;let d=g[u];d||(d={},g[u]=d,d.Polygon=[],d.Circle=[],d.LineString=[],d.Point=[]);const f=r.getType();if("GeometryCollection"===f){const t=r.getGeometriesArrayRecursive();for(let e=0,n=t.length;e<n;++e){const n=t[e];d[n.getType().replace("Multi","")].push(n,i)}}else d[f.replace("Multi","")].push(r,i)}}const m=Object.keys(g).map(Number).sort(wt);for(let t=0,n=m.length;t<n;++t){const n=g[m[t]];for(const t in n){const r=n[t];for(let t=0,n=r.length;t<n;t+=2){d.setStyle(r[t+1]);for(let n=0,i=e.length;n<i;++n)d.setTransform(e[n]),d.drawGeometry(r[t])}}}return h.getImageData(0,0,u.width,u.height)}(t,a,this.renderedFeatures_,s.getStyleFunction(),o,n,r,vu(n,this.renderedPixelRatio_),d?i:null)}e(function(t,e,n){const r=[];if(n){const i=Math.floor(Math.round(t[0])*gu),o=Math.floor(Math.round(t[1])*gu),s=4*(me(i,0,n.width-1)+me(o,0,n.height-1)*n.width),a=n.data[s],l=n.data[s+1],c=n.data[s+2]+256*(l+256*a),h=Math.floor(16777215/e.length);c&&c%h==0&&r.push(e[c/h-1])}return r}(t,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(t,e,n,r,i){if(!this.replayGroup_)return;const o=e.viewState.resolution,s=e.viewState.rotation,a=this.getLayer(),l={},c=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(t,o,s,n,(function(t,e,n){const o=Bt(t),s=l[o];if(s){if(!0!==s&&n<s.distanceSq){if(0===n)return l[o]=!0,i.splice(i.lastIndexOf(s),1),r(t,a,e);s.geometry=e,s.distanceSq=n}}else{if(0===n)return l[o]=!0,r(t,a,e);i.push(l[o]={feature:t,layer:a,geometry:e,distanceSq:n,callback:r})}}),c?e.declutter?.[c]?.all().map((t=>t.value)):null)}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const r=t.viewHints[0],i=t.viewHints[1],o=e.getUpdateWhileAnimating(),s=e.getUpdateWhileInteracting();if(this.ready&&!o&&r||!s&&i)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const a=t.extent,l=t.viewState,c=l.projection,h=l.resolution,u=t.pixelRatio,d=e.getRevision(),f=e.getRenderBuffer();let p=e.getRenderOrder();void 0===p&&(p=yu);const g=l.center.slice(),m=Ie(a,f*h),y=m.slice(),v=[m.slice()],w=c.getExtent();if(n.getWrapX()&&c.canWrapX()&&!Ae(w,t.extent)){const t=rn(w),e=Math.max(rn(m)/2,t);m[0]=w[0]-e,m[2]=w[2]+e,un(g,c);const n=an(v[0],c);n[0]<w[0]&&n[2]<w[2]?v.push([n[0]+t,n[1],n[2]+t,n[3]]):n[0]>w[0]&&n[2]>w[2]&&v.push([n[0]-t,n[1],n[2]-t,n[3]])}if(this.ready&&this.renderedResolution_==h&&this.renderedRevision_==d&&this.renderedRenderOrder_==p&&this.renderedFrameDeclutter_===!!t.declutter&&Ae(this.wrappedRenderedExtent_,m))return St(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const _=new Zh(wu(h,u),m,h,u),b=Cr();let x;if(b){for(let t=0,e=v.length;t<e;++t){const e=Tr(v[t]);n.loadFeatures(e,Or(h),b)}x=br(b,c)}else for(let t=0,e=v.length;t<e;++t)n.loadFeatures(v[t],h,c);const E=vu(h,u);let S=!0;const L=(t,n)=>{let r;const i=t.getStyleFunction()||e.getStyleFunction();if(i&&(r=i(t,h)),r){const e=this.renderFeature(t,E,r,_,x,this.getLayer().getDeclutter(),n);S=S&&!e}},C=Tr(m),k=n.getFeaturesInExtent(C);p&&k.sort(p);for(let t=0,e=k.length;t<e;++t)L(k[t],t);this.renderedFeatures_=k,this.ready=S;const P=_.finish(),T=new fu(m,h,u,n.getOverlaps(),P,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=h,this.renderedRevision_=d,this.renderedRenderOrder_=p,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=y,this.wrappedRenderedExtent_=m,this.renderedCenter_=g,this.renderedProjection_=c,this.renderedPixelRatio_=u,this.replayGroup_=T,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,r,i,o,s){if(!n)return!1;let a=!1;if(Array.isArray(n))for(let l=0,c=n.length;l<c;++l)a=_u(r,t,n[l],e,this.boundHandleStyleImageChange_,i,o,s)||a;else a=_u(r,t,n,e,this.boundHandleStyleImageChange_,i,o,s);return a}},Eu=class extends wc{constructor(t){super(t)}createRenderer(){return new xu(this)}};class Su extends Wt{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new Su(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ft(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Mt(t,ut,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?function(t){if("function"==typeof t)return t;let e;return Array.isArray(t)?e=t:(ue("function"==typeof t.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const Lu=Su,Cu="element",ku="map",Pu="offset",Tu="position",Iu="positioning",Ou=class extends Wt{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=void 0===t.insertFirst||t.insertFirst,this.stopEvent=void 0===t.stopEvent||t.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==t.className?t.className:"ol-overlay-container ol-selectable",this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=!0===t.autoPan?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Cu,this.handleElementChanged),this.addChangeListener(ku,this.handleMapChanged),this.addChangeListener(Pu,this.handleOffsetChanged),this.addChangeListener(Tu,this.handlePositionChanged),this.addChangeListener(Iu,this.handlePositioningChanged),void 0!==t.element&&this.setElement(t.element),this.setOffset(void 0!==t.offset?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),void 0!==t.position&&this.setPosition(t.position)}getElement(){return this.get(Cu)}getId(){return this.id}getMap(){return this.get(ku)||null}getOffset(){return this.get(Pu)}getPosition(){return this.get(Tu)}getPositioning(){return this.get(Iu)}handleElementChanged(){Ki(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(this.element?.remove(),Ft(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=Mt(t,ie,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(Cu,t)}setMap(t){this.set(ku,t)}setOffset(t){this.set(Pu,t)}setPosition(t){this.set(Tu,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Tu))return;const n=this.getRect(e.getTargetElement(),e.getSize()),r=this.getElement(),i=this.getRect(r,[zi(r),Wi(r)]),o=void 0===(t=t||{}).margin?20:t.margin;if(!Ae(n,i)){const r=i[0]-n[0],s=n[2]-i[2],a=i[1]-n[1],l=n[3]-i[3],c=[0,0];if(r<0?c[0]=r-o:s<0&&(c[0]=Math.abs(s)+o),a<0?c[1]=a-o:l<0&&(c[1]=Math.abs(l)+o),0!==c[0]||0!==c[1]){const n=e.getView().getCenterInternal(),r=e.getPixelFromCoordinateInternal(n);if(!r)return;const i=[r[0]+c[0],r[1]+c[1]],o=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(i),duration:o.duration,easing:o.easing})}}}getRect(t,e){const n=t.getBoundingClientRect(),r=n.left+window.pageXOffset,i=n.top+window.pageYOffset;return[r,i,r+e[0],i+e[1]]}setPositioning(t){this.set(Iu,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const n=t.getPixelFromCoordinate(e),r=t.getSize();this.updateRenderedPosition(n,r)}updateRenderedPosition(t,e){const n=this.element.style,r=this.getOffset(),i=this.getPositioning();this.setVisible(!0);let o="0%",s="0%";"bottom-right"==i||"center-right"==i||"top-right"==i?o="-100%":"bottom-center"!=i&&"center-center"!=i&&"top-center"!=i||(o="-50%"),"bottom-left"==i||"bottom-center"==i||"bottom-right"==i?s="-100%":"center-left"!=i&&"center-center"!=i&&"center-right"!=i||(s="-50%");const a=`translate(${o}, ${s}) translate(${Math.round(t[0]+r[0])+"px"}, ${Math.round(t[1]+r[1])+"px"})`;this.rendered.transform_!=a&&(this.rendered.transform_=a,n.transform=a)}getOptions(){return this.options}};function Ru(t){return Ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ru(t)}function Mu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Au(r.key),r)}}function Au(t){var e=function(t){if("object"!=Ru(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ru(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ru(e)?e:e+""}var Fu=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"initMap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Fh,r=new Eu({source:n}),i="string"==typeof t?document.getElementById(t):t;if(i){var o=new Cc({target:i,layers:[new ih({source:new Sh}),r],view:new Ti({center:vr([118.014863,-2.548926]),zoom:5}),controls:Zi({zoom:!0,attribution:!0})}),s=document.getElementById("popup");s||(console.warn("Popup element not found in the DOM! Creating one dynamically."),(s=document.createElement("div")).id="popup",s.className="ol-popup",s.innerHTML='<div id="popup-content"></div>',document.body.appendChild(s));var a=new Ou({element:s,autoPan:!0,autoPanAnimation:{duration:250}});return o.addOverlay(a),e&&(o.on("click",(function(e){n.clear();var r=e.coordinate,i=wr(r),o=new Lu({geometry:new li(r)});o.setStyle(ju._),n.addFeature(o),a.setPosition(void 0);var s=new CustomEvent("locationselected",{detail:{lat:i[1],lng:i[0]}}),l=document.getElementById(t)||t;l?l.dispatchEvent(s):console.error("Container element not found for dispatching event.")})),r.getSource().on("addfeature",(function(t){var e=t.feature;e.on("click",(function(){var t=e.getGeometry().getCoordinates(),n=wr(t);a.setPosition(t);var r=document.getElementById("popup-content");r?r.innerHTML="You clicked here: "+n[1].toFixed(6)+", "+n[0].toFixed(6):console.error("Popup content element not found!")}))}))),o}console.error('Container element "'.concat(t,'" not found in the DOM!'))}},{key:"addMarker",value:function(t,e,n,r){var i=t.getLayers().item(1).getSource(),o=new Lu({geometry:new li(vr([n,e]))});o.set("popupContent",r),o.setStyle(ju._),i.addFeature(o),t.on("singleclick",(function(e){var n=!1;if(t.forEachFeatureAtPixel(e.pixel,(function(e){n=!0;var r=e.getGeometry().getCoordinates(),i=t.getOverlays().item(0);if(i){i.setPosition(r);var o=document.getElementById("popup-content");if(o){var s=e.get("popupContent");o.innerHTML=s||"No content available"}}})),!n){var r=t.getOverlays().item(0);r&&r.setPosition(void 0)}}));var s=document.getElementById("popup");if(s){var a=s.querySelector(".popup-close-button");a||((a=document.createElement("button")).className="popup-close-button",a.innerHTML="&times;",a.style.position="absolute",a.style.top="5px",a.style.right="5px",a.style.background="none",a.style.border="none",a.style.fontSize="20px",a.style.cursor="pointer",a.style.color="#333",s.appendChild(a)),a.addEventListener("click",(function(){var e=t.getOverlays().item(0);e&&e.setPosition(void 0)}))}return o}}],null&&Mu(t.prototype,null),e&&Mu(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),ju={_:new Vl({image:new Gl({anchor:[.5,1],src:"https://openlayers.org/en/latest/examples/data/icon.png",scale:1})})};const Du=Fu;function Nu(t){return Nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nu(t)}function Gu(){Gu=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Nu(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Nu(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Bu(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function zu(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Bu(o,r,i,s,a,"next",t)}function a(t){Bu(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Wu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yu(r.key),r)}}function Yu(t){var e=function(t){if("object"!=Nu(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Nu(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Nu(e)?e:e+""}function Ku(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Xu(t,e){return t.get($u(t,e))}function Vu(t,e,n){return t.set($u(t,e),n),n}function $u(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uu=new WeakMap,Zu=new WeakMap,qu=new WeakMap;const Hu=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ku(this,Uu,null),Ku(this,Zu,null),Ku(this,qu,[]),Vu(Uu,this,new rt(this))},e=[{key:"render",value:(i=zu(Gu().mark((function t(){return Gu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n    <section id="contentWrapper" class="entry-page container">\n      <h1 class="entry-page__heading">Explore Stories</h1>\n\n      <div id="entryCards" class="entry-page__grid"></div>\n\n      <div class="entry-page__nav">\n        <button id="btnPrev" class="nav-btn" aria-label="Previous page">\n          <i class="fas fa-chevron-left"></i> Previous\n        </button>\n        <span id="paginationStatus" class="nav-info">Page 1</span>\n        <button id="btnNext" class="nav-btn" aria-label="Next page">\n          Next <i class="fas fa-chevron-right"></i>\n        </button>\n      </div>\n\n      <div id="mapWrapper" class="entry-page__map" aria-label="Story location map"></div>\n\n    </section>\n  ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(r=zu(Gu().mark((function t(){var e,n,r,i,o,s,a=this;return Gu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.querySelector("#entryCards"),n=document.querySelector("#mapWrapper"),r=document.querySelector("#btnPrev"),i=document.querySelector("#btnNext"),o=document.querySelector("#paginationStatus"),Vu(Zu,this,Du.initMap(n,!1)),s=function(){var t=zu(Gu().mark((function t(n){var s,l,c,h,u,d;return Gu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Xu(Uu,a).loadStories(n);case 3:if(s=t.sent){t.next=6;break}return t.abrupt("return");case 6:l=s.stories,c=s.hasMore,h=s.currentPage,e.innerHTML="",(u=Xu(Zu,a).getLayers().getArray().find((function(t){return t instanceof Eu})))&&(d=u.getSource(),Xu(qu,a).forEach((function(t){d.removeFeature(t)}))),Vu(qu,a,[]),l.forEach((function(t){if(e.innerHTML+=a._createStoryCard(t),t.lat&&t.lon){var n=Du.addMarker(Xu(Zu,a),t.lat,t.lon,a._createPopupContent(t));Xu(qu,a).push(n)}})),r.disabled=1===h,i.disabled=!c,o.textContent="Page ".concat(h),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),console.error(t.t0),e.innerHTML='<div class="error-message">Failed to load stories</div>';case 21:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e){return t.apply(this,arguments)}}(),t.next=9,s(1);case 9:r.addEventListener("click",zu(Gu().mark((function t(){var e;return Gu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((e=Xu(Uu,a).getCurrentPage())>1)){t.next=4;break}return t.next=4,s(e-1);case 4:case"end":return t.stop()}}),t)})))),i.addEventListener("click",zu(Gu().mark((function t(){var e;return Gu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Xu(Uu,a).getCurrentPage(),t.next=3,s(e+1);case 3:case"end":return t.stop()}}),t)}))));case 11:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_createStoryCard",value:function(t){return'\n      <article class="story-item">\n        <img src="'.concat(t.photoUrl,'" alt="Photo of ').concat(t.name,'" class="story-item__image">\n        <div class="story-item__content">\n          <h2 class="story-item__title">').concat(t.name,'</h2>\n          <p class="story-item__description">').concat(t.description,'</p>\n          <p class="story-item__date"><i class="far fa-calendar-alt"></i> ').concat(at(t.createdAt),'</p>\n          <a href="#/stories/').concat(t.id,'" class="read-more-button">\n            Read more <i class="fas fa-arrow-right"></i>\n          </a>\n        </div>\n      </article>\n    ')}},{key:"_createPopupContent",value:function(t){return'\n      <div class="popup-content">\n        <h3>'.concat(t.name,'</h3>\n        <img src="').concat(t.photoUrl,'" alt="Photo of ').concat(t.name,'" style="max-width: 200px;">\n        <p>').concat(t.description,"</p>\n      </div>\n    ")}},{key:"destroy",value:(n=zu(Gu().mark((function t(){var e,n,r;return Gu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Xu(Zu,this)&&Xu(Zu,this).setTarget(null),(n=null===(e=Xu(Zu,this))||void 0===e?void 0:e.getLayers().getArray().find((function(t){return t instanceof Eu})))&&(r=n.getSource(),Xu(qu,this).forEach((function(t){r.removeFeature(t)})),Vu(qu,this,[]));case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&Wu(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i}();function Ju(t){return Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ju(t)}function Qu(){Qu=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Ju(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Ju(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function td(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function ed(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){td(o,r,i,s,a,"next",t)}function a(t){td(o,r,i,s,a,"throw",t)}s(void 0)}))}}function nd(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rd(r.key),r)}}function rd(t){var e=function(t){if("object"!=Ju(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ju(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ju(e)?e:e+""}function id(t,e,n){od(t,e),e.set(t,n)}function od(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sd(t,e){return t.get(ld(t,e))}function ad(t,e,n){return t.set(ld(t,e),n),n}function ld(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cd=new WeakMap,hd=new WeakMap,ud=new WeakMap,dd=new WeakMap,fd=new WeakSet;function pd(){var t=this;sd(dd,this)||(window.addEventListener("hashchange",(function(){t.stopCamera()})),window.addEventListener("beforeunload",(function(){t.stopCamera()})),ad(dd,this,!0))}const gd=function(){return t=function t(e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),od(this,n=fd),n.add(this),id(this,cd,null),id(this,hd,null),id(this,ud,null),id(this,dd,!1),ad(cd,this,e)},e=[{key:"addStory",value:(i=ed(Qu().mark((function t(e,n){var r,i,o;return Qu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,console.log("AddStoryPresenter.addStory - description:",e),console.log("AddStoryPresenter.addStory - photo:",n),console.log("AddStoryPresenter.addStory - location:",sd(ud,this)),this._validateAllFields(e,n)){t.next=6;break}return t.abrupt("return");case 6:if(r=localStorage.getItem("token")){t.next=9;break}throw new Error("Token not found");case 9:if(n instanceof File){t.next=12;break}throw console.error("Photo is not a File object:",n),new Error("Invalid photo format");case 12:return i={description:e,photo:n},sd(ud,this)&&(i.lat=sd(ud,this).lat,i.lon=sd(ud,this).lng),console.log("Sending story data to API:",{description:i.description,photoName:i.photo.name,photoSize:i.photo.size,photoType:i.photo.type,location:sd(ud,this)?"".concat(i.lat,", ").concat(i.lon):"none"}),t.next=17,W.addStory(i,r);case 17:if(o=t.sent,console.log("API response:",o),!o.error){t.next=21;break}throw new Error(o.message);case 21:return t.next=23,K().fire({icon:"success",title:"Success",text:"Story added successfully",timer:1500,showConfirmButton:!1});case 23:return t.next=25,this.stopCamera();case 25:window.location.hash="#/stories",t.next=34;break;case 28:return t.prev=28,t.t0=t.catch(0),console.error("Error in addStory:",t.t0),t.next=33,K().fire({icon:"error",title:"Failed to Add Story",text:t.t0.message});case 33:"Token not found"===t.t0.message&&(window.location.hash="#/login");case 34:case"end":return t.stop()}}),t,this,[[0,28]])}))),function(t,e){return i.apply(this,arguments)})},{key:"_validateAllFields",value:function(t,e){console.log("Validating fields - description:",!!t),console.log("Validating fields - photo:",!!e),console.log("Validating fields - location:",!!sd(ud,this));var n=[];return t&&0!==t.trim().length||n.push("story"),e?e instanceof File||(console.error("Photo is not a File object:",e),n.push("photo (invalid format)")):n.push("photo"),sd(ud,this)||n.push("location"),!(n.length>0&&(console.warn("Missing fields:",n),K().fire({icon:"warning",title:"Incomplete Data",text:"Please complete your ".concat(n.join(", "))}),1))}},{key:"startCamera",value:(r=ed(Qu().mark((function t(){return Qu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Starting camera..."),t.next=4,this.stopCamera();case 4:return ld(fd,this,pd).call(this),t.t0=ad,t.t1=hd,t.t2=this,t.next=10,navigator.mediaDevices.getUserMedia({video:!0,audio:!1});case 10:return t.t3=t.sent,(0,t.t0)(t.t1,t.t2,t.t3),console.log("Camera started successfully:",sd(hd,this)),t.abrupt("return",sd(hd,this));case 16:throw t.prev=16,t.t4=t.catch(0),console.error("Error starting camera:",t.t4),new Error("Unable to access camera");case 20:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(){return r.apply(this,arguments)})},{key:"stopCamera",value:(n=ed(Qu().mark((function t(){return Qu().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!sd(hd,this)){t.next=7;break}return console.log("Stopping camera..."),sd(hd,this).getTracks().forEach((function(t){return t.stop()})),ad(hd,this,null),console.log("Camera stopped"),t.abrupt("return",!0);case 7:return t.abrupt("return",!1);case 8:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"validateImage",value:function(t){if(console.log("Validating image:",t),!(t instanceof File))throw new Error("Invalid file");if(!t.type.startsWith("image/"))throw new Error("File must be an image");if(t.size>1048576)throw new Error("File size must not exceed 1MB");return console.log("Image validation passed"),!0}},{key:"setSelectedLocation",value:function(t){console.log("Location selected:",t),ad(ud,this,t)}},{key:"getSelectedLocation",value:function(){return sd(ud,this)}}],e&&nd(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i}();function md(t){return md="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},md(t)}function yd(){yd=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==md(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(md(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function vd(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function wd(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){vd(o,r,i,s,a,"next",t)}function a(t){vd(o,r,i,s,a,"throw",t)}s(void 0)}))}}function _d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bd(r.key),r)}}function bd(t){var e=function(t){if("object"!=md(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=md(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==md(e)?e:e+""}function xd(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Ed(t,e){return t.get(Ld(t,e))}function Sd(t,e,n){return t.set(Ld(t,e),n),n}function Ld(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cd=new WeakMap,kd=new WeakMap,Pd=new WeakMap;const Td=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),xd(this,Cd,null),xd(this,kd,null),xd(this,Pd,[]),Sd(Cd,this,new gd(this))},e=[{key:"render",value:(i=wd(yd().mark((function t(){return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="add-story container">\n        <h1 class="add-story__title"><i class="fas fa-plus-circle"></i>Add Story</h1>\n        \n        <form id="addStoryForm" class="add-story__form">\n          <div class="form-group">\n\n          <div class="form-group">\n            <label>\n              <i class="fas fa-map-marker-alt"></i> Location <span class="required">*</span>\n            </label>\n            <div id="map" class="add-story__map"></div>\n            <p class="map-help">\n              <i class="fas fa-info-circle"></i> Click on the map to mark the location\n            </p>\n            <div id="coordinateDisplay" class="coordinate-display" style="display: none;">\n              <i class="fas fa-map-pin"></i> \n              Latitude: <span id="latitudeValue">-</span>, \n              Longitude: <span id="longitudeValue">-</span>\n            </div>\n            <small id="locationStatus" class="form-help"></small>\n          </div>\n\n            <label for="description">\n              <i class="fas fa-pencil-alt"></i> Your Story <span class="required">*</span>\n            </label>\n            <textarea \n              id="description" \n              name="description" \n              required \n              placeholder="Share your special moment..."\n            ></textarea>\n            <small id="descriptionStatus" class="form-help"></small>\n          </div>\n\n          <div class="form-group">\n            <label>\n              <i class="fas fa-camera"></i> Photo <span class="required">*</span>\n            </label>\n            <div class="photo-input-container">\n              <div class="camera-container">\n                <video id="cameraPreview" class="camera-preview" autoplay playsinline style="display: none;"></video>\n                <canvas id="photoCanvas" class="photo-canvas" style="display: none;"></canvas>\n              </div>\n              \n              <div class="camera-buttons">\n                <button type="button" id="startCamera" class="camera-button">\n                  <i class="fas fa-camera"></i> Open Camera\n                </button>\n                <button type="button" id="closeCamera" class="camera-button camera-button--danger" style="display: none;">\n                  <i class="fas fa-times"></i> Close Camera\n                </button>\n                <button type="button" id="capturePhoto" class="camera-button" style="display: none;">\n                  <i class="fas fa-camera"></i> Capture Photo\n                </button>\n                <button type="button" id="retakePhoto" class="camera-button" style="display: none;">\n                  <i class="fas fa-redo"></i> Retake Photo\n                </button>\n              </div>\n              \n              <div class="upload-divider">or</div>\n              \n              <div class="upload-container">\n                <div class="file-input-wrapper">\n                  <label for="photo" class="upload-button">\n                    <i class="fas fa-upload"></i> Choose File\n                  </label>\n                  <input \n                    type="file" \n                    id="photo" \n                    name="photo" \n                    accept="image/*" \n                    class="file-input"\n                  >\n                </div>\n                <p class="file-help">Format: JPG, PNG, GIF (max. 1MB)</p>\n                <small id="photoStatus" class="form-help"></small>\n                \n                <div id="imagePreview" class="image-preview" style="display: none;">\n                  <img id="previewImage" class="preview-image">\n                  <button type="button" id="removeImage" class="camera-button camera-button--danger">&times;</button>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <button type="submit" class="submit-button">\n            <i class="fas fa-paper-plane"></i> Add Story\n          </button>\n\n          <p class="required-note">\n            <span class="required">*</span> Required\n          </p>\n        </form>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(r=wd(yd().mark((function t(){var e,n,r,i,o,s,a,l,c,h,u,d,f,p,g,m,y,v,w,_,b=this;return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=document.getElementById("addStoryForm"),n=document.getElementById("cameraPreview"),r=document.getElementById("photoCanvas"),i=document.getElementById("startCamera"),o=document.getElementById("closeCamera"),s=document.getElementById("capturePhoto"),a=document.getElementById("retakePhoto"),l=document.getElementById("photo"),c=document.getElementById("imagePreview"),h=document.getElementById("previewImage"),u=document.getElementById("removeImage"),d=document.getElementById("map"),f=document.getElementById("coordinateDisplay"),p=document.getElementById("latitudeValue"),g=document.getElementById("longitudeValue"),m=document.getElementById("descriptionStatus"),y=document.getElementById("photoStatus"),v=document.getElementById("locationStatus"),w=null,console.log("DOM Elements:"),console.log("- form:",!!e),console.log("- cameraPreview:",!!n),console.log("- photoCanvas:",!!r),console.log("- fileInput:",!!l),console.log("- mapContainer:",!!d),console.log("- coordinateDisplay:",!!f),Sd(kd,this,Du.initMap(d,!0)),(_=function(){var t=document.getElementById("description").value;t&&0!==t.trim().length?(m.textContent=" Story filled",m.className="form-help text-success"):(m.textContent="Story not filled",m.className="form-help text-warning"),w?(y.textContent=" Photo selected",y.className="form-help text-success"):(y.textContent="Photo not selected",y.className="form-help text-warning"),Ed(Cd,b).getSelectedLocation()?(v.textContent=" Location selected",v.className="form-help text-success"):(v.textContent="Location not selected",v.className="form-help text-warning")})(),document.getElementById("description").addEventListener("input",_),i.addEventListener("click",wd(yd().mark((function t(){var e;return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Starting camera..."),t.next=4,Ed(Cd,b).startCamera();case 4:if(e=t.sent,console.log("Camera stream obtained:",e),e){t.next=8;break}throw new Error("Unable to access camera");case 8:return n.srcObject=e,t.next=11,n.play();case 11:console.log("Camera preview dimensions:",{width:n.videoWidth,height:n.videoHeight}),n.style.display="block",i.style.display="none",o.style.display="block",s.style.display="block",t.next=22;break;case 18:t.prev=18,t.t0=t.catch(0),console.error("Failed to start camera:",t.t0),alert("Failed to access camera. Make sure you grant permission to use the camera.");case 22:case"end":return t.stop()}}),t,null,[[0,18]])})))),o.addEventListener("click",wd(yd().mark((function t(){return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Closing camera..."),t.next=3,Ed(Cd,b).stopCamera();case 3:n.srcObject=null,n.style.display="none",o.style.display="none",s.style.display="none",i.style.display="block";case 8:case"end":return t.stop()}}),t)})))),s.addEventListener("click",wd(yd().mark((function t(){return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Capturing photo..."),t.prev=1,n.srcObject&&n.videoWidth){t.next=5;break}throw console.error("Video stream not ready"),new Error("Camera not ready. Try again.");case 5:return r.width=n.videoWidth,r.height=n.videoHeight,console.log("Canvas dimensions set to:",{width:r.width,height:r.height}),r.getContext("2d").drawImage(n,0,0,r.width,r.height),console.log("Video frame drawn to canvas"),t.next=13,new Promise((function(t,e){r.toBlob((function(n){if(n){var r=new File([n],"camera-photo.jpg",{type:"image/jpeg",lastModified:Date.now()});console.log("Photo blob created:",{size:n.size,type:n.type}),console.log("Photo file created:",{name:r.name,size:r.size,type:r.type}),t(r)}else e(new Error("Failed to capture photo from camera"))}),"image/jpeg",.9)}));case 13:if((w=t.sent)&&0!==w.size){t.next=16;break}throw new Error("Failed to capture photo from camera");case 16:return Ed(Cd,b).validateImage(w),h.src=URL.createObjectURL(w),c.style.display="inline-block",n.style.display="none",r.style.display="block",s.style.display="none",o.style.display="none",a.style.display="block",t.next=26,Ed(Cd,b).stopCamera();case 26:_(),console.log("Photo capture completed successfully"),t.next=34;break;case 30:t.prev=30,t.t0=t.catch(1),console.error("Error capturing photo:",t.t0),alert("Failed to capture photo: ".concat(t.t0.message));case 34:case"end":return t.stop()}}),t,null,[[1,30]])})))),a.addEventListener("click",wd(yd().mark((function t(){var e;return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("Retaking photo..."),t.next=4,Ed(Cd,b).startCamera();case 4:return e=t.sent,n.srcObject=e,t.next=8,n.play();case 8:n.style.display="block",r.style.display="none",s.style.display="block",o.style.display="block",a.style.display="none",c.style.display="none",w=null,_(),t.next=22;break;case 18:t.prev=18,t.t0=t.catch(0),console.error("Failed to restart camera:",t.t0),alert("Failed to access camera. Make sure you grant permission to use the camera.");case 22:case"end":return t.stop()}}),t,null,[[0,18]])})))),l.addEventListener("change",function(){var t=wd(yd().mark((function t(e){var u;return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("File input changed"),u=e.target.files[0]){t.next=5;break}return console.log("No file selected"),t.abrupt("return");case 5:return t.prev=5,console.log("Selected file:",{name:u.name,size:u.size,type:u.type}),Ed(Cd,b).validateImage(u),w=u,h.src=URL.createObjectURL(u),c.style.display="inline-block",t.next=13,Ed(Cd,b).stopCamera();case 13:n.style.display="none",r.style.display="none",i.style.display="block",s.style.display="none",o.style.display="none",a.style.display="none",_(),console.log("File selected successfully"),t.next=28;break;case 23:t.prev=23,t.t0=t.catch(5),console.error("File validation error:",t.t0),alert(t.t0.message),l.value="";case 28:case"end":return t.stop()}}),t,null,[[5,23]])})));return function(e){return t.apply(this,arguments)}}()),u.addEventListener("click",(function(){console.log("Removing image..."),w=null,l.value="",c.style.display="none",_(),console.log("Image removed")})),d.addEventListener("locationselected",(function(t){console.log("Location selected:",t.detail);var e=t.detail,n=e.lat,r=e.lng;p.textContent=n.toFixed(6),g.textContent=r.toFixed(6),f.style.display="block",Ed(Cd,b).setSelectedLocation(t.detail),_()})),e.addEventListener("submit",function(){var t=wd(yd().mark((function t(n){var r,i;return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),console.log("Form submitted"),(r=e.querySelector('button[type="submit"]')).disabled=!0,r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Sending...',t.prev=5,i=document.getElementById("description").value,console.log("Submitting story:"),console.log("- description:",i),console.log("- photo:",w?{name:w.name,size:w.size,type:w.type}:"null"),t.next=12,Ed(Cd,b).addStory(i,w);case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(5),console.error("Form submission error:",t.t0),alert("Failed to submit story: ".concat(t.t0.message));case 18:return t.prev=18,r.disabled=!1,r.innerHTML='<i class="fas fa-paper-plane"></i> Add Story',t.finish(18);case 22:case"end":return t.stop()}}),t,null,[[5,14,18,22]])})));return function(e){return t.apply(this,arguments)}}());case 38:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"destroy",value:(n=wd(yd().mark((function t(){var e,n,r;return yd().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Ed(kd,this)&&Ed(kd,this).setTarget(null),(n=null===(e=Ed(kd,this))||void 0===e?void 0:e.getLayers().getArray().find((function(t){return t instanceof Eu})))&&(r=n.getSource(),Ed(Pd,this).forEach((function(t){r.removeFeature(t)})),Sd(Pd,this,[]));case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&_d(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,i}();function Id(t){return Id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Id(t)}function Od(){Od=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Id(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Id(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Rd(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Md(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ad(r.key),r)}}function Ad(t){var e=function(t){if("object"!=Id(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Id(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Id(e)?e:e+""}function Fd(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function jd(t,e){return t.get(Nd(t,e))}function Dd(t,e,n){return t.set(Nd(t,e),n),n}function Nd(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gd=new WeakMap,Bd=new WeakMap,zd=new WeakMap;const Wd=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Fd(this,Gd,null),Fd(this,Bd,null),Fd(this,zd,null),Dd(Gd,this,e)},e=[{key:"getStoryDetail",value:(n=Od().mark((function t(e){var n,r;return Od().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=localStorage.getItem("token")){t.next=4;break}throw new Error("Token not found");case 4:return t.next=6,W.getStoryById(e,n);case 6:return r=t.sent,t.abrupt("return",r.story);case 10:return t.prev=10,t.t0=t.catch(0),t.next=14,K().fire({icon:"error",title:"Failed to Load Story",text:t.t0.message||"Unknown error"});case 14:throw"Token not found"===t.t0.message&&(window.location.hash="#/login"),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,10]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function s(t){Rd(o,r,i,s,a,"next",t)}function a(t){Rd(o,r,i,s,a,"throw",t)}s(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"initMap",value:function(t){Dd(zd,this,new Fh),Dd(Bd,this,new Cc({target:t,layers:[new ih({source:new Sh}),new Eu({source:jd(zd,this)})],view:new Ti({center:vr([0,0]),zoom:2})}))}},{key:"setMapView",value:function(t,e){if(jd(Bd,this)){var n=jd(Bd,this).getView();n.setCenter(vr([e,t])),n.setZoom(13)}}},{key:"addMarker",value:function(t,e,n){if(jd(Bd,this)&&jd(zd,this)){var r=new Lu({geometry:new li(vr([e,t]))});r.setStyle(new Vl({image:new Gl({src:"https://openlayers.org/en/latest/examples/data/icon.png",scale:1})})),jd(zd,this).addFeature(r)}}},{key:"destroyMap",value:function(){jd(Bd,this)&&(jd(Bd,this).setTarget(null),Dd(Bd,this,null),Dd(zd,this,null))}}],e&&Md(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}(),Yd=(t,e)=>e.some((e=>t instanceof e));let Kd,Xd;const Vd=new WeakMap,$d=new WeakMap,Ud=new WeakMap;let Zd={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return Vd.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Jd(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function qd(t){Zd=t(Zd)}function Hd(t){return"function"==typeof t?(e=t,(Xd||(Xd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Qd(this),t),Jd(this.request)}:function(...t){return Jd(e.apply(Qd(this),t))}):(t instanceof IDBTransaction&&function(t){if(Vd.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)}));Vd.set(t,e)}(t),Yd(t,Kd||(Kd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Zd):t);var e}function Jd(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(Jd(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)}));return Ud.set(e,t),e}(t);if($d.has(t))return $d.get(t);const e=Hd(t);return e!==t&&($d.set(t,e),Ud.set(e,t)),e}const Qd=t=>Ud.get(t),tf=["get","getKey","getAll","getAllKeys","count"],ef=["put","add","delete","clear"],nf=new Map;function rf(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(nf.get(e))return nf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=ef.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!tf.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(e.shift())),(await Promise.all([s[n](...e),i&&o.done]))[0]};return nf.set(e,o),o}qd((t=>({...t,get:(e,n,r)=>rf(e,n)||t.get(e,n,r),has:(e,n)=>!!rf(e,n)||t.has(e,n)})));const of=["continue","continuePrimaryKey","advance"],sf={},af=new WeakMap,lf=new WeakMap,cf={get(t,e){if(!of.includes(e))return t[e];let n=sf[e];return n||(n=sf[e]=function(...t){af.set(this,lf.get(this)[e](...t))}),n}};async function*hf(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;const n=new Proxy(e,cf);for(lf.set(n,e),Ud.set(n,Qd(e));e;)yield n,e=await(af.get(n)||e.continue()),af.delete(n)}function uf(t,e){return e===Symbol.asyncIterator&&Yd(t,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===e&&Yd(t,[IDBIndex,IDBObjectStore])}function df(t){return df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},df(t)}function ff(){ff=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==df(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(df(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function pf(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function gf(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){pf(o,r,i,s,a,"next",t)}function a(t){pf(o,r,i,s,a,"throw",t)}s(void 0)}))}}qd((t=>({...t,get:(e,n,r)=>uf(e,n)?hf:t.get(e,n,r),has:(e,n)=>uf(e,n)||t.has(e,n)})));var mf="stories",yf=function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=Jd(s);return r&&s.addEventListener("upgradeneeded",(t=>{r(Jd(s.result),t.oldVersion,t.newVersion,Jd(s.transaction),t)})),n&&s.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{o&&t.addEventListener("close",(()=>o())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}("geotale",1,{upgrade:function(t,e,n,r){t.objectStoreNames.contains(mf)||t.createObjectStore(mf,{keyPath:"id"})}});function vf(){return wf.apply(this,arguments)}function wf(){return(wf=gf(ff().mark((function t(){var e;return ff().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yf;case 2:return t.next=4,t.sent.getAll(mf);case 4:return e=t.sent,t.abrupt("return",e.filter((function(t){return!0!==t.isCached})));case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function _f(t){return bf.apply(this,arguments)}function bf(){return(bf=gf(ff().mark((function t(e){var n;return ff().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yf;case 2:return t.next=4,t.sent.get(mf,e);case 4:return n=t.sent,t.abrupt("return",n&&!0!==n.isCached);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}const xf={saveStory:function(t){return gf(ff().mark((function e(){return ff().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yf;case 2:return e.abrupt("return",e.sent.put(mf,t));case 3:case"end":return e.stop()}}),e)})))()},getStoryById:function(t){return gf(ff().mark((function e(){return ff().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yf;case 2:return e.abrupt("return",e.sent.get(mf,t));case 3:case"end":return e.stop()}}),e)})))()},getAllStories:function(){return gf(ff().mark((function t(){return ff().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,yf;case 2:return t.abrupt("return",t.sent.getAll(mf));case 3:case"end":return t.stop()}}),t)})))()},removeStory:function(t){return gf(ff().mark((function e(){return ff().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yf;case 2:return e.abrupt("return",e.sent.delete(mf,t));case 3:case"end":return e.stop()}}),e)})))()}};function Ef(t){var e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"/":"/GeoTale/",n=t.startsWith("/")?t.slice(1):t;return"".concat(e).concat(n)}function Sf(t){return Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(t)}function Lf(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Cf(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lf(Object(n),!0).forEach((function(e){kf(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lf(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function kf(t,e,n){return(e=Rf(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Pf(){Pf=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Sf(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Sf(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Tf(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function If(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Tf(o,r,i,s,a,"next",t)}function a(t){Tf(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Of(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rf(r.key),r)}}function Rf(t){var e=function(t){if("object"!=Sf(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Sf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Sf(e)?e:e+""}function Mf(t,e,n){Af(t,e),e.set(t,n)}function Af(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ff(t,e){return t.get(Df(t,e))}function jf(t,e,n){return t.set(Df(t,e),n),n}function Df(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Nf=new WeakMap,Gf=new WeakMap,Bf=new WeakMap,zf=new WeakSet;function Wf(t,e,n){jf(Gf,this,new Cc({target:t,layers:[new ih({source:new Sh})],view:new Ti({center:vr([n,e]),zoom:15})})),jf(Bf,this,new Eu({source:new Fh})),Ff(Gf,this).addLayer(Ff(Bf,this))}function Yf(t,e,n){var r=new Lu({geometry:new li(vr([e,t]))});r.setStyle(new Vl({image:new Gl({src:"https://openlayers.org/en/latest/examples/data/icon.png",scale:1})})),Ff(Bf,this).getSource().addFeature(r)}const Kf=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Af(this,e=zf),e.add(this),Mf(this,Nf,null),Mf(this,Gf,null),Mf(this,Bf,null),jf(Nf,this,new Wd(this))},e=[{key:"render",value:(o=If(Pf().mark((function t(){return Pf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n<section class="detail-story container">\n  <a href="#/stories" class="back-button"> Go back to Stories</a>\n  <div id="storyContent" class="detail-story__content">\n    <p class="loading">Loading story details...</p>\n  </div>\n</section>\n        ');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(r=If(Pf().mark((function t(){var e,n,r,o,s,a,l,c;return Pf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=window.location.hash.slice(1),n=e.split("/")[2],r=document.getElementById("storyContent"),jf(Nf,this,new Wd(n,{view:this,apiModel:W,dbModel:xf})),t.prev=4,t.next=7,Ff(Nf,this).getStoryDetail(n);case 7:return o=t.sent,t.next=10,_f(n);case 10:s=t.sent,r.innerHTML='\n                <h1 class="detail-story__title">'.concat(o.name,'</h1>\n                <p class="detail-story__date">').concat(at(o.createdAt),'</p>\n             \n                <img\n                    src="').concat(o.photoUrl,'"\n                    alt="Photo of ').concat(o.name,'"\n                    class="detail-story__image"\n                >\n             \n                <p class="detail-story__description">').concat(o.description,"</p>\n             \n                ").concat(o.lat&&o.lon?'\n                    <div class="detail-story__map-container">\n                        <h2>Location</h2>\n                        <div class="detail-story__coordinates">\n                            <i class="fas fa-map-pin"></i> \n                            Latitude: <span class="coordinate-value">'.concat(o.lat.toFixed(6),'</span>, \n                            Longitude: <span class="coordinate-value">').concat(o.lon.toFixed(6),'</span>\n                        </div>\n                        <div id="map" class="detail-story__map"></div>\n                    </div>\n                    <div class="bookmark-actions" style="margin-top: 1rem;">\n                        <button id="bookmark-button" class="custom-btn">\n                          ').concat(s?"Remove Bookmark":"Save Story",'\n                        </button>\n                        <button id="notify-button" class="custom-btn">Try Notify Me</button>\n                    </div>\n                '):"","\n                \n            "),(a=document.getElementById("bookmark-button"))&&a.addEventListener("click",If(Pf().mark((function t(){var e,r,s;return Pf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_f(n);case 2:if(t.sent){t.next=13;break}return t.next=6,xf.saveStory(Cf(Cf({},o),{},{isCached:!1}));case 6:return t.next=8,navigator.serviceWorker.getRegistration();case 8:(e=t.sent)&&e.showNotification("Story Saved",{body:'"'.concat(o.name,'" has been saved to your bookmarks.'),icon:"".concat(window.location.origin).concat(Ef("icons/icon-192x192.png")),tag:"story-saved"}),Promise.resolve().then(i.t.bind(i,465,23)).then((function(t){t.default.fire({icon:"success",title:"Saved!",text:'"'.concat(o.name,'" has been saved to your bookmarks.'),confirmButtonText:"OK"})})),t.next=20;break;case 13:return t.next=15,xf.removeStory(o.id);case 15:return t.next=17,navigator.serviceWorker.getRegistration();case 17:(r=t.sent)&&r.showNotification("Bookmark Removed",{body:'"'.concat(o.name,'" has been removed from your bookmarks.'),icon:"".concat(window.location.origin).concat(Ef("icons/icon-192x192.png")),tag:"story-removed"}),Promise.resolve().then(i.t.bind(i,465,23)).then((function(t){t.default.fire({icon:"info",title:"Removed!",text:'"'.concat(o.name,'" has been removed from your bookmarks.'),confirmButtonText:"OK"})}));case 20:return t.next=22,_f(n);case 22:s=t.sent,a.textContent=s?"Remove Bookmark":"Save Story";case 24:case"end":return t.stop()}}),t)})))),(l=document.getElementById("notify-button"))&&(l.addEventListener("click",If(Pf().mark((function t(){var e;return Pf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_f(n);case 2:if(t.sent){t.next=6;break}return Promise.resolve().then(i.t.bind(i,465,23)).then((function(t){t.default.fire({icon:"info",title:"Not Saved",text:"Story is not saved yet. Please save it first to receive notifications.",confirmButtonText:"OK"})})),t.abrupt("return");case 6:return t.next=8,navigator.serviceWorker.getRegistration();case 8:(e=t.sent)?(e.showNotification("Story Reminder",{body:'"'.concat(o.name,'" has been saved to your bookmarks.'),icon:"".concat(window.location.origin).concat(Ef("icons/icon-192x192.png")),tag:"story-".concat(o.id,"-notify"),requireInteraction:!0}),console.log("Notification triggered for story:",o.name)):console.warn("No service worker registration found."),Promise.resolve().then(i.t.bind(i,465,23)).then((function(t){t.default.fire({icon:"success",title:"Notification Sent",text:'"'.concat(o.name,'" notification has been triggered.'),confirmButtonText:"OK"})}));case 11:case"end":return t.stop()}}),t)})))),o.lat&&o.lon&&(c=document.getElementById("map"),Df(zf,this,Wf).call(this,c,o.lat,o.lon),Df(zf,this,Yf).call(this,o.lat,o.lon,o))),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(4),r.innerHTML='\n                <div class="error-message">\n                    Failed to load story. '.concat(t.t0.message,"\n                </div>\n            ");case 21:case"end":return t.stop()}}),t,this,[[4,18]])}))),function(){return r.apply(this,arguments)})},{key:"destroy",value:(n=If(Pf().mark((function t(){return Pf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Ff(Gf,this)&&(Ff(Gf,this).setTarget(null),jf(Gf,this,null));case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}],e&&Of(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function Xf(t){return Xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xf(t)}function Vf(){Vf=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Xf(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Xf(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function $f(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Uf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Zf(r.key),r)}}function Zf(t){var e=function(t){if("object"!=Xf(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Xf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xf(e)?e:e+""}var qf=new WeakMap;const Hf=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,qf,null),function(t,e,n){t.set(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e),n)}(qf,this,e)},e=[{key:"login",value:(n=Vf().mark((function t(e){var n,r;return Vf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={email:e.get("email"),password:e.get("password")},t.next=3,W.login(n);case 3:return r=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function s(t){$f(o,r,i,s,a,"next",t)}function a(t){$f(o,r,i,s,a,"throw",t)}s(void 0)}))},function(t){return r.apply(this,arguments)})}],e&&Uf(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Jf(t){return Jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jf(t)}function Qf(){Qf=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Jf(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Jf(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function tp(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function ep(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){tp(o,r,i,s,a,"next",t)}function a(t){tp(o,r,i,s,a,"throw",t)}s(void 0)}))}}function np(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,rp(r.key),r)}}function rp(t){var e=function(t){if("object"!=Jf(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Jf(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Jf(e)?e:e+""}function ip(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var op=new WeakMap;const sp=function(){return t=function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,op,null),e=op,n=new Hf(this),e.set(ip(e,this),n)},e=[{key:"render",value:(r=ep(Qf().mark((function t(){return Qf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth">\n        <h1 class="auth__title">Login</h1>\n\n        <form class="auth__form" id="loginForm">\n          <div class="form-group">\n            <label for="email">\n              <i class="fas fa-envelope"></i> Email\n            </label>\n            <input type="email" id="email" name="email" placeholder="Enter your email" required autocomplete="email">\n          </div>\n\n          <div class="form-group">\n            <label for="password">\n              <i class="fas fa-lock"></i> Password\n            </label>\n            <input type="password" id="password" name="password" placeholder="Enter your password" required autocomplete="current-password">\n          </div>\n\n          <button type="submit" class="submit-button">\n            <i class="fas fa-sign-in-alt"></i> Login\n          </button>\n        </form>\n\n        <p class="auth__link">\n          Dont have an account? <a href="#/register">Register</a>\n        </p>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=ep(Qf().mark((function t(){var e,n,r,i,o=this;return Qf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=function(t,e){var n=document.createElement("p");n.className="error-message",n.textContent=e,t.parentElement.appendChild(n)},e=document.querySelector("#loginForm"),n=document.querySelector("#email"),r=document.querySelector("#password"),e.addEventListener("submit",function(){var t=ep(Qf().mark((function t(s){var a,l,c;return Qf().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),e.querySelectorAll(".error-message").forEach((function(t){return t.remove()})),a=!0,n.value.includes("@")&&n.value.includes(".")||(a=!1,i(n,"Please enter a valid email address.")),r.value.length<6&&(a=!1,i(r,"Password must be at least 6 characters long.")),a){t.next=7;break}return t.abrupt("return");case 7:return e.classList.add("loading"),l=new FormData(e),t.next=11,(h=op,u=o,h.get(ip(h,u))).login(l);case 11:if(c=t.sent,e.classList.remove("loading"),!c.error){t.next=17;break}K().fire({icon:"error",title:"Login Failed",text:c.message}),t.next=21;break;case 17:return localStorage.setItem("token",c.loginResult.token),t.next=20,K().fire({icon:"success",title:"Login Successful",text:"You will be redirected to the main page",timer:1500,showConfirmButton:!1});case 20:window.location.hash="#/";case 21:case"end":return t.stop()}var h,u}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&np(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function ap(t){return ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(t)}function lp(){lp=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==ap(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(ap(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function cp(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function hp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,up(r.key),r)}}function up(t){var e=function(t){if("object"!=ap(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ap(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ap(e)?e:e+""}var dp=new WeakMap;const fp=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,dp,null),function(t,e,n){t.set(function(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}(t,e),n)}(dp,this,e)},e=[{key:"register",value:(n=lp().mark((function t(e){var n,r;return lp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={name:e.get("name"),email:e.get("email"),password:e.get("password")},t.next=4,W.register(n);case 4:if(!(r=t.sent).error){t.next=7;break}throw new Error(r.message);case 7:return t.next=9,K().fire({icon:"success",title:"Registration Successful",text:"Please log in with your account",timer:1500,showConfirmButton:!1});case 9:window.location.hash="#/login",t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),K().fire({icon:"error",title:"Registration Failed",text:t.t0.message});case 15:case"end":return t.stop()}}),t,null,[[0,12]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function s(t){cp(o,r,i,s,a,"next",t)}function a(t){cp(o,r,i,s,a,"throw",t)}s(void 0)}))},function(t){return r.apply(this,arguments)})}],e&&hp(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function pp(t){return pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pp(t)}function gp(){gp=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==pp(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(pp(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function mp(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function yp(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){mp(o,r,i,s,a,"next",t)}function a(t){mp(o,r,i,s,a,"throw",t)}s(void 0)}))}}function vp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,wp(r.key),r)}}function wp(t){var e=function(t){if("object"!=pp(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=pp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pp(e)?e:e+""}function _p(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var bp=new WeakMap;const xp=function(){return t=function t(){var e,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),function(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}(this,bp,null),e=bp,n=new fp(this),e.set(_p(e,this),n)},e=[{key:"render",value:(r=yp(gp().mark((function t(){return gp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n<section class="auth container">\n  <h1 class="auth__title"><i class="fas fa-user-plus"></i> Register</h1>\n  \n  <form id="registerForm" class="auth__form">\n    <div class="form-group">\n      <label for="name"><i class="fas fa-user"></i> Name</label>\n      <input type="text" id="name" name="name" placeholder="Enter your name" required>\n    </div>\n\n    <div class="form-group">\n      <label for="email"><i class="fas fa-envelope"></i> Email</label>\n      <input type="email" id="email" name="email" placeholder="Enter your email" required>\n    </div>\n    \n    <div class="form-group">\n      <label for="password"><i class="fas fa-lock"></i> Password</label>\n      <input \n        type="password" \n        id="password" \n        name="password" \n        placeholder="Enter your password" \n        required \n        minlength="8"\n        pattern="^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{8,}$"\n        title="Password must be at least 8 characters long and contain both letters and numbers"\n      >\n      <small class="form-help"><i class="fas fa-info-circle"></i> At least 8 characters, must include letters and numbers</small>\n    </div>\n    \n    <button type="submit" class="submit-button"><i class="fas fa-user-plus"></i> Register</button>\n    \n    <p class="auth__link">\n      <i class="fas fa-sign-in-alt"></i> Already have an account? <a href="#/login">Login here</a>\n    </p>\n  </form>\n</section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=yp(gp().mark((function t(){var e,n=this;return gp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(e=document.getElementById("registerForm")).addEventListener("submit",function(){var t=yp(gp().mark((function t(r){var i;return gp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),i=new FormData(e),t.next=4,(o=bp,s=n,o.get(_p(o,s))).register(i);case 4:case"end":return t.stop()}var o,s}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&vp(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Ep(t){return Ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ep(t)}function Sp(){Sp=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Ep(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Ep(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Lp(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Cp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kp(r.key),r)}}function kp(t){var e=function(t){if("object"!=Ep(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ep(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ep(e)?e:e+""}const Pp=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"showBookmarkedStories",value:(n=Sp().mark((function t(){var e;return Sp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,vf();case 3:e=t.sent,this.view.showStories(e),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),document.getElementById("bookmark-list").innerHTML='<p class="text-warning">Failed to load saved stories.</p>';case 11:case"end":return t.stop()}}),t,this,[[0,7]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function s(t){Lp(o,r,i,s,a,"next",t)}function a(t){Lp(o,r,i,s,a,"throw",t)}s(void 0)}))},function(){return r.apply(this,arguments)})}],e&&Cp(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Tp(t){return Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tp(t)}function Ip(){Ip=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Tp(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Tp(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Op(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Rp(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Op(o,r,i,s,a,"next",t)}function a(t){Op(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Mp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ap(r.key),r)}}function Ap(t){var e=function(t){if("object"!=Tp(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Tp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Tp(e)?e:e+""}const Fp=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new Pp(this)},e=[{key:"render",value:(r=Rp(Ip().mark((function t(){return Ip().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n            <section class="entry-page container">\n                <h1 class="entry-page__heading">Saved Stories</h1>\n                <div id="entryCards" class="entry-page__grid"></div>\n            </section>\n        ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=Rp(Ip().mark((function t(){return Ip().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.presenter.showBookmarkedStories();case 2:document.getElementById("entryCards").addEventListener("click",(function(t){var e=t.target.closest(".read-more-button");if(e){t.preventDefault();var n=e.dataset.id;window.location.hash="#/stories/".concat(n)}}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showStories",value:function(t){var e=this,n=document.getElementById("entryCards");t.length?(n.innerHTML=t.map((function(t){return e._createStoryCard(t)})).join(""),n.querySelectorAll(".delete-bookmark").forEach((function(t){t.addEventListener("click",function(){var n=Rp(Ip().mark((function n(r){var i;return Ip().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),i=t.dataset.id,n.next=4,xf.removeStory(i);case 4:e.presenter.showBookmarkedStories();case 5:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}))):n.innerHTML="<p>No stories saved.</p>"}},{key:"_createStoryCard",value:function(t){return'\n                <article class="story-item">\n                        <img src="'.concat(t.photoUrl,'" alt="Photo of ').concat(t.name,'" class="story-item__image">\n                        <div class="story-item__content">\n                                <h2 class="story-item__title">').concat(t.name,'</h2>\n                                <p class="story-item__description">').concat(t.description,'</p>\n                                <p class="story-item__date"><i class="far fa-calendar-alt"></i> ').concat(at(t.createdAt),'</p>\n                                <a href="#/stories/').concat(t.id,'" class="read-more-button" data-id="').concat(t.id,'">\n                                        View Details <i class="fas fa-arrow-right"></i>\n                                </a>\n                                <button class="delete-bookmark" data-id="').concat(t.id,'">\n                                        <i class="fas fa-trash-alt"></i> Delete\n                                </button>\n                        </div>\n                </article>\n        ')}}],e&&Mp(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function jp(t){return jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(t)}function Dp(){Dp=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==jp(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(jp(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Np(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Gp(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Np(o,r,i,s,a,"next",t)}function a(t){Np(o,r,i,s,a,"throw",t)}s(void 0)}))}}function Bp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zp(r.key),r)}}function zp(t){var e=function(t){if("object"!=jp(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=jp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jp(e)?e:e+""}const Wp=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(r=Gp(Dp().mark((function t(){return Dp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'<section class="not-found"><h1>Page not found.</h1></section>');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=Gp(Dp().mark((function t(){return Dp().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&Bp(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();var Yp={"/":new k,"/about":new A,"/stories":new Hu,"/stories/add":new Td,"/stories/:id":new Kf,"/login":new sp,"/register":new xp,"/bookmark":new Fp,"/404":new Wp},Kp=function(t){return Yp[t]?Yp[t]:t.startsWith("/stories/")&&3===t.split("/").length?Yp["/stories/:id"]:Yp["/404"]};function Xp(){var t=document.querySelector(".skip-to-main");t&&t.addEventListener("click",(function(t){t.preventDefault();var e=document.getElementById("main-content");e&&(e.hasAttribute("tabindex")||e.setAttribute("tabindex","-1"),e.focus({preventScroll:!1}),e.scrollIntoView({behavior:"smooth",block:"start"}))}))}function Vp(t){return Vp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vp(t)}function $p(){$p=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Vp(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(Vp(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Up(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Zp(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Up(o,r,i,s,a,"next",t)}function a(t){Up(o,r,i,s,a,"throw",t)}s(void 0)}))}}function qp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hp(r.key),r)}}function Hp(t){var e=function(t){if("object"!=Vp(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Vp(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Vp(e)?e:e+""}function Jp(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Qp(t,e){return t.get(eg(t,e))}function tg(t,e,n){return t.set(eg(t,e),n),n}function eg(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ng=new WeakMap,rg=new WeakMap,ig=new WeakMap,og=new WeakMap;const sg=function(){return e=function t(e){var n=e.navigationDrawer,r=e.drawerButton,i=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Jp(this,ng,null),Jp(this,rg,null),Jp(this,ig,null),Jp(this,og,null),tg(ng,this,i),tg(rg,this,r),tg(ig,this,n),this._setupDrawer()},n=[{key:"_setupDrawer",value:function(){var t=this;Qp(rg,this).addEventListener("click",(function(){Qp(ig,t).classList.toggle("open")})),document.body.addEventListener("click",(function(e){Qp(ig,t).contains(e.target)||Qp(rg,t).contains(e.target)||Qp(ig,t).classList.remove("open"),Qp(ig,t).querySelectorAll("a").forEach((function(n){n.contains(e.target)&&Qp(ig,t).classList.remove("open")}))}))}},{key:"renderPage",value:(r=Zp($p().mark((function e(){var n,r,i=this;return $p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Qp(og,this)||!Qp(og,this).destroy){e.next=3;break}return e.next=3,Qp(og,this).destroy();case 3:if(n=location.hash.replace("#","")||"/",t.requireAuth(n)){e.next=6;break}return e.abrupt("return");case 6:if(tg(og,this,Kp(n)),Qp(og,this)){e.next=10;break}return Qp(ng,this).innerHTML='<div class="error-message">Page not found</div>',e.abrupt("return");case 10:if(!document.startViewTransition){e.next=22;break}return r=document.startViewTransition(Zp($p().mark((function t(){return $p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Qp(ng,i).setAttribute("view-transition-name","page"),t.next=3,Qp(og,i).render();case 3:return Qp(ng,i).innerHTML=t.sent,t.next=6,Qp(og,i).afterRender();case 6:Xp();case 7:case"end":return t.stop()}}),t)})))),e.prev=12,e.next=15,r.finished;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(12),console.error("View transition failed:",e.t0);case 20:e.next=29;break;case 22:return Qp(ng,this).setAttribute("view-transition-name","page"),e.next=25,Qp(og,this).render();case 25:return Qp(ng,this).innerHTML=e.sent,e.next=28,Qp(og,this).afterRender();case 28:Xp();case 29:document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("subscribe-btn"),e=document.getElementById("unsubscribe-btn");t.addEventListener("click",subscribe),e.addEventListener("click",unsubscribe)}));case 30:case"end":return e.stop()}}),e,this,[[12,17]])}))),function(){return r.apply(this,arguments)})}],n&&qp(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,r}();function ag(t){return ag="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ag(t)}function lg(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cg(r.key),r)}}function cg(t){var e=function(t){if("object"!=ag(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ag(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ag(e)?e:e+""}function hg(t,e,n){ug(t,e),e.set(t,n)}function ug(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dg(t,e){return t.get(pg(t,e))}function fg(t,e,n){return t.set(pg(t,e),n),n}function pg(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gg=new WeakMap,mg=new WeakMap,yg=new WeakSet;function vg(){if(fg(gg,this,document.createElement("div")),dg(gg,this).className="offline-notice",dg(gg,this).setAttribute("role","alert"),dg(gg,this).setAttribute("aria-live","assertive"),dg(gg,this).innerHTML='\n      <div class="offline-notice__content">\n        <span class="offline-notice__icon" aria-hidden="true"></span>\n        <span class="offline-notice__text">You are currently offline. Some features may be limited.</span>\n      </div>\n    ',!document.getElementById("offline-notice-styles")){var t=document.createElement("style");t.id="offline-notice-styles",t.textContent="\n        .offline-notice {\n          position: fixed;\n          bottom: 0;\n          left: 0;\n          right: 0;\n          background-color: #f8d7da;\n          color: #721c24;\n          padding: 12px 20px;\n          text-align: center;\n          z-index: 9999;\n          box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n          transform: translateY(100%);\n          transition: transform 0.3s ease-in-out;\n        }\n        .offline-notice.visible {\n          transform: translateY(0);\n        }\n        .offline-notice__content {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          gap: 10px;\n        }\n        .offline-notice__icon {\n          font-size: 1.5rem;\n        }\n        .offline-notice__text {\n          font-weight: 500;\n        }\n      ",document.head.appendChild(t)}document.body.appendChild(dg(gg,this))}function wg(){var t=this;dg(mg,this)||(this.updateStatus(),document.addEventListener("app-status",(function(e){t.updateStatus(e.detail.isOnline)})),window.addEventListener("online",(function(){return t.updateStatus(!0)})),window.addEventListener("offline",(function(){return t.updateStatus(!1)})),fg(mg,this,!0))}const _g=function(){return t=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ug(this,e=yg),e.add(this),hg(this,gg,void 0),hg(this,mg,!1),pg(yg,this,vg).call(this),pg(yg,this,wg).call(this)},e=[{key:"updateStatus",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.onLine)?dg(gg,this).classList.remove("visible"):dg(gg,this).classList.add("visible")}}],e&&lg(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function bg(t){return bg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bg(t)}function xg(){xg=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new I(r||[]);return i(s,"_invoke",{value:C(t,n,a)}),s}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function w(){}var _={};c(_,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(O([])));x&&x!==n&&r.call(x,s)&&(_=x);var E=w.prototype=y.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(i,o,s,a){var l=u(t[i],t,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==bg(h)&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,n,r){var i=d;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===g){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=k(a,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var c=u(e,n,r);if("normal"===c.type){if(i=r.done?g:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=g,r.method="throw",r.arg=c.arg)}}}function k(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=u(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(bg(e)+" is not iterable")}return v.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:v,configurable:!0}),v.displayName=c(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),c(L.prototype,a,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new L(h(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:O(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}function Eg(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Sg(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){Eg(o,r,i,s,a,"next",t)}function a(t){Eg(o,r,i,s,a,"throw",t)}s(void 0)}))}}document.addEventListener("DOMContentLoaded",Sg(xg().mark((function t(){var e;return xg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return new _g,e=new sg({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")}),t.next=4,e.renderPage();case 4:window.addEventListener("hashchange",Sg(xg().mark((function t(){return xg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.renderPage();case 2:case"end":return t.stop()}}),t)})))),window.addEventListener("online",(function(){document.dispatchEvent(new CustomEvent("app-status",{detail:{isOnline:!0}}))})),window.addEventListener("offline",(function(){document.dispatchEvent(new CustomEvent("app-status",{detail:{isOnline:!1}}))})),_.init();case 8:case"end":return t.stop()}}),t)})))),"serviceWorker"in navigator&&window.addEventListener("load",Sg(xg().mark((function t(){var e,n,r,i;return xg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,n="".concat(e?"/":"/GeoTale/","sw.bundle.js"),t.next=6,navigator.serviceWorker.register(n);case 6:if(r=t.sent,console.log("ServiceWorker registered:",r),!("Notification"in window)){t.next=13;break}return t.next=11,Notification.requestPermission();case 11:i=t.sent,console.log("Notification permission ".concat(i,"."));case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),console.error("ServiceWorker registration failed:",t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])}))))})()})();